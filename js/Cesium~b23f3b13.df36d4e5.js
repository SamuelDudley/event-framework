(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~b23f3b13"],{"5a6c":function(e,t,a){"use strict";var i=a("0e25"),r={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2,NUMBER_OF_CLASSIFICATION_TYPES:3};t["a"]=Object(i["a"])(r)},b80d:function(e,t,a){"use strict";var i=a("1d87"),r=a("cef5"),s=a("be18"),n=a("a561"),o=a("bd8d"),c=a("2bb9"),d=a("abab"),u=a("535a"),h=a("2f63"),_=a("9f1d"),m=a("7d62"),f=a("5e57"),p=a("0123"),l=a("52f0"),b=a("1b8d"),v=a("283e"),S=a("f806"),g=a("daa2"),C=a("73b5"),O=a("77d1"),E=a("6d11"),P=a("adba"),I=a("5c15"),y=a("860a"),T=a("a58e"),A=a("b08e"),x=a("6289"),D=a("e349"),w=a("082a"),M=a("d007"),L=a("a307"),j=a("d8f6"),R=a("27aa"),N=new s["a"],k=D["a"].ModelState;function F(e){e=Object(u["a"])(e,u["a"].EMPTY_OBJECT);var t=e.gltf;if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),!(t instanceof Uint8Array))throw new v["a"]("Only binary glTF is supported as a classifier.");t=Object(I["a"])(t),Object(y["a"])(t),Object(C["a"])(t),Object(w["a"])(t),Object(M["a"])(t),O["a"].buffer(t,(function(e){if(!Object(h["a"])(e.extras._pipeline.source))throw new v["a"]("Buffer data must be embedded in the binary gltf.")}));var a=t.nodes,i=t.meshes,s=a[0],n=s.mesh;if(1!==a.length||!Object(h["a"])(n))throw new v["a"]("Only one node is supported for classification and it must have a mesh.");if(1!==i.length)throw new v["a"]("Only one mesh is supported when using b3dm for classification.");var o=i[0].primitives;if(1!==o.length)throw new v["a"]("Only one primitive per mesh is supported when using b3dm for classification.");var c=o[0].attributes.POSITION;if(!Object(h["a"])(c))throw new v["a"]("The mesh must have a position attribute.");var d=o[0].attributes._BATCHID;if(!Object(h["a"])(d))throw new v["a"]("The mesh must have a batch id attribute.");this._gltf=t,this.show=Object(u["a"])(e.show,!0),this.modelMatrix=l["a"].clone(Object(u["a"])(e.modelMatrix,l["a"].IDENTITY)),this._modelMatrix=l["a"].clone(this.modelMatrix),this._ready=!1,this._readyPromise=T["a"].defer(),this.debugShowBoundingVolume=Object(u["a"])(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(u["a"])(e.debugWireframe,!1),this._debugWireframe=!1,this._classificationType=e.classificationType,this._vertexShaderLoaded=e.vertexShaderLoaded,this._classificationShaderLoaded=e.classificationShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(u["a"])(e.ignoreCommands,!1),this._upAxis=Object(u["a"])(e.upAxis,A["a"].Y),this._batchTable=e.batchTable,this._computedModelMatrix=new l["a"],this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new r["a"],this._state=k.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._dirty=!1,this._nodeMatrix=new l["a"],this._primitive=void 0,this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms=void 0,this._buffers={},this._vertexArray=void 0,this._shaderProgram=void 0,this._uniformMap=void 0,this._geometryByteLength=0,this._trianglesLength=0,this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0}function B(e){var t=e.gltf,a=e._loadResources;O["a"].buffer(t,(function(e,t){a.buffers[t]=e.extras._pipeline.source}))}function U(e){var t=e.gltf.bufferViews,a=e._loadResources.vertexBuffersToCreate;O["a"].bufferView(e.gltf,(function(e,t){e.target===g["a"].ARRAY_BUFFER&&a.enqueue(t)}));var i=e._loadResources.indexBuffersToCreate,r={};O["a"].accessor(e.gltf,(function(e){var a=e.bufferView,s=t[a];s.target!==g["a"].ELEMENT_ARRAY_BUFFER||Object(h["a"])(r[a])||(r[a]=!0,i.enqueue({id:a,componentType:e.componentType}))}))}function V(e,t){var a=t._loadResources,i=t.gltf.bufferViews,r=i[e],s=a.getBuffer(r);t._buffers[e]=s,t._geometryByteLength+=s.byteLength}function W(e,t,a){var i=a._loadResources,r=a.gltf.bufferViews,s=r[e],n={typedArray:i.getBuffer(s),indexDatatype:t};a._buffers[e]=n,a._geometryByteLength+=n.typedArray.byteLength}function z(e){var t=e._loadResources;if(0===t.pendingBufferLoads){var a=t.vertexBuffersToCreate,i=t.indexBuffersToCreate;while(a.length>0)V(a.dequeue(),e);while(i.length>0){var r=i.dequeue();W(r.id,r.componentType,e)}}}function G(e,t){var a=t.gltf.meshes[0].primitives[0],i=D["a"].modifyShaderForQuantizedAttributes(t.gltf,a,e);return t._quantizedUniforms=i.uniforms,i.shader}function K(e,t){return Object(h["a"])(t)&&(e=t(e)),e}function q(e){var t=e.gltf,a=D["a"].getAttributeOrUniformBySemantic(t,"POSITION"),i=D["a"].getAttributeOrUniformBySemantic(t,"_BATCHID"),r={};r[a]=0,r[i]=1;var s,n,o=D["a"].getAttributeOrUniformBySemantic(t,"MODELVIEWPROJECTION");if(Object(h["a"])(o))s="uniform mat4 "+o+";\n",n=o+" * vec4("+a+", 1.0)";else{var c=D["a"].getAttributeOrUniformBySemantic(t,"PROJECTION"),d=D["a"].getAttributeOrUniformBySemantic(t,"MODELVIEW");Object(h["a"])(d)||(d=D["a"].getAttributeOrUniformBySemantic(t,"CESIUM_RTC_MODELVIEW")),s="uniform mat4 "+d+";\nuniform mat4 "+c+";\n",n=c+" * "+d+" * vec4("+a+", 1.0)"}var u="    vec4 positionInClipCoords = "+n+";\n",_="attribute vec3 "+a+";\nattribute float "+i+";\n"+s+"void main() {\n"+u+"    gl_Position = czm_depthClampFarPlane(positionInClipCoords);\n}\n",m="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeDepthClampedToFarPlane();\n}\n";e.extensionsUsed.WEB3D_quantized_attributes&&(_=G(_,e));var f=K(_,e._vertexShaderLoaded),p=K(m,e._classificationShaderLoaded);f=D["a"].modifyVertexShaderForLogDepth(f,n),p=D["a"].modifyFragmentShaderForLogDepth(p),e._shaderProgram={vertexShaderSource:f,fragmentShaderSource:p,attributeLocations:r}}function H(){return{POSITION:0,_BATCHID:1}}function Q(e){var t=e._loadResources;if(t.finishedBuffersCreation()&&!Object(h["a"])(e._vertexArray)){var a,i=e._buffers,r=e.gltf,s=r.accessors,n=r.meshes,o=n[0].primitives,c=o[0],d=H(),u={};if(O["a"].meshPrimitiveAttribute(c,(function(e,t){var a=d[t];if(Object(h["a"])(a)){var n=s[e];u[t]={index:a,vertexBuffer:i[n.bufferView],componentsPerAttribute:Object(P["a"])(n.type),componentDatatype:n.componentType,offsetInBytes:n.byteOffset,strideInBytes:Object(E["a"])(r,n)}}})),Object(h["a"])(c.indices)){var _=s[c.indices];a=i[_.bufferView]}e._vertexArray={attributes:u,indexBuffer:a}}}Object(_["a"])(F.prototype,{gltf:{get:function(){return this._gltf}},boundingSphere:{get:function(){var e=this.modelMatrix,t=l["a"].getScale(e,N),a=this._scaledBoundingSphere;return a.center=s["a"].multiplyComponents(this._boundingSphere.center,t,a.center),a.radius=s["a"].maximumComponent(t)*this._initialRadius,Object(h["a"])(this._rtcCenter)&&s["a"].add(this._rtcCenter,a.center,a.center),a}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},dirty:{get:function(){return this._dirty}},extensionsUsed:{get:function(){return Object(h["a"])(this._extensionsUsed)||(this._extensionsUsed=D["a"].getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(h["a"])(this._extensionsRequired)||(this._extensionsRequired=D["a"].getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return 0}},classificationType:{get:function(){return this._classificationType}}});var Y={PROJECTION:function(e,t){return D["a"].getGltfSemanticUniforms().PROJECTION(e,t)},MODELVIEW:function(e,t){return D["a"].getGltfSemanticUniforms().MODELVIEW(e,t)},CESIUM_RTC_MODELVIEW:function(e,t){return D["a"].getGltfSemanticUniforms().CESIUM_RTC_MODELVIEW(e,t)},MODELVIEWPROJECTION:function(e,t){return D["a"].getGltfSemanticUniforms().MODELVIEWPROJECTION(e,t)}};function J(e,t){if(!Object(h["a"])(e._uniformMap)){var a={};O["a"].technique(e.gltf,(function(i){O["a"].techniqueUniform(i,(function(i,r){Object(h["a"])(i.semantic)&&Object(h["a"])(Y[i.semantic])&&(a[r]=Y[i.semantic](t.uniformState,e))}))})),e._uniformMap=a}}function X(e,t){return D["a"].createUniformsForQuantizedAttributes(e.gltf,t,e._quantizedUniforms)}function Z(e,t){switch(e.mode){case b["a"].TRIANGLES:return t/3;case b["a"].TRIANGLE_STRIP:case b["a"].TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function $(e){var t,a,n=e._batchTable,u=e._uniformMap,_=e._vertexArray,m=e.gltf,f=m.accessors,b=m.meshes,v=b[0].primitives[0],S=f[v.indices],g=v.attributes.POSITION,C=D["a"].getAccessorMinMax(m,g),O=r["a"].fromCornerPoints(s["a"].fromArray(C.min),s["a"].fromArray(C.max));if(Object(h["a"])(S))a=S.count,t=S.byteOffset/p["a"].getSizeInBytes(S.componentType);else{var E=f[v.attributes.POSITION];a=E.count,t=0}if(e._trianglesLength+=Z(v,a),Object(h["a"])(e._uniformMapLoaded)&&(u=e._uniformMapLoaded(u)),e.extensionsUsed.WEB3D_quantized_attributes){var P=X(e,v);u=Object(c["a"])(u,P)}var I=_.attributes.POSITION,y=I.componentDatatype,T=I.vertexBuffer,A=T.byteOffset,x=T.byteLength/d["a"].getSizeInBytes(y),w=d["a"].createArrayBufferView(y,T.buffer,A,x);I=_.attributes._BATCHID,y=I.componentDatatype,T=I.vertexBuffer,A=T.byteOffset,x=T.byteLength/d["a"].getSizeInBytes(y);var M,L=d["a"].createArrayBufferView(y,T.buffer,A,x),N=_.indexBuffer.typedArray;M=_.indexBuffer.indexDatatype===p["a"].UNSIGNED_SHORT?new Uint16Array(N.buffer,N.byteOffset,N.byteLength/Uint16Array.BYTES_PER_ELEMENT):new Uint32Array(N.buffer,N.byteOffset,N.byteLength/Uint32Array.BYTES_PER_ELEMENT),w=Object(i["a"])(w),L=Object(i["a"])(L),M=Object(i["a"])(M,t,t+a);var k,F,B,U=[],V=[],W=[],z=[],G=L[M[0]];U.push(G),W.push(0);for(var K=M.length,q=1;q<K;++q)k=L[M[q]],k!==G&&(F=W[W.length-1],B=q-F,U.push(k),V.push(B),W.push(q),z.push(new j["a"]({offset:F,count:B,batchIds:[G],color:o["a"].WHITE})),G=k);F=W[W.length-1],B=K-F,V.push(B),z.push(new j["a"]({offset:F,count:B,batchIds:[G],color:o["a"].WHITE}));var H=e._shaderProgram,Q=H.vertexShaderSource,Y=H.fragmentShaderSource,J=H.attributeLocations,$=Object(h["a"])(e._pickIdLoaded)?e._pickIdLoaded():void 0;e._primitive=new R["a"]({classificationType:e._classificationType,positions:w,indices:M,indexOffsets:W,indexCounts:V,batchIds:U,vertexBatchIds:L,batchedIndices:z,batchTable:n,boundingVolume:new r["a"],_vertexShaderSource:Q,_fragmentShaderSource:Y,_attributeLocations:J,_uniformMap:u,_pickId:$,_modelMatrix:new l["a"],_boundingSphere:O}),e._buffers=void 0,e._vertexArray=void 0,e._shaderProgram=void 0,e._uniformMap=void 0}function ee(e){var t=e._loadResources;if(t.finished()&&!Object(h["a"])(e._primitive)){var a=e.gltf,i=a.nodes,r=i[0];e._nodeMatrix=D["a"].getTransform(r,e._nodeMatrix),$(e)}}function te(e,t){var a=t.context;D["a"].checkSupportedGlExtensions(e.gltf.glExtensionsUsed,a),z(e),q(e),Q(e),J(e,a),ee(e)}var ae=new n["a"],ie=new l["a"];function re(e,t,a,i){var o=e._computedModelMatrix;if(e._mode!==L["a"].SCENE3D&&!e._ignoreCommands){var c=l["a"].getColumn(o,3,ae);if(n["a"].equals(c,n["a"].UNIT_W)){var d=e.boundingSphere.center,u=S["a"].wgs84To2DModelMatrix(i,d,ie);o=l["a"].multiply(u,o,ie),Object(h["a"])(e._rtcCenter)&&(l["a"].setTranslation(o,n["a"].UNIT_W,o),e._rtcCenter=e._rtcCenter2D)}else o=S["a"].basisTo2D(i,o,ie),e._rtcCenter=e._rtcCenter3D}var _=e._primitive;(t||a)&&(l["a"].multiplyTransformation(o,e._nodeMatrix,_._modelMatrix),r["a"].transform(_._boundingSphere,_._modelMatrix,_._boundingVolume),Object(h["a"])(e._rtcCenter)&&s["a"].add(e._rtcCenter,_._boundingVolume.center,_._boundingVolume.center))}F.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},F.prototype.update=function(e){if(e.mode!==L["a"].MORPHING)if(f["a"].supportsWebP.initialized){var t=f["a"].supportsWebP();if(this._state===k.NEEDS_LOAD&&Object(h["a"])(this.gltf)&&(this._state=k.LOADING,this._state!==k.FAILED)){var a=this.gltf.extensions;if(Object(h["a"])(a)&&Object(h["a"])(a.CESIUM_RTC)){var i=s["a"].fromArray(a.CESIUM_RTC.center);if(!s["a"].equals(i,s["a"].ZERO)){this._rtcCenter3D=i;var r=e.mapProjection,n=r.ellipsoid,o=n.cartesianToCartographic(this._rtcCenter3D),c=r.project(o);s["a"].fromElements(c.z,c.x,c.y,c),this._rtcCenter2D=c,this._rtcCenterEye=new s["a"],this._rtcCenter=this._rtcCenter3D}}this._loadResources=new x["a"],D["a"].parseBuffers(this)}var d=this._loadResources,u=!1;this._state===k.LOADING&&(0===d.pendingBufferLoads&&(D["a"].checkSupportedExtensions(this.extensionsRequired,t),B(this),U(this),this._boundingSphere=D["a"].computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,te(this,e)),d.finished()&&(this._state=k.LOADED,u=!0)),Object(h["a"])(d)&&this._state===k.LOADED&&(u||te(this,e),d.finished()&&(this._loadResources=void 0));var _=this.show;if(_&&this._state===k.LOADED||u){this._dirty=!1;var m=this.modelMatrix,p=e.mode!==this._mode;this._mode=e.mode;var b=!l["a"].equals(this._modelMatrix,m)||p;if(b||u){l["a"].clone(m,this._modelMatrix);var v=this._computedModelMatrix;l["a"].clone(m,v),this._upAxis===A["a"].Y?l["a"].multiplyTransformation(v,A["a"].Y_UP_TO_Z_UP,v):this._upAxis===A["a"].X&&l["a"].multiplyTransformation(v,A["a"].X_UP_TO_Z_UP,v)}(b||u)&&(re(this,b,u,e.mapProjection),this._dirty=!0)}if(u){var S=this;e.afterRender.push((function(){S._ready=!0,S._readyPromise.resolve(S)}))}else _&&!this._ignoreCommands&&(this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.debugWireframe=this.debugWireframe,this._primitive.update(e))}else f["a"].supportsWebP.initialize()},F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),Object(m["a"])(this)},t["a"]=F},e8b2:function(e,t,a){"use strict";var i=a("9541"),r=a("2bb9"),s=a("535a"),n=a("2f63"),o=a("9f1d"),c=a("7d62"),d=a("4f04"),u=a("d940"),h=a("c2aa"),_=a("a894"),m=a("d289"),f=a("6dc0"),p=a("e90c"),l=a("5770"),b=a("33db"),v=a("ae16"),S=a("a58e"),g=a("b7c8"),C=a("5a6c"),O=a("06f0"),E=a("3a8e"),P=a("894b"),I=a("a307"),y=a("2a1b"),T=a("3626"),A=a("6102"),x=a("25ef"),D=["color"];function w(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT);var t,a=e.geometryInstances;this.geometryInstances=a,this.show=Object(s["a"])(e.show,!0),this.classificationType=Object(s["a"])(e.classificationType,C["a"].BOTH),this.debugShowBoundingVolume=Object(s["a"])(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=Object(s["a"])(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=Object(s["a"])(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilPreloadPass=void 0,this._rsStencilPreloadPass3DTiles=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1,this._readyPromise=S["a"].defer(),this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,Object(n["a"])(a)&&Object(h["a"])(a)&&a.length>1&&(t=D),this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:Object(s["a"])(e.vertexCacheOptimize,!1),interleave:Object(s["a"])(e.interleave,!1),releaseGeometryInstances:Object(s["a"])(e.releaseGeometryInstances,!0),allowPicking:Object(s["a"])(e.allowPicking,!0),asynchronous:Object(s["a"])(e.asynchronous,!0),compressVertices:Object(s["a"])(e.compressVertices,!0),_readOnlyInstanceAttributes:t,_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}function M(e,t){var a=t?A["a"].EQUAL:A["a"].ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:a,frontOperation:{fail:x["a"].KEEP,zFail:x["a"].DECREMENT_WRAP,zPass:x["a"].DECREMENT_WRAP},backFunction:a,backOperation:{fail:x["a"].KEEP,zFail:x["a"].INCREMENT_WRAP,zPass:x["a"].INCREMENT_WRAP},reference:T["a"].CESIUM_3D_TILE_MASK,mask:T["a"].CESIUM_3D_TILE_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1}}function L(e,t){var a=t?A["a"].EQUAL:A["a"].ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:a,frontOperation:{fail:x["a"].KEEP,zFail:x["a"].KEEP,zPass:x["a"].INCREMENT_WRAP},backFunction:a,backOperation:{fail:x["a"].KEEP,zFail:x["a"].KEEP,zPass:x["a"].DECREMENT_WRAP},reference:T["a"].CESIUM_3D_TILE_MASK,mask:T["a"].CESIUM_3D_TILE_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!0,func:O["a"].LESS_OR_EQUAL},depthMask:!1}}function j(e){return{stencilTest:{enabled:e,frontFunction:A["a"].NOT_EQUAL,frontOperation:{fail:x["a"].KEEP,zFail:x["a"].KEEP,zPass:x["a"].DECREMENT_WRAP},backFunction:A["a"].NOT_EQUAL,backOperation:{fail:x["a"].KEEP,zFail:x["a"].KEEP,zPass:x["a"].DECREMENT_WRAP},reference:0,mask:T["a"].CLASSIFICATION_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:g["a"].ALPHA_BLEND}}Object(o["a"])(w.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}}),w.isSupported=function(e){return e.context.stencilBuffer};var R={stencilTest:{enabled:!0,frontFunction:A["a"].NOT_EQUAL,frontOperation:{fail:x["a"].KEEP,zFail:x["a"].KEEP,zPass:x["a"].DECREMENT_WRAP},backFunction:A["a"].NOT_EQUAL,backOperation:{fail:x["a"].KEEP,zFail:x["a"].KEEP,zPass:x["a"].DECREMENT_WRAP},reference:0,mask:T["a"].CLASSIFICATION_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function N(e,t,a,i){if(!Object(n["a"])(e._rsStencilPreloadPass)){var r=!e.debugShowShadowVolume;e._rsStencilPreloadPass=f["a"].fromCache(M(r,!1)),e._rsStencilPreloadPass3DTiles=f["a"].fromCache(M(r,!0)),e._rsStencilDepthPass=f["a"].fromCache(L(r,!1)),e._rsStencilDepthPass3DTiles=f["a"].fromCache(L(r,!0)),e._rsColorPass=f["a"].fromCache(j(r,!1)),e._rsPickPass=f["a"].fromCache(R)}}function k(e,t){if(!e.compressVertices)return t;if(-1!==t.search(/attribute\s+vec3\s+extrudeDirection;/g)){var a="compressedAttributes",i="attribute vec2 "+a+";",r="vec3 extrudeDirection;\n",s="    extrudeDirection = czm_octDecode("+a+", 65535.0);\n",n=t;n=n.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),n=l["a"].replaceMain(n,"czm_non_compressed_main");var o="void main() \n{ \n"+s+"    czm_non_compressed_main(); \n}";return[i,r,n,o].join("\n")}}function F(e,t){var a=t.context,i=e._primitive,r=b["a"];r=e._primitive._batchTable.getVertexShaderCallback()(r),r=P["a"]._appendDistanceDisplayConditionToShader(i,r),r=P["a"]._modifyShaderPosition(e,r,t.scene3DOnly),r=P["a"]._updateColorAttribute(i,r);var s=e._hasPlanarExtentsAttributes,o=s||e._hasSphericalExtentsAttribute;e._extruded&&(r=k(i,r));var c=e._extruded?"EXTRUDED_GEOMETRY":"",d="ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT",u=new l["a"]({defines:[c,d],sources:[r]}),h=new l["a"]({sources:[v["a"]]}),_=e._primitive._attributeLocations,m=new y["a"](o,s,e.appearance,a.floatTextureSixPlaces);if(e._spStencil=p["a"].replaceCache({context:a,shaderProgram:e._spStencil,vertexShaderSource:u,fragmentShaderSource:h,attributeLocations:_}),e._primitive.allowPicking){var f=l["a"].createPickVertexShaderSource(r);f=P["a"]._appendShowToShader(i,f),f=P["a"]._updatePickColorAttribute(f);var S=m.createPickFragmentShader(!1),g=m.createPickVertexShader([c,d],f,!1,t.mapProjection);if(e._spPick=p["a"].replaceCache({context:a,shaderProgram:e._spPick,vertexShaderSource:g,fragmentShaderSource:S,attributeLocations:_}),o){var C=a.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!Object(n["a"])(C)){var O=m.createPickFragmentShader(!0),E=m.createPickVertexShader([c,d],f,!0,t.mapProjection);C=a.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:E,fragmentShaderSource:O,attributeLocations:_})}e._spPick2D=C}}else e._spPick=p["a"].fromCache({context:a,vertexShaderSource:u,fragmentShaderSource:h,attributeLocations:_});r=P["a"]._appendShowToShader(i,r),u=new l["a"]({defines:[c,d],sources:[r]}),e._sp=p["a"].replaceCache({context:a,shaderProgram:e._sp,vertexShaderSource:u,fragmentShaderSource:h,attributeLocations:_});var I=m.createFragmentShader(!1),T=m.createVertexShader([c,d],r,!1,t.mapProjection);if(e._spColor=p["a"].replaceCache({context:a,shaderProgram:e._spColor,vertexShaderSource:T,fragmentShaderSource:I,attributeLocations:_}),o){var A=a.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!Object(n["a"])(A)){var x=m.createFragmentShader(!0),D=m.createVertexShader([c,d],r,!0,t.mapProjection);A=a.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:D,fragmentShaderSource:x,attributeLocations:_})}e._spColor2D=A}}function B(e,t){var a,i,s,o=e._primitive,c=3*o._va.length;t.length=c;var d=0,u=o._batchTable.getUniformMapCallback()(e._uniformMap),h=e._needs2DShader;for(a=0;a<c;a+=3){var f=o._va[d++];i=t[a],Object(n["a"])(i)||(i=t[a]=new _["a"]({owner:e,primitiveType:o._primitiveType})),i.vertexArray=f,i.renderState=e._rsStencilPreloadPass,i.shaderProgram=e._sp,i.uniformMap=u,i.pass=m["a"].TERRAIN_CLASSIFICATION,s=_["a"].shallowClone(i,i.derivedCommands.tileset),s.renderState=e._rsStencilPreloadPass3DTiles,s.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=s,i=t[a+1],Object(n["a"])(i)||(i=t[a+1]=new _["a"]({owner:e,primitiveType:o._primitiveType})),i.vertexArray=f,i.renderState=e._rsStencilDepthPass,i.shaderProgram=e._sp,i.uniformMap=u,i.pass=m["a"].TERRAIN_CLASSIFICATION,s=_["a"].shallowClone(i,i.derivedCommands.tileset),s.renderState=e._rsStencilDepthPass3DTiles,s.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=s,i=t[a+2],Object(n["a"])(i)||(i=t[a+2]=new _["a"]({owner:e,primitiveType:o._primitiveType})),i.vertexArray=f,i.renderState=e._rsColorPass,i.shaderProgram=e._spColor,i.pass=m["a"].TERRAIN_CLASSIFICATION;var p=e.appearance,l=p.material;if(Object(n["a"])(l)&&(u=Object(r["a"])(u,l._uniforms)),i.uniformMap=u,s=_["a"].shallowClone(i,i.derivedCommands.tileset),s.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=s,h){var b=_["a"].shallowClone(i,i.derivedCommands.appearance2D);b.shaderProgram=e._spColor2D,i.derivedCommands.appearance2D=b,b=_["a"].shallowClone(s,s.derivedCommands.appearance2D),b.shaderProgram=e._spColor2D,s.derivedCommands.appearance2D=b}}var v=e._commandsIgnoreShow,S=e._spStencil,g=0;c=v.length=c/3*2;for(var C=0;C<c;C+=2){var O=v[C]=_["a"].shallowClone(t[g],v[C]);O.shaderProgram=S,O.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,O=v[C+1]=_["a"].shallowClone(t[g+1],v[C+1]),O.shaderProgram=S,O.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,g+=3}}function U(e,t){var a,i,r,s,o,c=e._usePickOffsets,d=e._primitive,u=3*d._va.length,h=0;c&&(a=d._pickOffsets,u=3*a.length),t.length=u;var f=0,p=d._batchTable.getUniformMapCallback()(e._uniformMap),l=e._needs2DShader;for(r=0;r<u;r+=3){var b=d._va[f++];if(c&&(i=a[h++],b=d._va[i.index]),s=t[r],Object(n["a"])(s)||(s=t[r]=new _["a"]({owner:e,primitiveType:d._primitiveType,pickOnly:!0})),s.vertexArray=b,s.renderState=e._rsStencilPreloadPass,s.shaderProgram=e._sp,s.uniformMap=p,s.pass=m["a"].TERRAIN_CLASSIFICATION,c&&(s.offset=i.offset,s.count=i.count),o=_["a"].shallowClone(s,s.derivedCommands.tileset),o.renderState=e._rsStencilPreloadPass3DTiles,o.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=o,s=t[r+1],Object(n["a"])(s)||(s=t[r+1]=new _["a"]({owner:e,primitiveType:d._primitiveType,pickOnly:!0})),s.vertexArray=b,s.renderState=e._rsStencilDepthPass,s.shaderProgram=e._sp,s.uniformMap=p,s.pass=m["a"].TERRAIN_CLASSIFICATION,c&&(s.offset=i.offset,s.count=i.count),o=_["a"].shallowClone(s,s.derivedCommands.tileset),o.renderState=e._rsStencilDepthPass3DTiles,o.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=o,s=t[r+2],Object(n["a"])(s)||(s=t[r+2]=new _["a"]({owner:e,primitiveType:d._primitiveType,pickOnly:!0})),s.vertexArray=b,s.renderState=e._rsPickPass,s.shaderProgram=e._spPick,s.uniformMap=p,s.pass=m["a"].TERRAIN_CLASSIFICATION,c&&(s.offset=i.offset,s.count=i.count),o=_["a"].shallowClone(s,s.derivedCommands.tileset),o.pass=m["a"].CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=o,l){var v=_["a"].shallowClone(s,s.derivedCommands.pick2D);v.shaderProgram=e._spPick2D,s.derivedCommands.pick2D=v,v=_["a"].shallowClone(o,o.derivedCommands.pick2D),v.shaderProgram=e._spPick2D,o.derivedCommands.pick2D=v}}}function V(e,t,a,i,r,s,n){B(e,s),U(e,n)}function W(e,t){return Math.floor(e%t/3)}function z(e,t,a,i,r,s){e.modelMatrix=a,e.boundingVolume=r,e.cull=i,e.debugShowBoundingVolume=s,t.commandList.push(e)}function G(e,t,a,i,r){e.modelMatrix=a,e.boundingVolume=r,e.cull=i,t.commandList.push(e)}function K(e,t,a,i,r,s,o,c){var d,u=e._primitive;P["a"]._updateBoundingVolumes(u,t,r),t.mode===I["a"].SCENE3D?d=u._boundingSphereWC:t.mode===I["a"].COLUMBUS_VIEW?d=u._boundingSphereCV:t.mode===I["a"].SCENE2D&&Object(n["a"])(u._boundingSphere2D)?d=u._boundingSphere2D:Object(n["a"])(u._boundingSphereMorph)&&(d=u._boundingSphereMorph);var h,_,m,f=e.classificationType,p=f!==C["a"].CESIUM_3D_TILE,l=f!==C["a"].TERRAIN,b=t.passes;if(b.render){var v=a.length;for(h=0;h<v;++h)_=d[W(h,v)],p&&(m=a[h],z(m,t,r,s,_,o)),l&&(m=a[h].derivedCommands.tileset,z(m,t,r,s,_,o));if(t.invertClassification){var S=e._commandsIgnoreShow,g=S.length;for(h=0;h<g;++h)_=d[Math.floor(h/2)],m=S[h],z(m,t,r,s,_,o)}}if(b.pick){var O=i.length,E=u._pickOffsets;for(h=0;h<O;++h){var y=E[W(h,O)];_=d[y.index],p&&(m=i[h],G(m,t,r,s,_)),l&&(m=i[h].derivedCommands.tileset,G(m,t,r,s,_))}}}w.prototype.update=function(e){if(Object(n["a"])(this._primitive)||Object(n["a"])(this.geometryInstances)){var t=this.appearance;Object(n["a"])(t)&&Object(n["a"])(t.material)&&t.material.update(e.context);var a=this,r=this._primitiveOptions;if(!Object(n["a"])(this._primitive)){var o,c,_,m,p=Object(h["a"])(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],l=p.length,b=!1,v=!0,S=!1,g=!1;for(l>0&&(_=p[0].attributes,S=y["a"].hasAttributesForSphericalExtents(_),g=y["a"].hasAttributesForTextureCoordinatePlanes(_),m=_.color),o=0;o<l;o++){c=p[o];var C=c.attributes.color;Object(n["a"])(C)&&(b=!0),v=v&&Object(n["a"])(C)&&i["a"].equals(m,C)}if(!v&&!S&&!g)throw new d["a"]("All GeometryInstances must have the same color attribute except via GroundPrimitives");b&&!Object(n["a"])(t)&&(t=new E["a"]({flat:!0}),this.appearance=t),this._usePickOffsets=!S&&!g,this._hasSphericalExtentsAttribute=S,this._hasPlanarExtentsAttributes=g,this._hasPerColorAttribute=b;var O=new Array(l);for(o=0;o<l;++o)c=p[o],O[o]=new u["a"]({geometry:c.geometry,attributes:c.attributes,modelMatrix:c.modelMatrix,id:c.id,pickPrimitive:Object(s["a"])(this._pickPrimitive,a)});r.appearance=t,r.geometryInstances=O,Object(n["a"])(this._createBoundingVolumeFunction)&&(r._createBoundingVolumeFunction=function(e,t){a._createBoundingVolumeFunction(e,t)}),r._createRenderStatesFunction=function(e,t,i,r){N(a,t)},r._createShaderProgramFunction=function(e,t,i){F(a,t)},r._createCommandsFunction=function(e,t,i,r,s,n,o){V(a,void 0,void 0,!0,!1,n,o)},Object(n["a"])(this._updateAndQueueCommandsFunction)?r._updateAndQueueCommandsFunction=function(e,t,i,r,s,n,o,c){a._updateAndQueueCommandsFunction(e,t,i,r,s,n,o,c)}:r._updateAndQueueCommandsFunction=function(e,t,i,r,s,n,o,c){K(a,t,i,r,s,n,o,c)},this._primitive=new P["a"](r),this._primitive.readyPromise.then((function(e){a._ready=!0,a.releaseGeometryInstances&&(a.geometryInstances=void 0);var t=e._error;Object(n["a"])(t)?a._readyPromise.reject(t):a._readyPromise.resolve(a)}))}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilPreloadPass=f["a"].fromCache(M(!1,!1)),this._rsStencilPreloadPass3DTiles=f["a"].fromCache(M(!1,!0)),this._rsStencilDepthPass=f["a"].fromCache(L(!1,!1)),this._rsStencilDepthPass3DTiles=f["a"].fromCache(L(!1,!0)),this._rsColorPass=f["a"].fromCache(j(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilPreloadPass=f["a"].fromCache(M(!0,!1)),this._rsStencilPreloadPass3DTiles=f["a"].fromCache(M(!0,!0)),this._rsStencilDepthPass=f["a"].fromCache(L(!0,!1)),this._rsStencilDepthPass3DTiles=f["a"].fromCache(L(!0,!0)),this._rsColorPass=f["a"].fromCache(j(!0))),this._primitive.appearance!==t&&(this._primitive.appearance=t),this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}},w.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,Object(c["a"])(this)},t["a"]=w}}]);