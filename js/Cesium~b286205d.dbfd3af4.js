(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~b286205d"],{"9e0b":function(e,t,a){"use strict";var r=a("7229"),n=a("be18"),o=a("535a"),s=a("2f63"),i=a("9f1d"),u=a("7d62"),d=a("c52f"),c=a("47a6"),m=a("df07"),l=a("52f0"),h=a("08db"),_=a("f806"),p=a("37eb"),C=a("aea3");function f(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT);var t=e.textureUrl;Object(s["a"])(t)||(t=Object(r["a"])("Assets/Textures/moonSmall.jpg")),this.show=Object(o["a"])(e.show,!0),this.textureUrl=t,this._ellipsoid=Object(o["a"])(e.ellipsoid,d["a"].MOON),this.onlySunLighting=Object(o["a"])(e.onlySunLighting,!0),this._ellipsoidPrimitive=new p["a"]({radii:this.ellipsoid.radii,material:C["a"].fromType(C["a"].ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new c["a"]}Object(i["a"])(f.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var g=new m["a"],v=new m["a"],T=new n["a"],O=[];f.prototype.update=function(e){if(this.show){var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;var a=e.time;Object(s["a"])(_["a"].computeIcrfToFixedMatrix(a,g))||_["a"].computeTemeToPseudoFixedMatrix(a,g);var r=this._axes.evaluate(a,v);m["a"].transpose(r,r),m["a"].multiply(g,r,r);var n=h["a"].computeMoonPositionInEarthInertialFrame(a,T);m["a"].multiplyByVector(g,n,n),l["a"].fromRotationTranslation(r,n,t.modelMatrix);var o=e.commandList;return e.commandList=O,O.length=0,t.update(e),e.commandList=o,1===O.length?O[0]:void 0}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),Object(u["a"])(this)},t["a"]=f},dd7f:function(e,t,a){"use strict";var r=a("77af"),n=a("bd8d"),o=a("2f63"),s=a("7d62"),i=a("e42d"),u=a("daa2"),d=a("f845"),c=a("a894"),m=a("ac3b"),l=a("6ef5"),h=a("6dc0"),_=a("5770"),p=a("a913"),C=a("461c"),f=a("5950"),g=a("6f00"),v=a("30d2");function T(e){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var t=e.colorBufferFloat&&e.depthTexture;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new d["a"]({color:new n["a"](0,0,0,0),owner:this}),this._translucentMRTClearCommand=new d["a"]({color:new n["a"](0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new d["a"]({color:new n["a"](0,0,0,0),owner:this}),this._alphaClearCommand=new d["a"]({color:new n["a"](1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new r["a"],this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function O(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function S(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function w(e){O(e),S(e)}function x(e,t,a,r){O(e),e._accumulationTexture=new p["a"]({context:t,width:a,height:r,pixelFormat:i["a"].RGBA,pixelDatatype:l["a"].FLOAT});var n=new Float32Array(a*r*4);e._revealageTexture=new p["a"]({context:t,pixelFormat:i["a"].RGBA,pixelDatatype:l["a"].FLOAT,source:{arrayBufferView:n,width:a,height:r},flipY:!1})}function b(e,t){S(e);var a=u["a"].FRAMEBUFFER_COMPLETE,r=!0;if(e._translucentMRTSupport&&(e._translucentFBO=new m["a"]({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new m["a"]({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===a&&e._adjustTranslucentFBO.status===a||(S(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO=new m["a"]({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new m["a"]({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new m["a"]({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new m["a"]({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1});var n=e._translucentFBO.status===a,o=e._alphaFBO.status===a,s=e._adjustTranslucentFBO.status===a,i=e._adjustAlphaFBO.status===a;n&&o&&s&&i||(w(e),e._translucentMultipassSupport=!1,r=!1)}return r}T.prototype.update=function(e,t,a,n){if(this.isSupported()){this._opaqueFBO=a,this._opaqueTexture=a.getColorTexture(0),this._depthStencilTexture=a.depthStencilTexture;var s=this._opaqueTexture.width,i=this._opaqueTexture.height,u=this._accumulationTexture,d=!Object(o["a"])(u)||u.width!==s||u.height!==i||n!==this._useHDR;if(d&&x(this,e,s,i),Object(o["a"])(this._translucentFBO)&&!d||b(this,e)){this._useHDR=n;var c,m,l=this;Object(o["a"])(this._compositeCommand)||(c=new _["a"]({sources:[f["a"]]}),this._translucentMRTSupport&&c.defines.push("MRT"),m={u_opaque:function(){return l._opaqueTexture},u_accumulation:function(){return l._accumulationTexture},u_revealage:function(){return l._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(c,{uniformMap:m,owner:this})),Object(o["a"])(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(c=new _["a"]({defines:["MRT"],sources:[C["a"]]}),m={u_bgColor:function(){return l._translucentMRTClearCommand.color},u_depthTexture:function(){return l._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(c,{uniformMap:m,owner:this})):this._translucentMultipassSupport&&(c=new _["a"]({sources:[C["a"]]}),m={u_bgColor:function(){return l._translucentMultipassClearCommand.color},u_depthTexture:function(){return l._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(c,{uniformMap:m,owner:this}),m={u_bgColor:function(){return l._alphaClearCommand.color},u_depthTexture:function(){return l._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(c,{uniformMap:m,owner:this}))),this._viewport.width=s,this._viewport.height=i;var p=!r["a"].equals(this._viewport,t.viewport),g=p!==this._useScissorTest;this._useScissorTest=p,r["a"].equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=r["a"].clone(t.viewport,this._scissorRectangle),g=!0),Object(o["a"])(this._rs)&&r["a"].equals(this._viewport,this._rs.viewport)&&!g||(this._rs=h["a"].fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),Object(o["a"])(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),Object(o["a"])(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}};var F={enabled:!0,color:new n["a"](0,0,0,0),equationRgb:g["a"].ADD,equationAlpha:g["a"].ADD,functionSourceRgb:v["a"].ONE,functionDestinationRgb:v["a"].ONE,functionSourceAlpha:v["a"].ZERO,functionDestinationAlpha:v["a"].ONE_MINUS_SOURCE_ALPHA},j={enabled:!0,color:new n["a"](0,0,0,0),equationRgb:g["a"].ADD,equationAlpha:g["a"].ADD,functionSourceRgb:v["a"].ONE,functionDestinationRgb:v["a"].ONE,functionSourceAlpha:v["a"].ONE,functionDestinationAlpha:v["a"].ONE},B={enabled:!0,color:new n["a"](0,0,0,0),equationRgb:g["a"].ADD,equationAlpha:g["a"].ADD,functionSourceRgb:v["a"].ZERO,functionDestinationRgb:v["a"].ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:v["a"].ZERO,functionDestinationAlpha:v["a"].ONE_MINUS_SOURCE_ALPHA};function y(e,t,a,r){var n=a[r.id];if(!Object(o["a"])(n)){var s=h["a"].getState(r);s.depthMask=!1,s.blending=t,n=h["a"].fromCache(s),a[r.id]=n}return n}function A(e,t,a){return y(t,F,e._translucentRenderStateCache,a)}function R(e,t,a){return y(t,j,e._translucentRenderStateCache,a)}function M(e,t,a){return y(t,B,e._alphaRenderStateCache,a)}var P="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n",D="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n",E="    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n";function q(e,t,a,r){var n=e.shaderCache.getDerivedShaderProgram(t,a);if(!Object(o["a"])(n)){var s=t._attributeLocations,i=t.fragmentShaderSource.clone();i.sources=i.sources.map((function(e){return e=_["a"].replaceMain(e,"czm_translucent_main"),e=e.replace(/gl_FragColor/g,"czm_gl_FragColor"),e=e.replace(/\bdiscard\b/g,"czm_discard = true"),e=e.replace(/czm_phong/g,"czm_translucentPhong"),e})),i.sources.splice(0,0,(-1!==r.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),i.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+r+"}\n"),n=e.shaderCache.createDerivedShaderProgram(t,a,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:s})}return n}function z(e,t){return q(e,t,"translucentMRT",P)}function L(e,t){return q(e,t,"translucentMultipass",D)}function N(e,t){return q(e,t,"alphaMultipass",E)}function I(e,t,a,r,n,s){var i,u,d,c=t.context,m=t.frameState.useLogDepth,l=t._hdr,h=r.framebuffer,_=n.length,p=t.frameState.shadowState.lightShadowsEnabled;r.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(c,r),r.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(c,r);var C=e._opaqueFBO;for(r.framebuffer=e._translucentFBO,d=0;d<_;++d)i=n[d],i=m?i.derivedCommands.logDepth.command:i,i=l?i.derivedCommands.hdr.command:i,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.translucentCommand:i.derivedCommands.oit.translucentCommand,a(u,t,c,r,C);for(Object(o["a"])(s)&&(i=s.unclassifiedCommand,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.translucentCommand:i.derivedCommands.oit.translucentCommand,a(u,t,c,r,C)),r.framebuffer=e._alphaFBO,d=0;d<_;++d)i=n[d],i=m?i.derivedCommands.logDepth.command:i,i=l?i.derivedCommands.hdr.command:i,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.alphaCommand:i.derivedCommands.oit.alphaCommand,a(u,t,c,r,C);Object(o["a"])(s)&&(i=s.unclassifiedCommand,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.alphaCommand:i.derivedCommands.oit.alphaCommand,a(u,t,c,r,C)),r.framebuffer=h}function U(e,t,a,r,n,s){var i=t.context,u=t.frameState.useLogDepth,d=t._hdr,c=r.framebuffer,m=n.length,l=t.frameState.shadowState.lightShadowsEnabled;r.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(i,r);var h,_,p=e._opaqueFBO;r.framebuffer=e._translucentFBO;for(var C=0;C<m;++C)h=n[C],h=u?h.derivedCommands.logDepth.command:h,h=d?h.derivedCommands.hdr.command:h,_=l&&h.receiveShadows?h.derivedCommands.oit.shadows.translucentCommand:h.derivedCommands.oit.translucentCommand,a(_,t,i,r,p);Object(o["a"])(s)&&(h=s.unclassifiedCommand,_=l&&h.receiveShadows?h.derivedCommands.oit.shadows.translucentCommand:h.derivedCommands.oit.translucentCommand,a(_,t,i,r,p)),r.framebuffer=c}T.prototype.createDerivedCommands=function(e,t,a){var r,n,s,i,u,d;(Object(o["a"])(a)||(a={}),this._translucentMRTSupport)?(Object(o["a"])(a.translucentCommand)&&(r=a.translucentCommand.shaderProgram,n=a.translucentCommand.renderState),a.translucentCommand=c["a"].shallowClone(e,a.translucentCommand),Object(o["a"])(r)&&a.shaderProgramId===e.shaderProgram.id?(a.translucentCommand.shaderProgram=r,a.translucentCommand.renderState=n):(a.translucentCommand.shaderProgram=z(t,e.shaderProgram),a.translucentCommand.renderState=A(this,t,e.renderState),a.shaderProgramId=e.shaderProgram.id)):(Object(o["a"])(a.translucentCommand)&&(s=a.translucentCommand.shaderProgram,i=a.translucentCommand.renderState,u=a.alphaCommand.shaderProgram,d=a.alphaCommand.renderState),a.translucentCommand=c["a"].shallowClone(e,a.translucentCommand),a.alphaCommand=c["a"].shallowClone(e,a.alphaCommand),Object(o["a"])(s)&&a.shaderProgramId===e.shaderProgram.id?(a.translucentCommand.shaderProgram=s,a.translucentCommand.renderState=i,a.alphaCommand.shaderProgram=u,a.alphaCommand.renderState=d):(a.translucentCommand.shaderProgram=L(t,e.shaderProgram),a.translucentCommand.renderState=R(this,t,e.renderState),a.alphaCommand.shaderProgram=N(t,e.shaderProgram),a.alphaCommand.renderState=M(this,t,e.renderState),a.shaderProgramId=e.shaderProgram.id));return a},T.prototype.executeCommands=function(e,t,a,r,n){this._translucentMRTSupport?U(this,e,t,a,r,n):I(this,e,t,a,r,n)},T.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},T.prototype.clear=function(e,t,a){var r=t.framebuffer;t.framebuffer=this._opaqueFBO,n["a"].clone(a,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO;var o=this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand;o.execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,t)),t.framebuffer=r},T.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return w(this),Object(o["a"])(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),Object(o["a"])(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),Object(o["a"])(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),Object(s["a"])(this)},t["a"]=T}}]);