(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~f31eb030"],{"0d09":function(e,t,n){"use strict";var a={NEAREST:0,LINEAR:1};t["a"]=a},"18a0":function(e,t,n){"use strict";var a=n("bd8d"),i=n("2f63"),r=n("7d62"),o=n("93da"),s=n("f845"),u=n("ac3b"),c=n("a913");function h(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function l(e){while(Object(i["a"])(e.length))e=e.get(e.length-1);return e.name}function d(e,t,n,a,r){if(!a.enabled||!a._isSupported(t))return r;var o=n[a.name]={};if(Object(i["a"])(r)){var s=e.getStageByName(r);o[l(s)]=!0}var u=a.uniforms;if(Object(i["a"])(u))for(var c=Object.getOwnPropertyNames(u),h=c.length,d=0;d<h;++d){var _=u[c[d]];if("string"===typeof _){var f=e.getStageByName(_);Object(i["a"])(f)&&(o[l(f)]=!0)}}return a.name}function _(e,t,n,a,r){if(Object(i["a"])(a.enabled)&&!a.enabled||Object(i["a"])(a._isSupported)&&!a._isSupported(t))return r;for(var o,s,u=r,c=!Object(i["a"])(a.inputPreviousStageTexture)||a.inputPreviousStageTexture,h=r,f=a.length,p=0;p<f;++p){var m=a.get(p);h=Object(i["a"])(m.length)?_(e,t,n,m,r):d(e,t,n,m,r),c&&(r=h)}if(c)for(o=1;o<f;++o)s=l(a.get(o)),Object(i["a"])(n[s])||(n[s]={}),n[s][u]=!0;else for(o=1;o<f;++o){s=l(a.get(o));for(var g=n[s],b=0;b<o;++b)g[l(a.get(b))]=!0}return h}function f(e,t){var n={};if(Object(i["a"])(e.ambientOcclusion)){var a=e.ambientOcclusion,r=e.bloom,o=e._tonemapping,s=e.fxaa,u=_(e,t,n,a,void 0);u=_(e,t,n,r,u),u=d(e,t,n,o,u),u=_(e,t,n,e,u),d(e,t,n,s,u)}else _(e,t,n,e,void 0);return n}function p(e,t,n){var r,o,s=e._collection,u=s.getStageByName(t),c=u._textureScale,h=u._forcePowerOfTwo,l=u._pixelFormat,d=u._pixelDatatype,_=u._clearColor,f=e._framebuffers,p=f.length;for(r=0;r<p;++r)if(o=f[r],c===o.textureScale&&h===o.forcePowerOfTwo&&l===o.pixelFormat&&d===o.pixelDatatype&&a["a"].equals(_,o.clearColor)){for(var m=o.stages,g=m.length,b=!1,v=0;v<g;++v)if(n[m[v]]){b=!0;break}if(!b)break}return Object(i["a"])(o)&&r<p?(o.stages.push(t),o):(o={textureScale:c,forcePowerOfTwo:h,pixelFormat:l,pixelDatatype:d,clearColor:_,stages:[t],buffer:void 0,clear:void 0},f.push(o),o)}function m(e,t){var n=f(e._collection,t);for(var a in n)n.hasOwnProperty(a)&&(e._stageNameToFramebuffer[a]=p(e,a,n[a]))}function g(e){for(var t=e._framebuffers,n=t.length,a=0;a<n;++a){var i=t[a];i.buffer=i.buffer&&i.buffer.destroy(),i.buffer=void 0}}function b(e,t){for(var n=e._width,a=e._height,i=e._framebuffers,r=i.length,h=0;h<r;++h){var l=i[h],d=l.textureScale,_=Math.ceil(n*d),f=Math.ceil(a*d),p=Math.min(_,f);l.forcePowerOfTwo&&(o["a"].isPowerOfTwo(p)||(p=o["a"].nextPowerOfTwo(p)),_=p,f=p),l.buffer=new u["a"]({context:t,colorTextures:[new c["a"]({context:t,width:_,height:f,pixelFormat:l.pixelFormat,pixelDatatype:l.pixelDatatype})]}),l.clear=new s["a"]({color:l.clearColor,framebuffer:l.buffer})}}h.prototype.updateDependencies=function(){this._updateDependencies=!0},h.prototype.update=function(e){var t=this._collection,n=this._updateDependencies,a=Object(i["a"])(t.ambientOcclusion)&&t.ambientOcclusion.enabled&&t.ambientOcclusion._isSupported(e),r=Object(i["a"])(t.bloom)&&t.bloom.enabled&&t.bloom._isSupported(e),o=Object(i["a"])(t._tonemapping)&&t._tonemapping.enabled&&t._tonemapping._isSupported(e),s=Object(i["a"])(t.fxaa)&&t.fxaa.enabled&&t.fxaa._isSupported(e),u=!Object(i["a"])(t._activeStages)||t._activeStages.length>0||a||r||o||s;if((n||!u&&this._framebuffers.length>0)&&(g(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),n||u){0===this._framebuffers.length&&m(this,e);var c=e.drawingBufferWidth,h=e.drawingBufferHeight,l=this._width!==c||this._height!==h;(n||l)&&(this._width=c,this._height=h,this._updateDependencies=!1,g(this),b(this,e))}},h.prototype.clear=function(e){for(var t=this._framebuffers,n=0;n<t.length;++n)t[n].clear.execute(e)},h.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},h.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},h.prototype.getFramebuffer=function(e){var t=this._stageNameToFramebuffer[e];if(Object(i["a"])(t))return t.buffer},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return g(this),Object(r["a"])(this)},t["a"]=h},"2e78":function(e,t,n){"use strict";var a=n("535a"),i=n("2f63"),r=n("9f1d"),o=n("5e57"),s=n("0541"),u=n("7be3"),c=n("b71e"),h=n("e187"),l=n("5cb0"),d=n("aea3"),_=c["a"]+"\n"+u["a"],f=h["a"];function p(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT);var t=Object(a["a"])(e.translucent,!0),n=!1,r=p.VERTEX_FORMAT;this.material=Object(i["a"])(e.material)?e.material:d["a"].fromType(d["a"].ColorType),this.translucent=t,this._vertexShaderSource=Object(a["a"])(e.vertexShaderSource,_),this._fragmentShaderSource=Object(a["a"])(e.fragmentShaderSource,f),this._renderState=l["a"].getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=r}o["a"].isInternetExplorer()||(_="#define CLIP_POLYLINE \n"+_),Object(r["a"])(p.prototype,{vertexShaderSource:{get:function(){var e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&(e="#define POLYLINE_DASH\n"+e),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),p.VERTEX_FORMAT=s["a"].POSITION_AND_ST,p.prototype.getFragmentShaderSource=l["a"].prototype.getFragmentShaderSource,p.prototype.isTranslucent=l["a"].prototype.isTranslucent,p.prototype.getRenderState=l["a"].prototype.getRenderState,t["a"]=p},4082:function(e,t,n){"use strict";var a=n("cef5"),i=n("670c"),r=n("be18"),o=n("a561"),s=n("bef8"),u=n("bd8d"),c=n("2bb9"),h=n("abab"),l=n("535a"),d=n("2f63"),_=n("9f1d"),f=n("7d62"),p=n("6cbd"),m=n("5e57"),g=n("0123"),b=n("66bf"),v=n("93da"),S=n("52f0"),y=n("188e"),x=n("283e"),T=n("f20a"),O=n("8b68"),E=n("b997"),w=n("a894"),D=n("d289"),I=n("6dc0"),C=n("e90c"),A=n("5770"),P=n("a913"),j=n("7c5e"),B=n("b71e"),N=n("e187"),L=n("bfb2"),R=n("2cc3"),M=n("b7c8"),F=n("aea3"),U=n("ee1e"),z=n("aee6"),V=n("31af");function k(e,t){e=Object(l["a"])(e,l["a"].EMPTY_OBJECT),this._show=Object(l["a"])(e.show,!0),this._width=Object(l["a"])(e.width,1),this._loop=Object(l["a"])(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,Object(d["a"])(this._material)||(this._material=F["a"].fromType(F["a"].ColorType,{color:new u["a"](1,1,1,1)}));var n,i=e.positions;Object(d["a"])(i)||(i=[]),this._positions=i,this._actualPositions=Object(U["a"])(i,r["a"].equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=i.slice()),this._actualPositions.push(r["a"].clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id,Object(d["a"])(t)&&(n=S["a"].clone(t.modelMatrix)),this._modelMatrix=n,this._segments=V["a"].wrapLongitude(this._actualPositions,n),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(J),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=a["a"].fromPoints(this._actualPositions),this._boundingVolumeWC=a["a"].transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new a["a"]}var H=k.POSITION_INDEX=0,Y=k.SHOW_INDEX=1,W=k.WIDTH_INDEX=2,X=k.MATERIAL_INDEX=3,G=k.POSITION_SIZE_INDEX=4,q=k.DISTANCE_DISPLAY_CONDITION=5,J=k.NUMBER_OF_PROPERTIES=6;function K(e,t){++e._propertiesChanged[t];var n=e._polylineCollection;Object(d["a"])(n)&&(n._updatePolyline(e,t),e._dirty=!0)}Object(_["a"])(k.prototype,{show:{get:function(){return this._show},set:function(e){e!==this._show&&(this._show=e,K(this,Y))}},positions:{get:function(){return this._positions},set:function(e){var t=Object(U["a"])(e,r["a"].equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(r["a"].clone(t[0]))),this._actualPositions.length===t.length&&this._actualPositions.length===this._length||K(this,G),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=a["a"].fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=a["a"].transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),K(this,H),this.update()}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,K(this,X))}},width:{get:function(){return this._width},set:function(e){var t=this._width;e!==t&&(this._width=e,K(this,W))}},loop:{get:function(){return this._loop},set:function(e){if(e!==this._loop){var t=this._actualPositions;e?t.length>2&&!r["a"].equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(r["a"].clone(t[0]))):t.length>2&&r["a"].equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,K(this,G)}}},id:{get:function(){return this._id},set:function(e){this._id=e,Object(d["a"])(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){z["a"].equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=z["a"].clone(e,this._distanceDisplayCondition),K(this,q))}}}),k.prototype.update=function(){var e=S["a"].IDENTITY;Object(d["a"])(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);var t=this._segments.positions.length,n=this._segments.lengths,i=this._propertiesChanged[H]>0||this._propertiesChanged[G]>0;if(S["a"].equals(e,this._modelMatrix)&&!i||(this._segments=V["a"].wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=a["a"].transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=S["a"].clone(e,this._modelMatrix),this._segments.positions.length!==t)K(this,G);else for(var r=n.length,o=0;o<r;++o)if(n[o]!==this._segments.lengths[o]){K(this,G);break}},k.prototype.getPickId=function(e){return Object(d["a"])(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},k.prototype._clean=function(){this._dirty=!1;for(var e=this._propertiesChanged,t=0;t<J-1;++t)e[t]=0},k.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var Q=k,Z=n("a307"),$=Q.SHOW_INDEX,ee=Q.WIDTH_INDEX,te=Q.POSITION_INDEX,ne=Q.MATERIAL_INDEX,ae=Q.POSITION_SIZE_INDEX,ie=Q.DISTANCE_DISPLAY_CONDITION,re=Q.NUMBER_OF_PROPERTIES,oe={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function se(e){e=Object(l["a"])(e,l["a"].EMPTY_OBJECT),this.modelMatrix=S["a"].clone(Object(l["a"])(e.modelMatrix,S["a"].IDENTITY)),this._modelMatrix=S["a"].clone(S["a"].IDENTITY),this.debugShowBoundingVolume=Object(l["a"])(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(re),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:O["a"].STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=u["a"].clone(u["a"].WHITE);var t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}function ue(e,t){Object(d["a"])(e._batchTable)&&e._batchTable.destroy();var n=[{functionName:"batchTable_getWidthAndShow",componentDatatype:h["a"].UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:h["a"].UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:h["a"].FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:h["a"].FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:h["a"].FLOAT,componentsPerAttribute:2}];e._batchTable=new R["a"](t,n,e._polylines.length)}Object(_["a"])(se.prototype,{length:{get:function(){return Te(this),this._polylines.length}}}),se.prototype.add=function(e){var t=new Q(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},se.prototype.remove=function(e){if(this.contains(e)){this._polylines[e._index]=void 0;var t=this._polylinesToUpdate.indexOf(e);if(-1!==t&&this._polylinesToUpdate.splice(t,1),this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,Object(d["a"])(e._bucket)){var n=e._bucket;n.shaderProgram=n.shaderProgram&&n.shaderProgram.destroy()}return e._destroy(),!0}return!1},se.prototype.removeAll=function(){Oe(this),we(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},se.prototype.contains=function(e){return Object(d["a"])(e)&&e._polylineCollection===this},se.prototype.get=function(e){return Te(this),this._polylines[e]};var ce=new p["a"],he=new o["a"],le=new i["a"];se.prototype.update=function(e){if(Te(this),0!==this._polylines.length){xe(this,e);var t,n=e.context,a=e.mapProjection,r=this._propertiesChanged;if(this._createBatchTable){if(0===E["a"].maximumVertexTextureImageUnits)throw new x["a"]("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");ue(this,n),this._createBatchTable=!1}if(this._createVertexArray||pe(this))ge(this,n,a);else if(this._polylinesUpdated){var s=this._polylinesToUpdate;if(this._mode!==Z["a"].SCENE3D)for(var u=s.length,c=0;c<u;++c)t=s[c],t.update();if(r[ae]||r[ne])ge(this,n,a);else for(var h=s.length,l=this._polylineBuckets,_=0;_<h;++_){t=s[_],r=t._propertiesChanged;var f=t._bucket,m=0;for(var g in l)if(l.hasOwnProperty(g)){if(l[g]===f){r[te]&&f.writeUpdate(m,t,this._positionBuffer,a);break}m+=l[g].lengthOfPositions}if((r[$]||r[ee])&&this._batchTable.setBatchedAttribute(t._index,0,new i["a"](t._width,t._show)),this._batchTable.attributes.length>2){if(r[te]||r[ae]){var b=e.mode===Z["a"].SCENE2D?t._boundingVolume2D:t._boundingVolumeWC,v=p["a"].fromCartesian(b.center,ce),y=o["a"].fromElements(v.low.x,v.low.y,v.low.z,b.radius,he);this._batchTable.setBatchedAttribute(t._index,2,v.high),this._batchTable.setBatchedAttribute(t._index,3,y)}if(r[ie]){var T=le;T.x=0,T.y=Number.MAX_VALUE;var O=t.distanceDisplayCondition;Object(d["a"])(O)&&(T.x=O.near,T.y=O.far),this._batchTable.setBatchedAttribute(t._index,4,T)}}t._clean()}s.length=0,this._polylinesUpdated=!1}r=this._propertiesChanged;for(var w=0;w<re;++w)r[w]=0;var D=S["a"].IDENTITY;e.mode===Z["a"].SCENE3D&&(D=this.modelMatrix);var C=e.passes,A=0!==e.morphTime;if(Object(d["a"])(this._opaqueRS)&&this._opaqueRS.depthTest.enabled===A||(this._opaqueRS=I["a"].fromCache({depthMask:A,depthTest:{enabled:A}})),Object(d["a"])(this._translucentRS)&&this._translucentRS.depthTest.enabled===A||(this._translucentRS=I["a"].fromCache({blending:M["a"].ALPHA_BLEND,depthMask:!A,depthTest:{enabled:A}})),this._batchTable.update(e),C.render||C.pick){var P=this._colorCommands;fe(this,e,P,D)}}};var de=new a["a"],_e=new a["a"];function fe(e,t,n,i){for(var r=t.context,o=t.commandList,s=n.length,u=0,h=!0,l=e._vertexArrays,_=e.debugShowBoundingVolume,f=e._batchTable,p=f.getUniformMapCallback(),m=l.length,g=0;g<m;++g)for(var b=l[g],v=b.buckets,S=v.length,y=0;y<S;++y){for(var x,T,O,E,I=v[y],C=I.offset,A=I.bucket.shaderProgram,P=I.bucket.polylines,j=P.length,B=0,N=0;N<j;++N){var L=P[N],R=Se(L._material);if(R!==x){if(Object(d["a"])(x)&&B>0){var M=T.isTranslucent();u>=s?(O=new w["a"]({owner:e}),n.push(O)):O=n[u],++u,E=Object(c["a"])(p(T._uniforms),e._uniformMap),O.boundingVolume=a["a"].clone(de,O.boundingVolume),O.modelMatrix=i,O.shaderProgram=A,O.vertexArray=b.va,O.renderState=M?e._translucentRS:e._opaqueRS,O.pass=M?D["a"].TRANSLUCENT:D["a"].OPAQUE,O.debugShowBoundingVolume=_,O.pickId="v_pickColor",O.uniformMap=E,O.count=B,O.offset=C,C+=B,B=0,h=!0,o.push(O)}T=L._material,T.update(r),x=R}for(var F,U=L._locatorBuckets,z=U.length,V=0;V<z;++V){var k=U[V];k.locator===I&&(B+=k.count)}t.mode===Z["a"].SCENE3D?F=L._boundingVolumeWC:t.mode===Z["a"].COLUMBUS_VIEW?F=L._boundingVolume2D:t.mode===Z["a"].SCENE2D?Object(d["a"])(L._boundingVolume2D)&&(F=a["a"].clone(L._boundingVolume2D,_e),F.center.x=0):Object(d["a"])(L._boundingVolumeWC)&&Object(d["a"])(L._boundingVolume2D)&&(F=a["a"].union(L._boundingVolumeWC,L._boundingVolume2D,_e)),h?(h=!1,a["a"].clone(F,de)):a["a"].union(F,de,de)}Object(d["a"])(x)&&B>0&&(u>=s?(O=new w["a"]({owner:e}),n.push(O)):O=n[u],++u,E=Object(c["a"])(p(T._uniforms),e._uniformMap),O.boundingVolume=a["a"].clone(de,O.boundingVolume),O.modelMatrix=i,O.shaderProgram=A,O.vertexArray=b.va,O.renderState=T.isTranslucent()?e._translucentRS:e._opaqueRS,O.pass=T.isTranslucent()?D["a"].TRANSLUCENT:D["a"].OPAQUE,O.debugShowBoundingVolume=_,O.pickId="v_pickColor",O.uniformMap=E,O.count=B,O.offset=C,h=!0,o.push(O)),x=void 0}n.length=u}function pe(e){var t=!1,n=e._propertiesChanged,a=e._positionBufferUsage;return n[te]?a.bufferUsage!==O["a"].STREAM_DRAW?(t=!0,a.bufferUsage=O["a"].STREAM_DRAW,a.frameCount=100):a.frameCount=100:a.bufferUsage!==O["a"].STATIC_DRAW&&(0===a.frameCount?(t=!0,a.bufferUsage=O["a"].STATIC_DRAW):a.frameCount--),t}se.prototype.isDestroyed=function(){return!1},se.prototype.destroy=function(){return Ee(this),Oe(this),we(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(f["a"])(this)};var me=[0,0,0];function ge(e,t,n){e._createVertexArray=!1,Oe(e),Ee(e),ye(e);var a,i,r=[[]],o=r[0],s=e._batchTable,u=e._useHighlightColor,c=[0],l=0,_=[[]],f=0,p=e._polylineBuckets;for(a in p)p.hasOwnProperty(a)&&(i=p[a],i.updateShader(t,s,u),f+=i.lengthOfPositions);if(f>0){var m,b=e._mode,S=new Float32Array(6*f*3),y=new Float32Array(4*f),x=0,E=0,w=0;for(a in p)if(p.hasOwnProperty(a)){i=p[a],i.write(S,y,x,E,w,s,t,n),b===Z["a"].MORPHING&&(Object(d["a"])(m)||(m=new Float32Array(6*f*3)),i.writeForMorph(m,x));var D=i.lengthOfPositions;x+=6*D*3,E+=4*D,w+=4*D,l=i.updateIndices(r,c,_,l)}var I,C=e._positionBufferUsage.bufferUsage,A=O["a"].STATIC_DRAW;e._positionBuffer=T["a"].createVertexBuffer({context:t,typedArray:S,usage:C}),Object(d["a"])(m)&&(I=T["a"].createVertexBuffer({context:t,typedArray:m,usage:C})),e._texCoordExpandAndBatchIndexBuffer=T["a"].createVertexBuffer({context:t,typedArray:y,usage:A});for(var P=3*Float32Array.BYTES_PER_ELEMENT,B=4*Float32Array.BYTES_PER_ELEMENT,N=0,L=r.length,R=0;R<L;++R)if(o=r[R],o.length>0){var M=new Uint16Array(o),F=T["a"].createIndexBuffer({context:t,typedArray:M,usage:O["a"].STATIC_DRAW,indexDatatype:g["a"].UNSIGNED_SHORT});N+=c[R];var U,z,V,k,H=6*(R*(P*v["a"].SIXTY_FOUR_KILOBYTES)-N*P),Y=P+H,W=P+Y,X=P+W,G=P+X,q=P+G,J=R*(B*v["a"].SIXTY_FOUR_KILOBYTES)-N*B,K=[{index:oe.position3DHigh,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:H,strideInBytes:6*P},{index:oe.position3DLow,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:Y,strideInBytes:6*P},{index:oe.position2DHigh,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:H,strideInBytes:6*P},{index:oe.position2DLow,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:Y,strideInBytes:6*P},{index:oe.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:W,strideInBytes:6*P},{index:oe.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:X,strideInBytes:6*P},{index:oe.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:W,strideInBytes:6*P},{index:oe.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:X,strideInBytes:6*P},{index:oe.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:G,strideInBytes:6*P},{index:oe.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:q,strideInBytes:6*P},{index:oe.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:G,strideInBytes:6*P},{index:oe.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:h["a"].FLOAT,offsetInBytes:q,strideInBytes:6*P},{index:oe.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:h["a"].FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:J}];b===Z["a"].SCENE3D?(U=e._positionBuffer,z="vertexBuffer",V=me,k="value"):b===Z["a"].SCENE2D||b===Z["a"].COLUMBUS_VIEW?(U=me,z="value",V=e._positionBuffer,k="vertexBuffer"):(U=I,z="vertexBuffer",V=e._positionBuffer,k="vertexBuffer"),K[0][z]=U,K[1][z]=U,K[2][k]=V,K[3][k]=V,K[4][z]=U,K[5][z]=U,K[6][k]=V,K[7][k]=V,K[8][z]=U,K[9][z]=U,K[10][k]=V,K[11][k]=V;var Q=new j["a"]({context:t,attributes:K,indexBuffer:F});e._vertexArrays.push({va:Q,buckets:_[R]})}}}function be(e,t){return t instanceof P["a"]?t.id:t}var ve=[];function Se(e){var t=F["a"]._uniformList[e.type],n=t.length;ve.length=2*n;for(var a=0,i=0;i<n;++i){var r=t[i];ve[a]=r,ve[a+1]=e._uniforms[r](),a+=2}return e.type+":"+JSON.stringify(ve,be)}function ye(e){for(var t=e._mode,n=e._modelMatrix,a=e._polylineBuckets={},i=e._polylines,r=i.length,o=0;o<r;++o){var s=i[o];if(s._actualPositions.length>1){s.update();var u=s.material,c=a[u.type];Object(d["a"])(c)||(c=a[u.type]=new Ie(u,t,n)),c.addPolyline(s)}}}function xe(e,t){var n=t.mode;e._mode===n&&S["a"].equals(e._modelMatrix,e.modelMatrix)||(e._mode=n,e._modelMatrix=S["a"].clone(e.modelMatrix),e._createVertexArray=!0)}function Te(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;for(var t=[],n=e._polylines.length,a=0,i=0;a<n;++a){var r=e._polylines[a];Object(d["a"])(r)&&(r._index=i++,t.push(r))}e._polylines=t}}function Oe(e){for(var t=e._polylines,n=t.length,a=0;a<n;++a)if(Object(d["a"])(t[a])){var i=t[a]._bucket;Object(d["a"])(i)&&(i.shaderProgram=i.shaderProgram&&i.shaderProgram.destroy())}}function Ee(e){for(var t=e._vertexArrays.length,n=0;n<t;++n)e._vertexArrays[n].va.destroy();e._vertexArrays.length=0}function we(e){for(var t=e._polylines,n=t.length,a=0;a<n;++a)Object(d["a"])(t[a])&&t[a]._destroy()}function De(e,t,n){this.count=e,this.offset=t,this.bucket=n}function Ie(e,t,n){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=n}function Ce(e){return r["a"].dot(r["a"].UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(y["a"].ORIGIN_ZX_PLANE)===b["a"].INTERSECTING}se.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},Ie.prototype.addPolyline=function(e){var t=this.polylines;t.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},Ie.prototype.updateShader=function(e,t,n){if(!Object(d["a"])(this.shaderProgram)){var a=["DISTANCE_DISPLAY_CONDITION"];n&&a.push("VECTOR_TILE"),-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&a.push("POLYLINE_DASH"),m["a"].isInternetExplorer()||a.push("CLIP_POLYLINE");var i=new A["a"]({defines:a,sources:["varying vec4 v_pickColor;\n",this.material.shaderSource,N["a"]]}),r=t.getVertexShaderCallback()(L["a"]),o=new A["a"]({defines:a,sources:[B["a"],r]});this.shaderProgram=C["a"].fromCache({context:e,vertexShaderSource:o,fragmentShaderSource:i,attributeLocations:oe})}},Ie.prototype.getPolylinePositionsLength=function(e){var t;if(this.mode===Z["a"].SCENE3D||!Ce(e))return t=e._actualPositions.length,4*t-4;var n=0,a=e._segments.lengths;t=a.length;for(var i=0;i<t;++i)n+=4*a[i]-4;return n};var Ae=new r["a"],Pe=new r["a"],je=new r["a"],Be=new r["a"],Ne=new o["a"],Le=new i["a"];Ie.prototype.write=function(e,t,n,a,i,s,c,h){for(var l=this.mode,_=h.ellipsoid.maximumRadius*v["a"].PI,f=this.polylines,m=f.length,g=0;g<m;++g){for(var b,S=f[g],y=S.width,x=S.show&&y>0,T=S._index,O=this.getSegments(S,h),E=O.positions,w=O.lengths,D=E.length,I=S.getPickId(c).color,C=0,A=0,P=0;P<D;++P){0===P?S._loop?b=E[D-2]:(b=Be,r["a"].subtract(E[0],E[1],b),r["a"].add(E[0],b,b)):b=E[P-1],r["a"].clone(b,Pe),r["a"].clone(E[P],Ae),P===D-1?S._loop?b=E[1]:(b=Be,r["a"].subtract(E[D-1],E[D-2],b),r["a"].add(E[D-1],b,b)):b=E[P+1],r["a"].clone(b,je);var j=w[C];P===A+j&&(A+=j,++C);var B=P-A===0,N=P===A+w[C]-1;l===Z["a"].SCENE2D&&(Pe.z=0,Ae.z=0,je.z=0),l!==Z["a"].SCENE2D&&l!==Z["a"].MORPHING||(B||N)&&_-Math.abs(Ae.x)<1&&((Ae.x<0&&Pe.x>0||Ae.x>0&&Pe.x<0)&&r["a"].clone(Ae,Pe),(Ae.x<0&&je.x>0||Ae.x>0&&je.x<0)&&r["a"].clone(Ae,je));for(var L=B?2:0,R=N?2:4,M=L;M<R;++M){p["a"].writeElements(Ae,e,n),p["a"].writeElements(Pe,e,n+6),p["a"].writeElements(je,e,n+12);var F=M-2<0?-1:1;t[i]=P/(D-1),t[i+1]=M%2*2-1,t[i+2]=F,t[i+3]=T,n+=18,i+=4}}var U=Ne;U.x=u["a"].floatToByte(I.red),U.y=u["a"].floatToByte(I.green),U.z=u["a"].floatToByte(I.blue),U.w=u["a"].floatToByte(I.alpha);var z=Le;z.x=y,z.y=x?1:0;var V=l===Z["a"].SCENE2D?S._boundingVolume2D:S._boundingVolumeWC,k=p["a"].fromCartesian(V.center,ce),H=k.high,Y=o["a"].fromElements(k.low.x,k.low.y,k.low.z,V.radius,he),W=le;W.x=0,W.y=Number.MAX_VALUE;var X=S.distanceDisplayCondition;Object(d["a"])(X)&&(W.x=X.near,W.y=X.far),s.setBatchedAttribute(T,0,z),s.setBatchedAttribute(T,1,U),s.attributes.length>2&&(s.setBatchedAttribute(T,2,H),s.setBatchedAttribute(T,3,Y),s.setBatchedAttribute(T,4,W))}};var Re=new r["a"],Me=new r["a"],Fe=new r["a"],Ue=new r["a"];Ie.prototype.writeForMorph=function(e,t){for(var n=this.modelMatrix,a=this.polylines,i=a.length,o=0;o<i;++o)for(var s=a[o],u=s._segments.positions,c=s._segments.lengths,h=u.length,l=0,d=0,_=0;_<h;++_){var f;0===_?s._loop?f=u[h-2]:(f=Ue,r["a"].subtract(u[0],u[1],f),r["a"].add(u[0],f,f)):f=u[_-1],f=S["a"].multiplyByPoint(n,f,Me);var m,g=S["a"].multiplyByPoint(n,u[_],Re);_===h-1?s._loop?m=u[1]:(m=Ue,r["a"].subtract(u[h-1],u[h-2],m),r["a"].add(u[h-1],m,m)):m=u[_+1],m=S["a"].multiplyByPoint(n,m,Fe);var b=c[l];_===d+b&&(d+=b,++l);for(var v=_-d===0,y=_===d+c[l]-1,x=v?2:0,T=y?2:4,O=x;O<T;++O)p["a"].writeElements(g,e,t),p["a"].writeElements(f,e,t+6),p["a"].writeElements(m,e,t+12),t+=18}};var ze=new Array(1);Ie.prototype.updateIndices=function(e,t,n,a){var i=n.length-1,r=new De(0,a,this);n[i].push(r);var o=0,s=e[e.length-1],u=0;s.length>0&&(u=s[s.length-1]+1);for(var c=this.polylines,h=c.length,l=0;l<h;++l){var d,_=c[l];if(_._locatorBuckets=[],this.mode===Z["a"].SCENE3D){d=ze;var f=_._actualPositions.length;if(!(f>0))continue;d[0]=f}else d=_._segments.lengths;var p=d.length;if(p>0){for(var m=0,g=0;g<p;++g)for(var b=d[g]-1,S=0;S<b;++S)u+4>v["a"].SIXTY_FOUR_KILOBYTES&&(_._locatorBuckets.push({locator:r,count:m}),m=0,t.push(4),s=[],e.push(s),u=0,r.count=o,o=0,a=0,r=new De(0,0,this),n[++i]=[r]),s.push(u,u+2,u+1),s.push(u+1,u+2,u+3),m+=6,o+=6,a+=6,u+=4;_._locatorBuckets.push({locator:r,count:m}),u+4>v["a"].SIXTY_FOUR_KILOBYTES&&(t.push(0),s=[],e.push(s),u=0,r.count=o,a=0,o=0,r=new De(0,0,this),n[++i]=[r])}_._clean()}return r.count=o,a},Ie.prototype.getPolylineStartIndex=function(e){for(var t=this.polylines,n=0,a=t.length,i=0;i<a;++i){var r=t[i];if(r===e)break;n+=r._actualLength}return n};var Ve,ke={positions:void 0,lengths:void 0},He=new Array(1),Ye=new r["a"],We=new s["a"];Ie.prototype.getSegments=function(e,t){var n=e._actualPositions;if(this.mode===Z["a"].SCENE3D)return He[0]=n.length,ke.positions=n,ke.lengths=He,ke;Ce(e)&&(n=e._segments.positions);for(var i,o=t.ellipsoid,s=[],u=this.modelMatrix,c=n.length,h=Ye,l=0;l<c;++l)i=n[l],h=S["a"].multiplyByPoint(u,i,h),s.push(t.project(o.cartesianToCartographic(h,We)));if(s.length>0){e._boundingVolume2D=a["a"].fromPoints(s,e._boundingVolume2D);var d=e._boundingVolume2D.center;e._boundingVolume2D.center=new r["a"](d.z,d.x,d.y)}return ke.positions=s,ke.lengths=e._segments.lengths,ke},Ie.prototype.writeUpdate=function(e,t,n,a){var i=this.mode,o=a.ellipsoid.maximumRadius*v["a"].PI,s=t._actualLength;if(s){e+=this.getPolylineStartIndex(t);var u=Ve,c=6*s*3;!Object(d["a"])(u)||u.length<c?u=Ve=new Float32Array(c):u.length>c&&(u=new Float32Array(u.buffer,0,c));var h,l=this.getSegments(t,a),_=l.positions,f=l.lengths,m=0,g=0,b=0;s=_.length;for(var S=0;S<s;++S){0===S?t._loop?h=_[s-2]:(h=Be,r["a"].subtract(_[0],_[1],h),r["a"].add(_[0],h,h)):h=_[S-1],r["a"].clone(h,Pe),r["a"].clone(_[S],Ae),S===s-1?t._loop?h=_[1]:(h=Be,r["a"].subtract(_[s-1],_[s-2],h),r["a"].add(_[s-1],h,h)):h=_[S+1],r["a"].clone(h,je);var y=f[g];S===b+y&&(b+=y,++g);var x=S-b===0,T=S===b+f[g]-1;i===Z["a"].SCENE2D&&(Pe.z=0,Ae.z=0,je.z=0),i!==Z["a"].SCENE2D&&i!==Z["a"].MORPHING||(x||T)&&o-Math.abs(Ae.x)<1&&((Ae.x<0&&Pe.x>0||Ae.x>0&&Pe.x<0)&&r["a"].clone(Ae,Pe),(Ae.x<0&&je.x>0||Ae.x>0&&je.x<0)&&r["a"].clone(Ae,je));for(var O=x?2:0,E=T?2:4,w=O;w<E;++w)p["a"].writeElements(Ae,u,m),p["a"].writeElements(Pe,u,m+6),p["a"].writeElements(je,u,m+12),m+=18}n.copyFromArrayView(u,18*Float32Array.BYTES_PER_ELEMENT*e)}};t["a"]=se},"63ae":function(e,t,n){"use strict";var a=n("535a"),i=n("9f1d"),r=n("5e57"),o=n("0541"),s=n("d3f9"),u=n("a0fe"),c=n("b71e"),h=n("5cb0"),l=c["a"]+"\n"+u["a"],d=s["a"];function _(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT);var t=Object(a["a"])(e.translucent,!0),n=!1,i=_.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=Object(a["a"])(e.vertexShaderSource,l),this._fragmentShaderSource=Object(a["a"])(e.fragmentShaderSource,d),this._renderState=h["a"].getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=i}r["a"].isInternetExplorer()||(l="#define CLIP_POLYLINE \n"+l),Object(i["a"])(_.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),_.VERTEX_FORMAT=o["a"].POSITION_ONLY,_.prototype.getFragmentShaderSource=h["a"].prototype.getFragmentShaderSource,_.prototype.isTranslucent=h["a"].prototype.isTranslucent,_.prototype.getRenderState=h["a"].prototype.getRenderState,t["a"]=_},9249:function(e,t,n){"use strict";var a=n("77af"),i=n("bd8d"),r=n("2bb9"),o=n("71ce"),s=n("535a"),u=n("2f63"),c=n("9f1d"),h=n("7d62"),l=n("e42d"),d=n("d4ed"),_=n("00f8"),f=n("6ef5"),p=n("6dc0"),m=n("6c84"),g=n("5770"),b=n("a913"),v=n("3022"),S=n("03f1"),y=n("23b6"),x=n("a58e"),T=n("0d09");function O(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT);var t=e.fragmentShader,n=Object(s["a"])(e.textureScale,1),r=Object(s["a"])(e.pixelFormat,l["a"].RGBA);this._fragmentShader=t,this._uniforms=e.uniforms,this._textureScale=n,this._forcePowerOfTwo=Object(s["a"])(e.forcePowerOfTwo,!1),this._sampleMode=Object(s["a"])(e.sampleMode,T["a"].NEAREST),this._pixelFormat=r,this._pixelDatatype=Object(s["a"])(e.pixelDatatype,f["a"].UNSIGNED_BYTE),this._clearColor=Object(s["a"])(e.clearColor,i["a"].BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;var c=new _["a"];c.scissorTest={enabled:!0,rectangle:Object(u["a"])(e.scissorRectangle)?a["a"].clone(e.scissorRectangle):new a["a"]},this._passState=c,this._ready=!1;var h=e.name;Object(u["a"])(h)||(h=Object(o["a"])()),this._name=h,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object(c["a"])(O.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(Object(u["a"])(this._textureCache)){var e=this._textureCache.getFramebuffer(this._name);if(Object(u["a"])(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});var E=/uniform\s+sampler2D\s+depthTexture/g;function w(e,t,n){var a=t[n];return("string"===typeof a||a instanceof HTMLCanvasElement||a instanceof HTMLImageElement||a instanceof HTMLVideoElement||a instanceof ImageData)&&e._dirtyUniforms.push(n),{get:function(){return t[n]},set:function(a){var i=t[n];t[n]=a;var r=e._actualUniforms,o=r[n];Object(u["a"])(o)&&o!==i&&o instanceof b["a"]&&!Object(u["a"])(e._textureCache.getStageByName(n))&&(e._texturesToRelease.push(o),delete r[n],delete r[n+"Dimensions"]),i instanceof b["a"]&&e._texturesToRelease.push(i),"string"===typeof a||a instanceof HTMLCanvasElement||a instanceof HTMLImageElement||a instanceof HTMLVideoElement||a instanceof ImageData?e._dirtyUniforms.push(n):r[n]=a}}}function D(e,t){return function(){var n=e._actualUniforms[t];return"function"===typeof n?n():n}}function I(e,t){return function(){var n=e[t]();if(Object(u["a"])(n))return n.dimensions}}function C(e){if(!Object(u["a"])(e._uniformMap)){var t={},n={},a=e._uniforms,i=e._actualUniforms;for(var o in a)if(a.hasOwnProperty(o)){"function"!==typeof a[o]?(t[o]=D(e,o),n[o]=w(e,a,o)):(t[o]=a[o],n[o]=a[o]),i[o]=a[o];var s=t[o]();("string"===typeof s||s instanceof b["a"]||s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement)&&(t[o+"Dimensions"]=I(t,o))}e._uniforms={},Object(c["a"])(e._uniforms,n),e._uniformMap=Object(r["a"])(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}}function A(e,t){if(!Object(u["a"])(e._command)||e._logDepthChanged||e._selectedDirty){var n=e._fragmentShader;if(Object(u["a"])(e._selectedIdTexture)){var a=e._selectedIdTexture.width;n=n.replace(/varying\s+vec2\s+v_textureCoordinates;/g,""),n="#define CZM_SELECTED_FEATURE \nuniform sampler2D czm_idTexture; \nuniform sampler2D czm_selectedIdTexture; \nuniform float czm_selectedIdTextureStep; \nvarying vec2 v_textureCoordinates; \nbool czm_selected(vec2 offset) \n{ \n    bool selected = false;\n    vec4 id = texture2D(czm_idTexture, v_textureCoordinates + offset); \n    for (int i = 0; i < "+a+"; ++i) \n    { \n        vec4 selectedId = texture2D(czm_selectedIdTexture, vec2((float(i) + 0.5) * czm_selectedIdTextureStep, 0.5)); \n        if (all(equal(id, selectedId))) \n        { \n            return true; \n        } \n    } \n    return false; \n} \n\nbool czm_selected() \n{ \n    return czm_selected(vec2(0.0)); \n} \n\n"+n}var i=new g["a"]({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[n]});e._command=t.createViewportQuadCommand(i,{uniformMap:e._uniformMap,owner:e})}}function P(e){var t,n,a=e._sampleMode;a===T["a"].LINEAR?(t=S["a"].LINEAR,n=v["a"].LINEAR):(t=S["a"].NEAREST,n=v["a"].NEAREST);var i=e._sampler;Object(u["a"])(i)&&i.minificationFilter===t&&i.magnificationFilter===n||(e._sampler=new m["a"]({wrapS:y["a"].CLAMP_TO_EDGE,wrapT:y["a"].CLAMP_TO_EDGE,minificationFilter:t,magnificationFilter:n}))}function j(e,t){return function(n){e._texturesToCreate.push({name:t,source:n})}}function B(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function N(e,t){var n,a,i,r=e._texturesToRelease,o=r.length;for(n=0;n<o;++n)a=r[n],a=a&&a.destroy();r.length=0;var s=e._texturesToCreate;for(o=s.length,n=0;n<o;++n){var c=s[n];i=c.name;var h=c.source;e._actualUniforms[i]=new b["a"]({context:t,source:h})}s.length=0;var l=e._dirtyUniforms;if(0!==l.length||Object(u["a"])(e._texturePromise)){if(0!==l.length&&!Object(u["a"])(e._texturePromise)){o=l.length;var _=e._uniforms,f=[];for(n=0;n<o;++n){i=l[n];var p=_[i],m=e._textureCache.getStageByName(p);if(Object(u["a"])(m))e._actualUniforms[i]=B(e,p);else if("string"===typeof p){var g=new d["a"]({url:p});f.push(g.fetchImage().then(j(e,i)))}else e._texturesToCreate.push({name:i,source:p})}l.length=0,f.length>0?(e._ready=!1,e._texturePromise=x["a"].all(f).then((function(){e._ready=!0,e._texturePromise=void 0}))):e._ready=!0}}else e._ready=!0}function L(e){Object(u["a"])(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();var t=e._textureCache;if(Object(u["a"])(t)){var n=e._uniforms,a=e._actualUniforms;for(var i in a)a.hasOwnProperty(i)&&a[i]instanceof b["a"]&&(Object(u["a"])(t.getStageByName(n[i]))||a[i].destroy(),e._dirtyUniforms.push(i))}}function R(e){var t=Object(u["a"])(e._selected)?e._selected.length:0,n=Object(u["a"])(e._parentSelected)?e._parentSelected:0,a=e._selected!==e._selectedShadow||t!==e._selectedLength;if(a=a||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength,Object(u["a"])(e._selected)&&Object(u["a"])(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):Object(u["a"])(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!a&&Object(u["a"])(e._combinedSelected)){if(!Object(u["a"])(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var i=0;i<t;++i)if(e._combinedSelected[i]!==e._combinedSelectedShadow[i])return!0}return a}function M(e,t){if(e._selectedDirty){e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;var n=e._combinedSelected;if(Object(u["a"])(n)){var a,r,o,s=0,c=n.length;for(a=0;a<c;++a)r=n[a],Object(u["a"])(r.pickIds)?s+=r.pickIds.length:Object(u["a"])(r.pickId)&&++s;if(0===c||0===s){var h=new Uint8Array(4);return h[0]=255,h[1]=255,h[2]=255,h[3]=255,void(e._selectedIdTexture=new b["a"]({context:t,pixelFormat:l["a"].RGBA,pixelDatatype:f["a"].UNSIGNED_BYTE,source:{arrayBufferView:h,width:1,height:1},sampler:new m["a"]({wrapS:y["a"].CLAMP_TO_EDGE,wrapT:y["a"].CLAMP_TO_EDGE,minificationFilter:S["a"].NEAREST,magnificationFilter:v["a"].NEAREST})}))}var d=0,_=new Uint8Array(4*s);for(a=0;a<c;++a)if(r=n[a],Object(u["a"])(r.pickIds))for(var p=r.pickIds,g=p.length,x=0;x<g;++x)o=p[x].color,_[d]=i["a"].floatToByte(o.red),_[d+1]=i["a"].floatToByte(o.green),_[d+2]=i["a"].floatToByte(o.blue),_[d+3]=i["a"].floatToByte(o.alpha),d+=4;else Object(u["a"])(r.pickId)&&(o=r.pickId.color,_[d]=i["a"].floatToByte(o.red),_[d+1]=i["a"].floatToByte(o.green),_[d+2]=i["a"].floatToByte(o.blue),_[d+3]=i["a"].floatToByte(o.alpha),d+=4);e._selectedIdTexture=new b["a"]({context:t,pixelFormat:l["a"].RGBA,pixelDatatype:f["a"].UNSIGNED_BYTE,source:{arrayBufferView:_,width:s,height:1},sampler:new m["a"]({wrapS:y["a"].CLAMP_TO_EDGE,wrapT:y["a"].CLAMP_TO_EDGE,minificationFilter:S["a"].NEAREST,magnificationFilter:v["a"].NEAREST})})}}}O.prototype._isSupported=function(e){return!E.test(this._fragmentShader)||e.depthTexture},O.prototype.update=function(e,t){if(this.enabled===this._enabled||this.enabled||L(this),this._enabled=this.enabled,this._enabled&&(this._logDepthChanged=t!==this._useLogDepth,this._useLogDepth=t,this._selectedDirty=R(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=Object(u["a"])(this._selected)?this._selected.length:0,this._parentSelectedLength=Object(u["a"])(this._parentSelected)?this._parentSelected.length:0,M(this,e),C(this),N(this,e),A(this,e),P(this),this._selectedDirty=!1,this._ready)){var n=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=n,Object(u["a"])(n)){var i,r=n.getColorTexture(0);r.width===e.drawingBufferWidth&&r.height===e.drawingBufferHeight||(i=this._renderState,Object(u["a"])(i)&&r.width===i.viewport.width&&r.height===i.viewport.height||(this._renderState=p["a"].fromCache({viewport:new a["a"](0,0,r.width,r.height)}))),this._command.renderState=i}}},O.prototype.execute=function(e,t,n,a){if(Object(u["a"])(this._command)&&Object(u["a"])(this._command.framebuffer)&&this._ready&&this._enabled){this._colorTexture=t,this._depthTexture=n,this._idTexture=a,m["a"].equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);var i=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;Object(u["a"])(i)&&(i.context=e),this._command.execute(e,i)}},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){return L(this),Object(h["a"])(this)},t["a"]=O},"9e4a":function(e,t,n){"use strict";var a=n("1d87"),i=n("2f63"),r=n("9f1d"),o=n("7d62"),s=n("e42d"),u=n("6ef5"),c=n("6c84"),h=n("a913"),l=n("3022"),d=n("03f1"),_=n("23b6"),f=n("3720"),p=n("7229"),m=n("bd8d"),g=n("71ce"),b=n("c52f"),v=n("8c6d"),S=n("2b1f"),y=n("7ae0"),x=n("2d5d"),T=n("2bfd"),O=n("bdad"),E=n("8a4d"),w=n("6768"),D=n("3573"),I=n("7e2c"),C=n("a415"),A=n("1c39"),P=n("ae18"),j=n("f1e5"),B=n("aab0"),N=n("bc38"),L=n("c470"),R=n("6448"),M=n("b92e"),F=n("0967"),U=n("9249"),z=n("f724"),V=n("0d09"),k={};function H(e){var t=1,n=2,a=1,i="#define USE_STEP_SIZE\n"+P["a"],o=new U["a"]({name:e+"_x_direction",fragmentShader:i,uniforms:{delta:t,sigma:n,stepSize:a,direction:0},sampleMode:V["a"].LINEAR}),s=new U["a"]({name:e+"_y_direction",fragmentShader:i,uniforms:{delta:t,sigma:n,stepSize:a,direction:1},sampleMode:V["a"].LINEAR}),u={};return Object(r["a"])(u,{delta:{get:function(){return o.uniforms.delta},set:function(e){var t=o.uniforms,n=s.uniforms;t.delta=n.delta=e}},sigma:{get:function(){return o.uniforms.sigma},set:function(e){var t=o.uniforms,n=s.uniforms;t.sigma=n.sigma=e}},stepSize:{get:function(){return o.uniforms.stepSize},set:function(e){var t=o.uniforms,n=s.uniforms;t.stepSize=n.stepSize=e}}}),new z["a"]({name:e,stages:[o,s],uniforms:u})}function Y(e){if(!Object(i["a"])(e))return k.createEdgeDetectionStage();for(var t=new z["a"]({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),n={},a="",r="",o=0;o<e.length;++o)a+="uniform sampler2D edgeTexture"+o+"; \n",r+="        vec4 edge"+o+" = texture2D(edgeTexture"+o+", v_textureCoordinates); \n        if (edge"+o+".a > 0.0) \n        { \n            color = edge"+o+"; \n            break; \n        } \n",n["edgeTexture"+o]=e[o].name;var s=a+"varying vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n    for (int i = 0; i < "+e.length+"; i++) \n    { \n"+r+"    } \n    gl_FragColor = color; \n} \n",u=new U["a"]({name:"czm_edge_detection_combine",fragmentShader:s,uniforms:n});return new z["a"]({name:"czm_edge_detection_composite",stages:[t,u]})}k.createBlurStage=function(){return H("czm_blur")},k.createDepthOfFieldStage=function(){var e=H("czm_depth_of_field_blur"),t=new U["a"]({name:"czm_depth_of_field_composite",fragmentShader:w["a"],uniforms:{focalDistance:5,blurTexture:e.name}}),n={};return Object(r["a"])(n,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new z["a"]({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:n})},k.isDepthOfFieldSupported=function(e){return e.context.depthTexture},k.createEdgeDetectionStage=function(){var e=Object(g["a"])();return new U["a"]({name:"czm_edge_detection_"+e,fragmentShader:I["a"],uniforms:{length:.25,color:m["a"].clone(m["a"].BLACK)}})},k.isEdgeDetectionSupported=function(e){return e.context.depthTexture},k.createSilhouetteStage=function(e){var t=Y(e),n=new U["a"]({name:"czm_silhouette_color_edges",fragmentShader:R["a"],uniforms:{silhouetteTexture:t.name}});return new z["a"]({name:"czm_silhouette",stages:[t,n],inputPreviousStageTexture:!1,uniforms:t.uniforms})},k.isSilhouetteSupported=function(e){return e.context.depthTexture},k.createBloomStage=function(){var e=new U["a"]({name:"czm_bloom_contrast_bias",fragmentShader:E["a"],uniforms:{contrast:128,brightness:-.3}}),t=H("czm_bloom_blur"),n=new z["a"]({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),a=new U["a"]({name:"czm_bloom_generate_composite",fragmentShader:T["a"],uniforms:{glowOnly:!1,bloomTexture:n.name}}),i={};return Object(r["a"])(i,{glowOnly:{get:function(){return a.uniforms.glowOnly},set:function(e){a.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new z["a"]({name:"czm_bloom",stages:[n,a],inputPreviousStageTexture:!1,uniforms:i})},k.createAmbientOcclusionStage=function(){var e=new U["a"]({name:"czm_ambient_occlusion_generate",fragmentShader:S["a"],uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=H("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;var n=new z["a"]({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),a=new U["a"]({name:"czm_ambient_occlusion_composite",fragmentShader:y["a"],uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:n.name}}),i={};return Object(r["a"])(i,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(t){e.uniforms.frustumLength=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}},ambientOcclusionOnly:{get:function(){return a.uniforms.ambientOcclusionOnly},set:function(e){a.uniforms.ambientOcclusionOnly=e}}}),new z["a"]({name:"czm_ambient_occlusion",stages:[n,a],inputPreviousStageTexture:!1,uniforms:i})},k.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};var W="#define FXAA_QUALITY_PRESET 39 \n"+M["a"]+"\n"+A["a"];k.createFXAAStage=function(){return new U["a"]({name:"czm_FXAA",fragmentShader:W,sampleMode:V["a"].LINEAR})},k.createAcesTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return t+=v["a"],new U["a"]({name:"czm_aces",fragmentShader:t,uniforms:{autoExposure:void 0}})},k.createFilmicTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return t+=C["a"],new U["a"]({name:"czm_filmic",fragmentShader:t,uniforms:{autoExposure:void 0}})},k.createReinhardTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return t+=L["a"],new U["a"]({name:"czm_reinhard",fragmentShader:t,uniforms:{autoExposure:void 0}})},k.createModifiedReinhardTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return t+=B["a"],new U["a"]({name:"czm_modified_reinhard",fragmentShader:t,uniforms:{white:m["a"].WHITE,autoExposure:void 0}})},k.createAutoExposureStage=function(){return new F["a"]},k.createBlackAndWhiteStage=function(){return new U["a"]({name:"czm_black_and_white",fragmentShader:x["a"],uniforms:{gradations:5}})},k.createBrightnessStage=function(){return new U["a"]({name:"czm_brightness",fragmentShader:O["a"],uniforms:{brightness:.5}})},k.createNightVisionStage=function(){return new U["a"]({name:"czm_night_vision",fragmentShader:N["a"]})},k.createDepthViewStage=function(){return new U["a"]({name:"czm_depth_view",fragmentShader:D["a"]})},k.createLensFlareStage=function(){return new U["a"]({name:"czm_lens_flare",fragmentShader:j["a"],uniforms:{dirtTexture:Object(p["a"])("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:Object(p["a"])("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,dirtAmount:.4,earthRadius:b["a"].WGS84.maximumRadius}})};var X=k,G=n("18a0"),q=n("c3f4"),J=[];function K(){var e=X.createFXAAStage(),t=X.createAmbientOcclusionStage(),n=X.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=X.createAutoExposureStage(),this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=q["a"].ACES;var a=this._tonemapping;e.enabled=!1,t.enabled=!1,n.enabled=!1,a.enabled=!1;var r=new G["a"](this),o={},s=J;s.push(e,t,n,a);while(s.length>0){var u=s.pop();o[u.name]=u,u._textureCache=r;var c=u.length;if(Object(i["a"])(c))for(var h=0;h<c;++h)s.push(u.get(h))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;var l=this;t.uniforms.randomTexture=function(){return l._randomTexture},this._ao=t,this._bloom=n,this._fxaa=e,this._lastLength=void 0,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=o,this._textureCache=r}function Q(e){if(e._stagesRemoved){e._stagesRemoved=!1;for(var t=[],n=e._stages,a=n.length,i=0,r=0;i<a;++i){var o=n[i];o&&(o._index=r++,t.push(o))}e._stages=t}}function Z(e){while(Object(i["a"])(e.length))e=e.get(e.length-1);return e.outputTexture}function $(e,t,n,a,r){if(Object(i["a"])(e.execute))e.execute(t,n,a,r);else{var o,s=e.length;if(e.inputPreviousStageTexture)for($(e.get(0),t,n,a,r),o=1;o<s;++o)$(e.get(o),t,Z(e.get(o-1)),a,r);else for(o=0;o<s;++o)$(e.get(o),t,n,a,r)}}Object(r["a"])(K.prototype,{ready:{get:function(){for(var e=!1,t=this._stages,n=t.length,a=n-1;a>=0;--a){var i=t[a];e=e||i.ready&&i.enabled}var r=this._fxaa,o=this._ao,s=this._bloom,u=this._tonemapping;return e=e||r.ready&&r.enabled,e=e||o.ready&&o.enabled,e=e||s.ready&&s.enabled,e=e||u.ready&&u.enabled,e}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return Q(this),this._stages.length}},outputTexture:{get:function(){var e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);for(var t=this._stages,n=t.length,a=n-1;a>=0;--a){var r=t[a];if(Object(i["a"])(r)&&r.ready&&r.enabled)return this.getOutputTexture(r.name)}var o=this._tonemapping;if(o.enabled&&o.ready)return this.getOutputTexture(o.name);var s=this._bloom;if(s.enabled&&s.ready)return this.getOutputTexture(s.name);var u=this._ao;return u.enabled&&u.ready?this.getOutputTexture(u.name):void 0}},hasSelected:{get:function(){var e=Object(a["a"])(this._stages);while(e.length>0){var t=e.pop();if(Object(i["a"])(t)){if(Object(i["a"])(t.selected))return!0;var n=t.length;if(Object(i["a"])(n))for(var r=0;r<n;++r)e.push(t.get(r))}}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper!==e){Object(i["a"])(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());var t,n=this._autoExposureEnabled;switch(e){case q["a"].REINHARD:t=X.createReinhardTonemappingStage(n);break;case q["a"].MODIFIED_REINHARD:t=X.createModifiedReinhardTonemappingStage(n);break;case q["a"].FILMIC:t=X.createFilmicTonemappingStage(n);break;default:t=X.createAcesTonemappingStage(n);break}if(n){var a=this._autoExposure;t.uniforms.autoExposure=function(){return a.outputTexture}}this._tonemapper=e,this._tonemapping=t,Object(i["a"])(this._stageNames)&&(this._stageNames[t.name]=t,t._textureCache=this._textureCache),this._textureCacheDirty=!0}}}}),K.prototype.add=function(e){var t=this._stageNames,n=J;n.push(e);while(n.length>0){var a=n.pop();t[a.name]=a,a._textureCache=this._textureCache;var r=a.length;if(Object(i["a"])(r))for(var o=0;o<r;++o)n.push(a.get(o))}var s=this._stages;return e._index=s.length,s.push(e),this._textureCacheDirty=!0,e},K.prototype.remove=function(e){if(!this.contains(e))return!1;var t=this._stageNames,n=J;n.push(e);while(n.length>0){var a=n.pop();delete t[a.name];var r=a.length;if(Object(i["a"])(r))for(var o=0;o<r;++o)n.push(a.get(o))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},K.prototype.contains=function(e){return Object(i["a"])(e)&&Object(i["a"])(e._index)&&e._textureCache===this._textureCache},K.prototype.get=function(e){Q(this);var t=this._stages;return t[e]},K.prototype.removeAll=function(){for(var e=this._stages,t=e.length,n=0;n<t;++n)this.remove(e[n]);e.length=0},K.prototype.getStageByName=function(e){return this._stageNames[e]},K.prototype.update=function(e,t,n){Q(this);var a=this._activeStages,r=this._activeStages=this._previousActiveStages;this._previousActiveStages=a;var o,f,p=this._stages,m=r.length=p.length,g=0;for(o=0;o<m;++o)f=p[o],f.ready&&f.enabled&&f._isSupported(e)&&(r[g++]=f);r.length=g;var b=g!==a.length;if(!b)for(o=0;o<g;++o)if(r[o]!==a[o]){b=!0;break}var v=this._ao,S=this._bloom,y=this._autoExposure,x=this._tonemapping,T=this._fxaa;x.enabled=n;var O=v.enabled&&v._isSupported(e),E=S.enabled&&S._isSupported(e),w=x.enabled&&x._isSupported(e),D=T.enabled&&T._isSupported(e);if((b||this._textureCacheDirty||g!==this._lastLength||O!==this._aoEnabled||E!==this._bloomEnabled||w!==this._tonemappingEnabled||D!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._lastLength=g,this._aoEnabled=O,this._bloomEnabled=E,this._tonemappingEnabled=w,this._fxaaEnabled=D,this._textureCacheDirty=!1),Object(i["a"])(this._randomTexture)&&!O&&(this._randomTexture.destroy(),this._randomTexture=void 0),!Object(i["a"])(this._randomTexture)&&O){m=196608;var I=new Uint8Array(m);for(o=0;o<m;o+=3)I[o]=Math.floor(255*Math.random());this._randomTexture=new h["a"]({context:e,pixelFormat:s["a"].RGB,pixelDatatype:u["a"].UNSIGNED_BYTE,source:{arrayBufferView:I,width:256,height:256},sampler:new c["a"]({wrapS:_["a"].REPEAT,wrapT:_["a"].REPEAT,minificationFilter:d["a"].NEAREST,magnificationFilter:l["a"].NEAREST})})}for(this._textureCache.update(e),T.update(e,t),v.update(e,t),S.update(e,t),x.update(e,t),this._autoExposureEnabled&&y.update(e,t),m=p.length,o=0;o<m;++o)p[o].update(e,t)},K.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)},K.prototype.getOutputTexture=function(e){var t=this.getStageByName(e);if(Object(i["a"])(t))return Z(t)},K.prototype.execute=function(e,t,n,a){var i=this._activeStages,r=i.length,o=this._fxaa,s=this._ao,u=this._bloom,c=this._autoExposure,h=this._tonemapping,l=s.enabled&&s._isSupported(e),d=u.enabled&&u._isSupported(e),_=this._autoExposureEnabled,f=h.enabled&&h._isSupported(e),p=o.enabled&&o._isSupported(e);if(p||l||d||f||0!==r){var m=t;l&&s.ready&&($(s,e,m,n,a),m=Z(s)),d&&u.ready&&($(u,e,m,n,a),m=Z(u)),_&&c.ready&&$(c,e,m,n,a),f&&h.ready&&($(h,e,m,n,a),m=Z(h));var g=m;if(r>0){$(i[0],e,m,n,a);for(var b=1;b<r;++b)$(i[b],e,Z(i[b-1]),n,a);g=Z(i[r-1])}p&&o.ready&&$(o,e,g,n,a)}},K.prototype.copy=function(e,t){if(!Object(i["a"])(this._copyColorCommand)){var n=this;this._copyColorCommand=e.createViewportQuadCommand(f["a"],{uniformMap:{colorTexture:function(){return n.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},K.prototype.isDestroyed=function(){return!1},K.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),Object(o["a"])(this)};t["a"]=K},f724:function(e,t,n){"use strict";var a=n("71ce"),i=n("535a"),r=n("2f63"),o=n("9f1d"),s=n("7d62");function u(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT),this._stages=e.stages,this._inputPreviousStageTexture=Object(i["a"])(e.inputPreviousStageTexture,!0);var t=e.name;Object(r["a"])(t)||(t=Object(a["a"])()),this._name=t,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}function c(e){var t=Object(r["a"])(e._selected)?e._selected.length:0,n=Object(r["a"])(e._parentSelected)?e._parentSelected:0,a=e._selected!==e._selectedShadow||t!==e._selectedLength;if(a=a||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength,Object(r["a"])(e._selected)&&Object(r["a"])(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):Object(r["a"])(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!a&&Object(r["a"])(e._combinedSelected)){if(!Object(r["a"])(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var i=0;i<t;++i)if(e._combinedSelected[i]!==e._combinedSelectedShadow[i])return!0}return a}Object(o["a"])(u.prototype,{ready:{get:function(){for(var e=this._stages,t=e.length,n=0;n<t;++n)if(!e[n].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){for(var t=this._stages,n=t.length,a=0;a<n;++a)t[a].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),u.prototype._isSupported=function(e){for(var t=this._stages,n=t.length,a=0;a<n;++a)if(!t[a]._isSupported(e))return!1;return!0},u.prototype.get=function(e){return this._stages[e]},u.prototype.update=function(e,t){this._selectedDirty=c(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=Object(r["a"])(this._selected)?this._selected.length:0,this._parentSelectedLength=Object(r["a"])(this._parentSelected)?this._parentSelected.length:0;for(var n=this._stages,a=n.length,i=0;i<a;++i){var o=n[i];this._selectedDirty&&(o.parentSelected=this._combinedSelected),o.update(e,t)}},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){for(var e=this._stages,t=e.length,n=0;n<t;++n)e[n].destroy();return Object(s["a"])(this)},t["a"]=u}}]);