(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~a8fa52f0"],{ce35:function(e,t,a){"use strict";var r=a("cef5"),i=a("670c"),n=a("be18"),o=a("a561"),s=a("bef8"),c=a("dc1c"),u=a("bd8d"),l=a("2bb9"),d=a("71ce"),h=a("8dfe"),m=a("535a"),f=a("2f63"),p=a("9f1d"),_=a("7d62"),g=a("aee6"),v=a("5e57"),b=a("a734"),x=a("974b"),O=a("129b"),y=a("0123"),S=a("0711"),j=a("d69d"),R=a("c67a"),C=a("93da"),M=a("df07"),w=a("52f0"),E=a("e42d"),A=a("1b8d"),T=a("0260"),P=a("d4ed"),L=a("f806"),I=a("daa2"),B=a("f20a"),N=a("8b68"),D=a("a894"),U=a("d289"),F=a("6dc0"),V=a("6c84"),k=a("e90c"),z=a("5770"),q=a("a913"),H=a("03f1"),G=a("23b6"),W=a("7c5e"),K=a("73b5"),Z=a("11d0"),J=a("77d1"),Y=a("6d11"),X=a("38d6"),Q=a("adba"),$=a("5c15"),ee=a("860a"),te=a("a58e"),ae=a("b08e"),re=a("b7c8"),ie=a("43ee"),ne=a("c1f7"),oe=a("08b8"),se=a("d663"),ce=a("0249"),ue=a("2d75"),le=a("568a"),de=a("fbf1"),he=a("442b"),me=a("6289"),fe=a("1195"),pe=a("e1d8"),_e=a("e8d6"),ge=a("e349"),ve=a("1b40"),be=a("082a"),xe=a("d007"),Oe=a("a307"),ye=a("c86b"),Se=new n["a"],je=ge["a"].ModelState,Re="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01",Ce=C["a"].EPSILON16;function Me(e,t){e._cachedGltf=t}function we(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}Object(p["a"])(we.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}}),we.prototype.makeReady=function(e){this.gltf=e;for(var t=this.modelsToLoad,a=t.length,r=0;r<a;++r){var i=t[r];i.isDestroyed()||Me(i,this)}this.modelsToLoad=void 0,this.ready=!0};var Ee={},Ae={};function Te(e){e=Object(m["a"])(e,m["a"].EMPTY_OBJECT);var t,a=e.cacheKey;if(this._cacheKey=a,this._cachedGltf=void 0,this._releaseGltfJson=Object(m["a"])(e.releaseGltfJson,!1),Object(f["a"])(a)&&Object(f["a"])(Ee[a])&&Ee[a].ready)t=Ee[a],++t.count;else{var o=e.gltf;if(Object(f["a"])(o)){if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),o instanceof Uint8Array){var s=Object($["a"])(o);t=new we({gltf:s,ready:!0})}else t=new we({gltf:e.gltf,ready:!0});t.count=1,Object(f["a"])(a)&&(Ee[a]=t)}}Me(this,t);var c=Object(m["a"])(e.basePath,"");this._resource=P["a"].createIfNeeded(c);var l=e.credit;"string"===typeof l&&(l=new h["a"](l)),this._credit=l,this._resourceCredits=[],this.show=Object(m["a"])(e.show,!0),this.silhouetteColor=Object(m["a"])(e.silhouetteColor,u["a"].RED),this._silhouetteColor=new u["a"],this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=Object(m["a"])(e.silhouetteSize,0),this.modelMatrix=w["a"].clone(Object(m["a"])(e.modelMatrix,w["a"].IDENTITY)),this._modelMatrix=w["a"].clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=Object(m["a"])(e.scale,1),this._scale=this.scale,this.minimumPixelSize=Object(m["a"])(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=Object(m["a"])(e.heightReference,ue["a"].NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;var d=e.scene;this._scene=d,Object(f["a"])(d)&&Object(f["a"])(d.terrainProviderChanged)&&(this._terrainProviderChangedCallback=d.terrainProviderChanged.addEventListener((function(){this._heightChanged=!0}),this)),this._pickObject=e.pickObject,this._allowPicking=Object(m["a"])(e.allowPicking,!0),this._ready=!1,this._readyPromise=te["a"].defer(),this.activeAnimations=new he["a"](this),this.clampAnimations=Object(m["a"])(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=Object(m["a"])(e.incrementallyLoadTextures,!0),this._asynchronous=Object(m["a"])(e.asynchronous,!0),this.shadows=Object(m["a"])(e.shadows,ye["a"].ENABLED),this._shadows=this.shadows,this.color=u["a"].clone(Object(m["a"])(e.color,u["a"].WHITE)),this._colorPreviousAlpha=1,this.colorBlendMode=Object(m["a"])(e.colorBlendMode,ne["a"].HIGHLIGHT),this.colorBlendAmount=Object(m["a"])(e.colorBlendAmount,.5),this._colorShadingEnabled=!1,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._clippingPlanesState=0,this.clippingPlanesOriginMatrix=void 0,this.debugShowBoundingVolume=Object(m["a"])(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(m["a"])(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(m["a"])(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=Object(m["a"])(e.upAxis,ae["a"].Y),this._gltfForwardAxis=ae["a"].Z,this._forwardAxis=e.forwardAxis,this.cull=Object(m["a"])(e.cull,!0),this.opaquePass=Object(m["a"])(e.opaquePass,U["a"].OPAQUE),this._computedModelMatrix=new w["a"],this._clippingPlaneModelViewMatrix=w["a"].clone(w["a"].IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new r["a"],this._state=je.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,articulationsByName:void 0,articulationsByStageKey:void 0,stagesByKey:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},sourceShaders:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,this._dequantizeInShader=Object(m["a"])(e.dequantizeInShader,!0),this._decodedData={},this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._sourceTechniques={},this._sourcePrograms={},this._quantizedVertexShaders={},this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._sourceVersion=void 0,this._sourceKHRTechniquesWebGL=void 0,this._imageBasedLightingFactor=new i["a"](1,1),i["a"].clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this._lightColor=n["a"].clone(e.lightColor),this._luminanceAtZenith=void 0,this.luminanceAtZenith=Object(m["a"])(e.luminanceAtZenith,.2),this._sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._shouldUpdateSpecularMapAtlas=!0,this._specularEnvironmentMapAtlas=void 0,this._useDefaultSphericalHarmonics=!1,this._useDefaultSpecularMaps=!1,this._shouldRegenerateShaders=!1}function Pe(e){return e.stencilBuffer}function Le(e){return!u["a"].equals(e.color,u["a"].WHITE)||e.colorBlendMode!==ne["a"].HIGHLIGHT}function Ie(e){var t=e._clippingPlanes;return Object(f["a"])(t)&&t.enabled&&0!==t.length}function Be(e){var t=Object(x["a"])(e);return"glTF"===t}function Ne(e,t,a){return e._runtime[t][a]}Object(p["a"])(Te.prototype,{gltf:{get:function(){return Object(f["a"])(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._resource.url}},boundingSphere:{get:function(){var e=this.modelMatrix;this.heightReference!==ue["a"].NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);var t=w["a"].getScale(e,Se),a=Object(f["a"])(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;n["a"].multiplyByScalar(t,a,t);var r=this._scaledBoundingSphere;return r.center=n["a"].multiplyComponents(this._boundingSphere.center,t,r.center),r.radius=n["a"].maximumComponent(t)*this._initialRadius,Object(f["a"])(this._rtcCenter)&&n["a"].add(this._rtcCenter,r.center,r.center),r}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return Object(f["a"])(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=g["a"].clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return Object(f["a"])(this._extensionsUsed)||(this._extensionsUsed=ge["a"].getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(f["a"])(this._extensionsRequired)||(this._extensionsRequired=ge["a"].getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},forwardAxis:{get:function(){return Object(f["a"])(this._forwardAxis)?this._forwardAxis:this._gltfForwardAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&ie["a"].setOwner(e,this,"_clippingPlanes")}},pickIds:{get:function(){return this._pickIds}},imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){var t=this._imageBasedLightingFactor;e===t||i["a"].equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLightingFactor.x>0&&0===e.x||0===this._imageBasedLightingFactor.x&&e.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLightingFactor.y>0&&0===e.y||0===this._imageBasedLightingFactor.y&&e.y>0,i["a"].clone(e,this._imageBasedLightingFactor))}},lightColor:{get:function(){return this._lightColor},set:function(e){var t=this._lightColor;e===t||n["a"].equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(f["a"])(t)&&!Object(f["a"])(e)||Object(f["a"])(e)&&!Object(f["a"])(t),this._lightColor=n["a"].clone(e,t))}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(e){var t=this._luminanceAtZenith;e!==t&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(f["a"])(t)&&!Object(f["a"])(e)||Object(f["a"])(e)&&!Object(f["a"])(t),this._luminanceAtZenith=e)}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){e!==this._sphericalHarmonicCoefficients&&(this._sphericalHarmonicCoefficients=e,this._shouldRegenerateShaders=!0)}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){this._shouldUpdateSpecularMapAtlas=this._shouldUpdateSpecularMapAtlas||e!==this._specularEnvironmentMaps,this._specularEnvironmentMaps=e}},credit:{get:function(){return this._credit}}}),Te.silhouetteSupported=function(e){return Pe(e.context)},Te.fromGltf=function(e){var t=e.url;e=Object(c["a"])(e);var a=P["a"].createIfNeeded(t),r=Object(m["a"])(e.basePath,a.clone()),i=P["a"].createIfNeeded(r),n=Object(m["a"])(e.cacheKey,Ae[Object(b["a"])(a.url)]);Object(f["a"])(n)||(n=Object(d["a"])(),Ae[Object(b["a"])(a.url)]=n),Object(f["a"])(e.basePath)&&!Object(f["a"])(e.cacheKey)&&(n+=i.url),e.cacheKey=n,e.basePath=i;var o=new Te(e),s=Ee[n];return Object(f["a"])(s)?s.ready||(++s.count,s.modelsToLoad.push(o)):(s=new we({ready:!1}),s.count=1,s.modelsToLoad.push(o),Me(o,s),Ee[n]=s,Object(f["a"])(a.headers.Accept)||(a.headers.Accept=Re),a.fetchArrayBuffer().then((function(e){var t=new Uint8Array(e);if(Be(t)){var r=Object($["a"])(t);s.makeReady(r)}else{var i=Object(O["a"])(t);s.makeReady(JSON.parse(i))}var n=o._resourceCredits,c=a.credits;if(Object(f["a"])(c))for(var u=c.length,l=0;l<u;l++)n.push(c[l])})).otherwise(ge["a"].getFailedLoadFunction(o,"model",a.url))),o},Te._gltfCache=Ee,Te.prototype.getNode=function(e){var t=Ne(this,"nodesByName",e);return Object(f["a"])(t)?t.publicNode:void 0},Te.prototype.getMesh=function(e){return Ne(this,"meshesByName",e)},Te.prototype.getMaterial=function(e){return Ne(this,"materialsByName",e)},Te.prototype.setArticulationStage=function(e,t){var a=Ne(this,"stagesByKey",e),r=Ne(this,"articulationsByStageKey",e);Object(f["a"])(a)&&Object(f["a"])(r)&&(t=C["a"].clamp(t,a.minimumValue,a.maximumValue),C["a"].equalsEpsilon(a.currentValue,t,Ce)||(a.currentValue=t,r.isDirty=!0))};var De=new n["a"],Ue=new M["a"];function Fe(e,t){var a,r=e.currentValue,i=De;switch(e.type){case"xRotate":a=M["a"].fromRotationX(C["a"].toRadians(r),Ue),w["a"].multiplyByMatrix3(t,a,t);break;case"yRotate":a=M["a"].fromRotationY(C["a"].toRadians(r),Ue),w["a"].multiplyByMatrix3(t,a,t);break;case"zRotate":a=M["a"].fromRotationZ(C["a"].toRadians(r),Ue),w["a"].multiplyByMatrix3(t,a,t);break;case"xTranslate":i.x=r,i.y=0,i.z=0,w["a"].multiplyByTranslation(t,i,t);break;case"yTranslate":i.x=0,i.y=r,i.z=0,w["a"].multiplyByTranslation(t,i,t);break;case"zTranslate":i.x=0,i.y=0,i.z=r,w["a"].multiplyByTranslation(t,i,t);break;case"xScale":i.x=r,i.y=1,i.z=1,w["a"].multiplyByScale(t,i,t);break;case"yScale":i.x=1,i.y=r,i.z=1,w["a"].multiplyByScale(t,i,t);break;case"zScale":i.x=1,i.y=1,i.z=r,w["a"].multiplyByScale(t,i,t);break;case"uniformScale":w["a"].multiplyByUniformScale(t,r,t);break;default:break}return t}var Ve=new w["a"];function ke(e){var t=e.gltf,a=e._loadResources;J["a"].buffer(t,(function(e,t){a.buffers[t]=e.extras._pipeline.source}))}function ze(e,t){return function(a){var r=e._loadResources,i=new Uint8Array(a);--r.pendingBufferLoads,e.gltf.buffers[t].extras._pipeline.source=i}}function qe(e){var t=e.gltf.bufferViews,a=e._loadResources.vertexBuffersToCreate;J["a"].bufferView(e.gltf,(function(e,t){e.target===I["a"].ARRAY_BUFFER&&a.enqueue(t)}));var r=e._loadResources.indexBuffersToCreate,i={};J["a"].accessor(e.gltf,(function(e){var a=e.bufferView;if(Object(f["a"])(a)){var n=t[a];n.target!==I["a"].ELEMENT_ARRAY_BUFFER||Object(f["a"])(i[a])||(i[a]=!0,r.enqueue({id:a,componentType:e.componentType}))}}))}function He(e){var t=e.gltf;if(Object(X["a"])(t,"KHR_techniques_webgl")){var a=e._sourcePrograms,r=e._sourceTechniques,i=t.extensions.KHR_techniques_webgl.programs;J["a"].technique(t,(function(e,t){r[t]=Object(c["a"])(e);var n=e.program;Object(f["a"])(a[n])||(a[n]=Object(c["a"])(i[n]))}))}}function Ge(e,t,a){return function(r){var i=e._loadResources;i.shaders[a]={source:r,type:t,bufferView:void 0},--i.pendingShaderLoads,e._rendererResources.sourceShaders[a]=r}}function We(e){var t=e.gltf,a=t.buffers,r=t.bufferViews,i=e._rendererResources.sourceShaders;J["a"].shader(t,(function(t,n){if(Object(f["a"])(t.bufferView)){var o=t.bufferView,s=r[o],c=s.buffer,u=a[c],l=Object(O["a"])(u.extras._pipeline.source,s.byteOffset,s.byteLength);i[n]=l}else if(Object(f["a"])(t.extras._pipeline.source))i[n]=t.extras._pipeline.source;else{++e._loadResources.pendingShaderLoads;var d=e._resource.getDerivedResource({url:t.uri});d.fetchText().then(Ge(e,t.type,n)).otherwise(ge["a"].getFailedLoadFunction(e,"shader",d.url))}}))}function Ke(e){var t=e._sourceTechniques;for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];e._loadResources.programsToCreate.enqueue({programId:r.program,techniqueId:a})}}function Ze(e){var t={},a={},r={};e._runtime.articulationsByName=t,e._runtime.articulationsByStageKey=a,e._runtime.stagesByKey=r;var i=e.gltf;if(Object(X["a"])(i,"AGI_articulations")&&Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.AGI_articulations)){var n=i.extensions.AGI_articulations.articulations;if(Object(f["a"])(n))for(var o=n.length,s=0;s<o;++s){var u=Object(c["a"])(n[s]);u.nodes=[],u.isDirty=!0,t[u.name]=u;for(var l=u.stages.length,d=0;d<l;++d){var h=u.stages[d];h.currentValue=h.initialValue;var m=u.name+" "+h.name;a[m]=u,r[m]=h}}}}function Je(e,t){return function(a){var r=e._loadResources;--r.pendingTextureLoads,r.texturesToCreate.enqueue({id:t,image:a,bufferView:a.bufferView,width:a.width,height:a.height,internalFormat:a.internalFormat})}}Te.prototype.applyArticulations=function(){var e=this._runtime.articulationsByName;for(var t in e)if(e.hasOwnProperty(t)){var a=e[t];if(a.isDirty){a.isDirty=!1;for(var r=a.nodes.length,i=0;i<r;++i){for(var n=a.nodes[i],o=w["a"].clone(n.originalMatrix,Ve),s=a.stages.length,c=0;c<s;++c){var u=a.stages[c];o=Fe(u,o)}n.matrix=o}}}};var Ye=/(^data:image\/ktx)|(\.ktx$)/i,Xe=/(^data:image\/crn)|(\.crn$)/i;function Qe(e,t,a){var r,i=e.gltf,n=i.images;J["a"].texture(i,(function(i,o){var s=i.source;Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.EXT_texture_webp)&&a&&(s=i.extensions.EXT_texture_webp.source);var c=n[s],u=c.extras,l=c.bufferView,d=c.mimeType;if(r=c.uri,Object(f["a"])(u)&&Object(f["a"])(u.compressedImage3DTiles)){var h=u.compressedImage3DTiles.crunch,m=u.compressedImage3DTiles.s3tc,p=u.compressedImage3DTiles.pvrtc1,_=u.compressedImage3DTiles.etc1;t.s3tc&&Object(f["a"])(h)?(d=h.mimeType,Object(f["a"])(h.bufferView)?l=h.bufferView:r=h.uri):t.s3tc&&Object(f["a"])(m)?(d=m.mimeType,Object(f["a"])(m.bufferView)?l=m.bufferView:r=m.uri):t.pvrtc&&Object(f["a"])(p)?(d=p.mimeType,Object(f["a"])(p.bufferView)?l=p.bufferView:r=p.uri):t.etc1&&Object(f["a"])(_)&&(d=_.mimeType,Object(f["a"])(_.bufferView)?l=_.bufferView:r=_.uri)}if(Object(f["a"])(l))e._loadResources.texturesToCreateFromBufferView.enqueue({id:o,image:void 0,bufferView:l,mimeType:d});else{++e._loadResources.pendingTextureLoads;var g,v=e._resource.getDerivedResource({url:r});g=Ye.test(r)?Object(R["a"])(v):Xe.test(r)?Object(S["a"])(v):v.fetchImage(),g.then(Je(e,o,s)).otherwise(ge["a"].getFailedLoadFunction(e,"image",v.url))}}))}var $e=new w["a"];function et(e){var t={},a={},r=[],i=e._loadResources.skinnedNodesIds,n=e._runtime.articulationsByName;J["a"].node(e.gltf,(function(o,s){var c={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new w["a"],computedMatrix:new w["a"],dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:o.jointName,weights:[],children:[],parents:[],publicNode:void 0};if(c.publicNode=new _e["a"](e,o,c,s,ge["a"].getTransform(o)),t[s]=c,a[o.name]=c,Object(f["a"])(o.skin)&&(i.push(s),r.push(c)),Object(f["a"])(o.extensions)&&Object(f["a"])(o.extensions.AGI_articulations)){var u=o.extensions.AGI_articulations.articulationName;if(Object(f["a"])(u)){var l=w["a"].clone(c.publicNode.originalMatrix,$e),d=n[u];d.nodes.push(c.publicNode);for(var h=d.stages.length,m=0;m<h;++m){var p=d.stages[m];l=Fe(p,l)}c.publicNode.matrix=l}}})),e._runtime.nodes=t,e._runtime.nodesByName=a,e._runtime.skinnedNodes=r}function tt(e){var t=e.gltf,a=e._sourceTechniques,r={},i={},n=e._uniformMaps;J["a"].material(t,(function(t,o){n[o]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};var s=new fe["a"](e,t,o);if(Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_techniques_webgl)){var u=t.extensions.KHR_techniques_webgl.technique;s._technique=u,s._program=a[u].program,J["a"].materialValue(t,(function(e,t){Object(f["a"])(s._values)||(s._values={}),s._values[t]=Object(c["a"])(e)}))}r[t.name]=s,i[o]=s})),e._runtime.materialsByName=r,e._runtime.materialsById=i}function at(e){var t={},a=e._runtime.materialsById;J["a"].mesh(e.gltf,(function(r,i){t[r.name]=new pe["a"](r,a,i),(Object(f["a"])(e.extensionsUsed.WEB3D_quantized_attributes)||e._dequantizeInShader)&&J["a"].meshPrimitive(r,(function(t,a){var r=lt(e,t),n=e._programPrimitives[r];Object(f["a"])(n)||(n={},e._programPrimitives[r]=n),n[i+".primitive."+a]=t}))})),e._runtime.meshesByName=t}var rt=function(){this.id=void 0,this.model=void 0,this.context=void 0};function it(e,t,a){var r=t._loadResources,i=t.gltf.bufferViews,n=i[e];Object(f["a"])(n)||(n=r.createdBufferViews[e]);var o=B["a"].createVertexBuffer({context:a,typedArray:r.getBuffer(n),usage:N["a"].STATIC_DRAW});o.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=o,t._geometryByteLength+=o.sizeInBytes}rt.prototype.set=function(e,t,a){this.id=e,this.model=t,this.context=a},rt.prototype.execute=function(){it(this.id,this.model,this.context)};var nt=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};function ot(e,t,a,r){var i=a._loadResources,n=a.gltf.bufferViews,o=n[e];Object(f["a"])(o)||(o=i.createdBufferViews[e]);var s=B["a"].createIndexBuffer({context:r,typedArray:i.getBuffer(o),usage:N["a"].STATIC_DRAW,indexDatatype:t});s.vertexArrayDestroyable=!1,a._rendererResources.buffers[e]=s,a._geometryByteLength+=s.sizeInBytes}nt.prototype.set=function(e,t,a,r){this.id=e,this.componentType=t,this.model=a,this.context=r},nt.prototype.execute=function(){ot(this.id,this.componentType,this.model,this.context)};var st=new rt,ct=new nt;function ut(e,t){var a=e._loadResources;if(0===a.pendingBufferLoads){var r,i=t.context,n=a.vertexBuffersToCreate,o=a.indexBuffersToCreate;if(e.asynchronous){while(n.length>0){if(st.set(n.peek(),e,i),!t.jobScheduler.execute(st,le["a"].BUFFER))break;n.dequeue()}while(o.length>0){if(r=o.peek(),ct.set(r.id,r.componentType,e,i),!t.jobScheduler.execute(ct,le["a"].BUFFER))break;o.dequeue()}}else{while(n.length>0)it(n.dequeue(),e,i);while(o.length>0)r=o.dequeue(),ot(r.id,r.componentType,e,i)}}}function lt(e,t){var a=e._runtime.materialsById[t.material];if(Object(f["a"])(a))return a._program}function dt(e,t,a){var r,i,n,o=a._programPrimitives[t];if(!Object(f["a"])(o))return e;for(i in o)if(o.hasOwnProperty(i)&&(r=o[i],lt(a,r)===t))break;if(a._programPrimitives[t]=void 0,a.extensionsUsed.WEB3D_quantized_attributes)n=ge["a"].modifyShaderForQuantizedAttributes(a.gltf,r,e),a._quantizedUniforms[t]=n.uniforms;else{var s=a._decodedData[i];if(!Object(f["a"])(s))return e;n=ge["a"].modifyShaderForDracoQuantizedAttributes(a.gltf,r,e,s.attributes)}return n.shader}function ht(e){return e=z["a"].replaceMain(e,"gltf_blend_main"),e+="uniform vec4 gltf_color; \nuniform float gltf_colorBlend; \nvoid main() \n{ \n    gltf_blend_main(); \n    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n    float highlight = ceil(gltf_colorBlend); \n    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n    gl_FragColor.a *= gltf_color.a; \n} \n",e}function mt(e,t,a){return Object(f["a"])(a)&&(e=a(e,t)),e}var ft=function(){this.programToCreate=void 0,this.model=void 0,this.context=void 0};function pt(e,t,a){var r=e.programId,i=e.techniqueId,n=t._sourcePrograms[r],o=t._rendererResources.sourceShaders,s=o[n.vertexShader],c=o[n.fragmentShader],u=t._quantizedVertexShaders,l=t._toClipCoordinatesGLSL[r];if(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader){var d=u[r];Object(f["a"])(d)||(d=dt(s,r,t),u[r]=d),s=d}var h=mt(s,r,t._vertexShaderLoaded),m=mt(c,r,t._fragmentShaderLoaded);v["a"].isInternetExplorer()||(h=ge["a"].modifyVertexShaderForLogDepth(h,l),m=ge["a"].modifyFragmentShaderForLogDepth(m)),Object(f["a"])(t._uniformMapLoaded)||(m="uniform vec4 czm_pickColor;\n"+m);var p=t._imageBasedLightingFactor.x>0||t._imageBasedLightingFactor.y>0;if(p&&(m="#define USE_IBL_LIGHTING \n\n"+m),Object(f["a"])(t._lightColor)&&(m="#define USE_CUSTOM_LIGHT_COLOR \n\n"+m),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(m=z["a"].replaceMain(m,"non_gamma_corrected_main"),m+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),ve["a"].isSupported(a)){var _=Object(f["a"])(t._sphericalHarmonicCoefficients)||t._useDefaultSphericalHarmonics,g=Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready||t._useDefaultSpecularMaps,b=_||g||p;b&&(m="uniform mat4 gltf_clippingPlanesMatrix; \n"+m),Object(f["a"])(t._sphericalHarmonicCoefficients)?m="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+m:t._useDefaultSphericalHarmonics&&(m="#define DIFFUSE_IBL \n"+m),Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready?m="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+m:t._useDefaultSpecularMaps&&(m="#define SPECULAR_IBL \n"+m)}Object(f["a"])(t._luminanceAtZenith)&&(m="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+m),gt(r,i,m,h,t,a)}function _t(e,t,a){var r=e.programId,i=e.techniqueId,n=t._sourcePrograms[r],o=t._rendererResources.sourceShaders,s=t._quantizedVertexShaders,c=t._toClipCoordinatesGLSL[r],u=t.clippingPlanes,l=Ie(t),d=o[n.vertexShader],h=o[n.fragmentShader];(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader)&&(d=s[r]);var m=h;Le(t)&&(m=Te._modifyShaderForColor(m)),l&&(m=Na(m,u,a));var p=mt(d,r,t._vertexShaderLoaded),_=mt(m,r,t._fragmentShaderLoaded);v["a"].isInternetExplorer()||(p=ge["a"].modifyVertexShaderForLogDepth(p,c),_=ge["a"].modifyFragmentShaderForLogDepth(_)),Object(f["a"])(t._uniformMapLoaded)||(_="uniform vec4 czm_pickColor;\n"+_);var g=t._imageBasedLightingFactor.x>0||t._imageBasedLightingFactor.y>0;if(g&&(_="#define USE_IBL_LIGHTING \n\n"+_),Object(f["a"])(t._lightColor)&&(_="#define USE_CUSTOM_LIGHT_COLOR \n\n"+_),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(_=z["a"].replaceMain(_,"non_gamma_corrected_main"),_+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),ve["a"].isSupported(a)){var b=Object(f["a"])(t._sphericalHarmonicCoefficients)||t._useDefaultSphericalHarmonics,x=Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready||t._useDefaultSpecularMaps,O=!l&&(b||x||g);O&&(_="uniform mat4 gltf_clippingPlanesMatrix; \n"+_),Object(f["a"])(t._sphericalHarmonicCoefficients)?_="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+_:t._useDefaultSphericalHarmonics&&(_="#define DIFFUSE_IBL \n"+_),Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready?_="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+_:t._useDefaultSpecularMaps&&(_="#define SPECULAR_IBL \n"+_)}Object(f["a"])(t._luminanceAtZenith)&&(_="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+_),gt(r,i,_,p,t,a)}function gt(e,t,a,r,i,n){var o=i._sourceTechniques[t],s=ge["a"].createAttributeLocations(o,i._precreatedAttributes);i._rendererResources.programs[e]=k["a"].fromCache({context:n,vertexShaderSource:r,fragmentShaderSource:a,attributeLocations:s})}ft.prototype.set=function(e,t,a){this.programToCreate=e,this.model=t,this.context=a},ft.prototype.execute=function(){pt(this.programToCreate,this.model,this.context)};var vt=new ft;function bt(e,t){var a=e._loadResources,r=a.programsToCreate;if(0===a.pendingShaderLoads&&0===a.pendingBufferLoads){var i=t.context;if(e.asynchronous)while(r.length>0){if(vt.set(r.peek(),e,i),!t.jobScheduler.execute(vt,le["a"].PROGRAM))break;r.dequeue()}else while(r.length>0)pt(r.dequeue(),e,i)}}function xt(e,t){return function(a){e.texturesToCreate.enqueue({id:t.id,image:a,bufferView:void 0}),--e.pendingBufferViewToImage}}function Ot(e){var t=e._loadResources;if(0===t.pendingBufferLoads)while(t.texturesToCreateFromBufferView.length>0){var a=t.texturesToCreateFromBufferView.dequeue(),r=e.gltf,i=r.bufferViews[a.bufferView],n=r.textures[a.id].source,o=ge["a"].getFailedLoadFunction(e,"image","id: "+a.id+", bufferView: "+a.bufferView);if("image/ktx"===a.mimeType)Object(R["a"])(t.getBuffer(i)).then(Je(e,a.id,n)).otherwise(o),++e._loadResources.pendingTextureLoads;else if("image/crn"===a.mimeType)Object(S["a"])(t.getBuffer(i)).then(Je(e,a.id,n)).otherwise(o),++e._loadResources.pendingTextureLoads;else{var s=xt(t,a);Object(j["a"])({uint8Array:t.getBuffer(i),format:a.mimeType,flipY:!1}).then(s).otherwise(o),++t.pendingBufferViewToImage}}}function yt(e){var t=e._loadResources;if(t.createSamplers){t.createSamplers=!1;var a=e._rendererResources.samplers;J["a"].sampler(e.gltf,(function(e,t){a[t]=new V["a"]({wrapS:e.wrapS,wrapT:e.wrapT,minificationFilter:e.minFilter,magnificationFilter:e.magFilter})}))}}var St=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};function jt(e,t,a){var r=t.gltf.textures,i=r[e.id],n=t._rendererResources.samplers,o=n[i.sampler];Object(f["a"])(o)||(o=new V["a"]({wrapS:G["a"].REPEAT,wrapT:G["a"].REPEAT}));for(var s=!1,c=t.gltf.materials,u=c.length,l=0;l<u;++l){var d=c[l];if(Object(f["a"])(d.extensions)&&Object(f["a"])(d.extensions.KHR_techniques_webgl)){var h=d.extensions.KHR_techniques_webgl.values;for(var m in h)if(h.hasOwnProperty(m)&&-1!==m.indexOf("Texture")){var p=h[m];if(p.index===e.id&&Object(f["a"])(p.extensions)&&Object(f["a"])(p.extensions.KHR_texture_transform)){s=!0;break}}}if(s)break}var _=o.wrapS,g=o.wrapT,v=o.minificationFilter;s&&v!==H["a"].LINEAR&&v!==H["a"].NEAREST&&(v=v===H["a"].NEAREST_MIPMAP_NEAREST||v===H["a"].NEAREST_MIPMAP_LINEAR?H["a"].NEAREST:H["a"].LINEAR,o=new V["a"]({wrapS:o.wrapS,wrapT:o.wrapT,textureMinificationFilter:v,textureMagnificationFilter:o.magnificationFilter}));var b,x=e.internalFormat,O=!(Object(f["a"])(x)&&E["a"].isCompressedFormat(x))&&(v===H["a"].NEAREST_MIPMAP_NEAREST||v===H["a"].NEAREST_MIPMAP_LINEAR||v===H["a"].LINEAR_MIPMAP_NEAREST||v===H["a"].LINEAR_MIPMAP_LINEAR),y=O||_===G["a"].REPEAT||_===G["a"].MIRRORED_REPEAT||g===G["a"].REPEAT||g===G["a"].MIRRORED_REPEAT,S=e.image;if(Object(f["a"])(x))b=new q["a"]({context:a,source:{arrayBufferView:e.bufferView},width:e.width,height:e.height,pixelFormat:x,sampler:o});else if(Object(f["a"])(S)){var j=!C["a"].isPowerOfTwo(S.width)||!C["a"].isPowerOfTwo(S.height);if(y&&j){var R=document.createElement("canvas");R.width=C["a"].nextPowerOfTwo(S.width),R.height=C["a"].nextPowerOfTwo(S.height);var M=R.getContext("2d");M.drawImage(S,0,0,S.width,S.height,0,0,R.width,R.height),S=R}b=new q["a"]({context:a,source:S,pixelFormat:i.internalFormat,pixelDatatype:i.type,sampler:o,flipY:!1}),O&&b.generateMipmap()}Object(f["a"])(b)&&(t._rendererResources.textures[e.id]=b,t._texturesByteLength+=b.sizeInBytes)}St.prototype.set=function(e,t,a){this.gltfTexture=e,this.model=t,this.context=a},St.prototype.execute=function(){jt(this.gltfTexture,this.model,this.context)};var Rt=new St;function Ct(e,t){var a=t.context,r=e._loadResources.texturesToCreate;if(e.asynchronous)while(r.length>0){if(Rt.set(r.peek(),e,a),!t.jobScheduler.execute(Rt,le["a"].TEXTURE))break;r.dequeue()}else while(r.length>0)jt(r.dequeue(),e,a)}function Mt(e,t){var a,r,i=e._sourceTechniques,n={},o=e._runtime.materialsById[t.material];if(!Object(f["a"])(o))return n;var s=i[o._technique];if(!Object(f["a"])(s))return n;var c=s.attributes,u=e._rendererResources.programs[s.program],l=u.vertexAttributes,d=u._attributeLocations;for(a in l)if(l.hasOwnProperty(a)){var h=c[a];Object(f["a"])(h)&&(r=d[a],n[h.semantic]=r)}var m=e._precreatedAttributes;if(Object(f["a"])(m))for(a in m)m.hasOwnProperty(a)&&(r=d[a],n[a]=r);return n}function wt(e,t){for(var a=e.length,r={},i=0;i<a;++i){var n=[e[i]];while(n.length>0){var o=n.pop(),s=t[o];Object(f["a"])(s)&&(r[o]=o);var c=s.children;if(Object(f["a"])(c))for(var u=c.length,l=0;l<u;++l)n.push(c[l])}}return r}function Et(e,t){for(var a=e.gltf,r=a.skins,i=a.nodes,n=e._runtime.nodes,o=e._loadResources.skinnedNodesIds,s=o.length,c=0;c<s;++c){var u=o[c],l=n[u],d=i[u],h=t[d.skin];l.inverseBindMatrices=h.inverseBindMatrices,l.bindShapeMatrix=h.bindShapeMatrix;var m=[],p=r[d.skin];Object(f["a"])(p.skeleton)&&m.push(p.skeleton);for(var _=wt(m,i),g=r[d.skin].joints,v=g.length,b=0;b<v;++b){var x=g[b],O=_[x],y=n[O];l.joints.push(y)}}}function At(e){var t=e._loadResources;if(0===t.pendingBufferLoads&&t.createSkins){t.createSkins=!1;var a=e.gltf,r=a.accessors,i={};J["a"].skin(a,(function(t,a){var n,o=r[t.inverseBindMatrices];w["a"].equals(t.bindShapeMatrix,w["a"].IDENTITY)||(n=w["a"].clone(t.bindShapeMatrix)),i[a]={inverseBindMatrices:de["a"].getSkinInverseBindMatrices(e,o),bindShapeMatrix:n}})),Et(e,i)}}function Tt(e,t,a,r){return function(i){Object(f["a"])(r)&&(i=e.clampAnimations?r.clampTime(i):r.wrapTime(i),t[a]=r.evaluate(i,t[a]),t.dirtyNumber=e._maxDirtyNumber)}}function Pt(e){var t=e._loadResources;if(t.finishedPendingBufferLoads()&&t.createRuntimeAnimations){t.createRuntimeAnimations=!1,e._runtime.animations=[];var a=e._runtime.nodes,r=e.gltf.accessors;J["a"].animation(e.gltf,(function(t,i){for(var n=t.channels,o=t.samplers,s=Number.MAX_VALUE,c=-Number.MAX_VALUE,u=n.length,l=new Array(u),d=0;d<u;++d){var h=n[d],m=h.target,f=m.path,p=o[h.sampler],_=de["a"].getAnimationParameterValues(e,r[p.input]),g=de["a"].getAnimationParameterValues(e,r[p.output]);s=Math.min(s,_[0]),c=Math.max(c,_[_.length-1]);var v=de["a"].getAnimationSpline(e,i,t,h.sampler,p,_,f,g);l[d]=Tt(e,a[m.node],m.path,v)}e._runtime.animations[i]={name:t.name,startTime:s,stopTime:c,channelEvaluators:l}}))}}function Lt(e,t){var a=e._loadResources;if(a.finishedBuffersCreation()&&a.finishedProgramCreation()&&a.createVertexArrays){a.createVertexArrays=!1;var r=e._rendererResources.buffers,i=e._rendererResources.vertexArrays,n=e.gltf,o=n.accessors;J["a"].mesh(n,(function(a,s){J["a"].meshPrimitive(a,(function(a,c){var u,l,d,h=[],m=Mt(e,a),p=e._decodedData[s+".primitive."+c];J["a"].meshPrimitiveAttribute(a,(function(e,t){if(u=m[t],Object(f["a"])(u)){if(Object(f["a"])(p)){var a=p.attributes;if(a.hasOwnProperty(t)){var i=a[t];return void h.push({index:u,vertexBuffer:r[i.bufferView],componentsPerAttribute:i.componentsPerAttribute,componentDatatype:i.componentDatatype,normalize:i.normalized,offsetInBytes:i.byteOffset,strideInBytes:i.byteStride})}}var s=o[e],c=Object(f["a"])(s.normalized)&&s.normalized;h.push({index:u,vertexBuffer:r[s.bufferView],componentsPerAttribute:Object(Q["a"])(s.type),componentDatatype:s.componentType,normalize:c,offsetInBytes:s.byteOffset,strideInBytes:Object(Y["a"])(n,s)})}}));var _,g=e._precreatedAttributes;if(Object(f["a"])(g))for(d in g)g.hasOwnProperty(d)&&(u=m[d],Object(f["a"])(u)&&(l=g[d],l.index=u,h.push(l)));if(Object(f["a"])(a.indices)){var v=o[a.indices],b=v.bufferView;Object(f["a"])(p)&&(b=p.bufferView),_=r[b]}i[s+".primitive."+c]=new W["a"]({context:t,attributes:h,indexBuffer:_})}))}))}}function It(e){var t=e._loadResources;t.createRenderStates&&(t.createRenderStates=!1,J["a"].material(e.gltf,(function(t,a){Bt(e,t,a)})))}function Bt(e,t,a){var r=e._rendererResources.renderStates,i=[I["a"].FUNC_ADD,I["a"].FUNC_ADD],n=[I["a"].ONE,I["a"].ONE_MINUS_SRC_ALPHA,I["a"].ONE,I["a"].ONE_MINUS_SRC_ALPHA];Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_blend)&&(i=t.extensions.KHR_blend.blendEquation,n=t.extensions.KHR_blend.blendFactors);var o=!t.doubleSided,s="BLEND"===t.alphaMode;r[a]=F["a"].fromCache({cull:{enabled:o},depthTest:{enabled:!0},depthMask:!s,blending:{enabled:s,equationRgb:i[0],equationAlpha:i[1],functionSourceRgb:n[0],functionDestinationRgb:n[1],functionSourceAlpha:n[2],functionDestinationAlpha:n[3]}})}var Nt={MODEL:function(e,t,a){return function(){return a.computedMatrix}},VIEW:function(e,t,a){return function(){return e.view}},PROJECTION:function(e,t,a){return function(){return e.projection}},MODELVIEW:function(e,t,a){var r=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r)}},CESIUM_RTC_MODELVIEW:function(e,t,a){var r=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].setTranslation(r,t._rtcCenterEye,r)}},MODELVIEWPROJECTION:function(e,t,a){var r=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].multiply(e._projection,r,r)}},MODELINVERSE:function(e,t,a){var r=new w["a"];return function(){return w["a"].inverse(a.computedMatrix,r)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,a){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,a){var r=new w["a"],i=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].inverse(r,i)}},MODELVIEWPROJECTIONINVERSE:function(e,t,a){var r=new w["a"],i=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].multiply(e._projection,r,r),w["a"].inverse(r,i)}},MODELINVERSETRANSPOSE:function(e,t,a){var r=new w["a"],i=new M["a"];return function(){return w["a"].inverse(a.computedMatrix,r),w["a"].getMatrix3(r,i),M["a"].transpose(i,i)}},MODELVIEWINVERSETRANSPOSE:function(e,t,a){var r=new w["a"],i=new w["a"],n=new M["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].inverse(r,i),w["a"].getMatrix3(i,n),M["a"].transpose(n,n)}},VIEWPORT:function(e,t,a){return function(){return e.viewportCartesian4}}};function Dt(e,t,a,r){var i=t._runtime.nodes[e];return Nt[a](r,t,i)}function Ut(e,t,a,r,i,n,o){var s,c,u={},l={};return J["a"].techniqueUniform(a,(function(a,d){var h;if(Object(f["a"])(r)&&Object(f["a"])(r[d]))h=ge["a"].createUniformFunction(a.type,r[d],n,o),u[d]=h.func,l[d]=h;else if(Object(f["a"])(a.node))u[d]=Dt(a.node,e,a.semantic,i.uniformState);else if(Object(f["a"])(a.semantic))if("JOINTMATRIX"===a.semantic)s=d;else if("MORPHWEIGHTS"===a.semantic)c=d;else if("ALPHACUTOFF"===a.semantic){var p=t.alphaMode;if(Object(f["a"])(p)&&"MASK"===p){var _=Object(m["a"])(t.alphaCutoff,.5);h=ge["a"].createUniformFunction(a.type,_,n,o),u[d]=h.func,l[d]=h}}else u[d]=ge["a"].getGltfSemanticUniforms()[a.semantic](i.uniformState,e);else if(Object(f["a"])(a.value)){var g=ge["a"].createUniformFunction(a.type,a.value,n,o);u[d]=g.func,l[d]=g}})),{map:u,values:l,jointMatrixUniformName:s,morphWeightsUniformName:c}}function Ft(e,t){var a=e._loadResources;if(a.finishedProgramCreation()&&a.createUniformMaps){a.createUniformMaps=!1;var r=e.gltf,i=e._sourceTechniques,n=e._uniformMaps,o=e._rendererResources.textures,s=e._defaultTexture;J["a"].material(r,(function(a,r){var c=e._runtime.materialsById[r],u=i[c._technique],l=c._values,d=Ut(e,a,u,l,t,o,s),h=n[r];h.uniformMap=d.map,h.values=d.values,h.jointMatrixUniformName=d.jointMatrixUniformName,h.morphWeightsUniformName=d.morphWeightsUniformName}))}}function Vt(e){return ge["a"].createUniformsForDracoQuantizedAttributes(e.attributes)}function kt(e,t){var a=lt(e,t),r=e._quantizedUniforms[a];return ge["a"].createUniformsForQuantizedAttributes(e.gltf,t,r)}function zt(e){return function(){return e}}function qt(e){return function(){return e.computedJointMatrices}}function Ht(e){return function(){return e.weights}}function Gt(e){return function(){return e.silhouetteColor}}function Wt(e){return function(){return e.silhouetteSize}}function Kt(e){return function(){return e.color}}var Zt=new w["a"];function Jt(e){return function(){var t=e.clippingPlanes;if(!Object(f["a"])(t)&&!Object(f["a"])(e._sphericalHarmonicCoefficients)&&!Object(f["a"])(e._specularEnvironmentMaps))return w["a"].IDENTITY;var a=Object(f["a"])(t)?t.modelMatrix:w["a"].IDENTITY;return w["a"].multiply(e._clippingPlaneModelViewMatrix,a,Zt)}}function Yt(e){return function(){var t=e.clippingPlanes;return Object(f["a"])(t)&&t.enabled?t.texture:e._defaultTexture}}function Xt(e){return function(){var t=e.clippingPlanes;if(!Object(f["a"])(t))return u["a"].WHITE.withAlpha(0);var a=u["a"].clone(t.edgeColor);return a.alpha=t.edgeWidth,a}}function Qt(e){return function(){return ne["a"].getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function $t(e){return function(){return e._imageBasedLightingFactor}}function ea(e){return function(){return e._lightColor}}function ta(e){return function(){return e.luminanceAtZenith}}function aa(e){return function(){return e._sphericalHarmonicCoefficients}}function ra(e){return function(){return e._specularEnvironmentMapAtlas.texture}}function ia(e){return function(){return e._specularEnvironmentMapAtlas.texture.dimensions}}function na(e){return function(){return e._specularEnvironmentMapAtlas.maximumMipmapLevel}}function oa(e,t){switch(e.mode){case A["a"].TRIANGLES:return t/3;case A["a"].TRIANGLE_STRIP:case A["a"].TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function sa(e,t,a,i,o){for(var s=e._nodeCommands,c=e._pickIds,u=e.allowPicking,d=e._runtime.meshesByName,h=e._rendererResources,m=h.vertexArrays,p=h.programs,_=h.renderStates,g=e._uniformMaps,v=e.gltf,b=v.accessors,x=v.meshes,O=t.mesh,S=x[O],j=S.primitives,R=j.length,C=0;C<R;++C){var M,E=j[C],A=b[E.indices],T=e._runtime.materialsById[E.material],P=T._program,L=e._decodedData[O+".primitive."+C],I=E.attributes.POSITION;if(Object(f["a"])(I)){var B=ge["a"].getAccessorMinMax(v,I);M=r["a"].fromCornerPoints(n["a"].fromArray(B.min),n["a"].fromArray(B.max))}var N,F,V=m[O+".primitive."+C];if(Object(f["a"])(L))F=L.numberOfIndices,N=0;else if(Object(f["a"])(A))F=A.count,N=A.byteOffset/y["a"].getSizeInBytes(A.componentType);else{var k=b[E.attributes.POSITION];F=k.count,N=0}e._trianglesLength+=oa(E,F);var z=g[E.material],q=z.uniformMap;if(Object(f["a"])(z.jointMatrixUniformName)){var H={};H[z.jointMatrixUniformName]=qt(a),q=Object(l["a"])(q,H)}if(Object(f["a"])(z.morphWeightsUniformName)){var G={};G[z.morphWeightsUniformName]=Ht(a),q=Object(l["a"])(q,G)}q=Object(l["a"])(q,{gltf_color:Kt(e),gltf_colorBlend:Qt(e),gltf_clippingPlanes:Yt(e),gltf_clippingPlanesEdgeStyle:Xt(e),gltf_clippingPlanesMatrix:Jt(e),gltf_iblFactor:$t(e),gltf_lightColor:ea(e),gltf_sphericalHarmonicCoefficients:aa(e),gltf_specularMap:ra(e),gltf_specularMapSize:ia(e),gltf_maxSpecularLOD:na(e),gltf_luminanceAtZenith:ta(e)}),Object(f["a"])(e._uniformMapLoaded)&&(q=e._uniformMapLoaded(q,P,a));var W={};e.extensionsUsed.WEB3D_quantized_attributes?W=kt(e,E):e._dequantizeInShader&&Object(f["a"])(L)&&(W=Vt(L)),q=Object(l["a"])(q,W);var K=_[E.material],Z=K.blending.enabled,J=e._pickObject;Object(f["a"])(J)||(J={primitive:e,id:e.id,node:a.publicNode,mesh:d[S.name]});var Y,X=ye["a"].castShadows(e._shadows),Q=ye["a"].receiveShadows(e._shadows);if(u&&!Object(f["a"])(e._uniformMapLoaded)){Y=i.createPickId(J),c.push(Y);var $={czm_pickColor:zt(Y.color)};q=Object(l["a"])(q,$)}u&&(Y=Object(f["a"])(e._pickIdLoaded)&&Object(f["a"])(e._uniformMapLoaded)?e._pickIdLoaded():"czm_pickColor");var ee,te=new D["a"]({boundingVolume:new r["a"],cull:e.cull,modelMatrix:new w["a"],primitiveType:E.mode,vertexArray:V,count:F,offset:N,shaderProgram:p[P],castShadows:X,receiveShadows:Q,uniformMap:q,renderState:K,owner:J,pass:Z?U["a"].TRANSLUCENT:e.opaquePass,pickId:Y});o||(ee=D["a"].shallowClone(te),ee.boundingVolume=new r["a"],ee.modelMatrix=new w["a"]);var ae={show:!0,boundingSphere:M,command:te,command2D:ee,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0,programId:P};a.commands.push(ae),s.push(ae)}}function ca(e,t,a){var r=e._loadResources;if(r.finishedEverythingButTextureCreation()&&r.createRuntimeNodes){r.createRuntimeNodes=!1;for(var i=[],o=e._runtime.nodes,s=e.gltf,c=s.nodes,u=s.skins,l=s.scenes[s.scene],d=l.nodes,h=d.length,m=[],p={},_=0;_<h;++_){m.push({parentRuntimeNode:void 0,gltfNode:c[d[_]],id:d[_]});var g=[];while(m.length>0){var v=m.pop();p[v.id]=!0;var b=v.parentRuntimeNode,x=v.gltfNode,O=o[v.id];if(0===O.parents.length)if(Object(f["a"])(x.matrix))O.matrix=w["a"].fromColumnMajorArray(x.matrix);else{var y=x.rotation;O.translation=n["a"].fromArray(x.translation),O.rotation=T["a"].unpack(y),O.scale=n["a"].fromArray(x.scale)}Object(f["a"])(b)?(b.children.push(O),O.parents.push(b)):i.push(O),Object(f["a"])(x.mesh)&&sa(e,x,O,t,a);var S=x.children;if(Object(f["a"])(S))for(var j=S.length,R=0;R<j;R++){var C=S[R];p[C]||m.push({parentRuntimeNode:O,gltfNode:c[C],id:S[R]})}var M=x.skin;if(Object(f["a"])(M)&&g.push(u[M].skeleton),0===m.length)for(var E=0;E<g.length;E++){var A=g[E];p[A]||m.push({parentRuntimeNode:void 0,gltfNode:c[A],id:A})}}}e._runtime.rootNodes=i,e._runtime.nodes=o}}function ua(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&(t+=e[a].sizeInBytes);return t}function la(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&(t+=e[a].sizeInBytes);return t}function da(e,t){var a=t.context,r=t.scene3DOnly,i=e._quantizedVertexShaders,n=e._toClipCoordinatesGLSL={},o=e._sourceTechniques,s=e._sourcePrograms,c=e._rendererResources,u=c.sourceShaders;for(var l in e._loadRendererResourcesFromCache&&(u=c.sourceShaders=e._cachedRendererResources.sourceShaders),o)if(o.hasOwnProperty(l)){var d=o[l].program,h=s[d],m=u[h.vertexShader];if(ge["a"].checkSupportedGlExtensions(h.glExtensions,a),e.extensionsUsed.WEB3D_quantized_attributes||e._dequantizeInShader){var p=i[d];Object(f["a"])(p)||(p=dt(m,d,e),i[d]=p),m=p}m=mt(m,d,e._vertexShaderLoaded),n[d]=ge["a"].toClipCoordinatesGLSL(e.gltf,m)}if(e._loadRendererResourcesFromCache){var _=e._cachedRendererResources;c.buffers=_.buffers,c.vertexArrays=_.vertexArrays,c.programs=_.programs,c.silhouettePrograms=_.silhouettePrograms,c.textures=_.textures,c.samplers=_.samplers,c.renderStates=_.renderStates,Object(f["a"])(e._precreatedAttributes)&&Lt(e,a),e._cachedGeometryByteLength+=ua(_.buffers),e._cachedTexturesByteLength+=la(_.textures)}else ut(e,t),bt(e,t),yt(e,a),Ot(e),Ct(e,t);At(e),Pt(e),e._loadRendererResourcesFromCache||(Lt(e,a),It(e)),Ft(e,a),ca(e,a,r)}function ha(e,t){var a=e.publicNode,r=a.matrix;a.useMatrix&&Object(f["a"])(r)?w["a"].clone(r,t):Object(f["a"])(e.matrix)?w["a"].clone(e.matrix,t):(w["a"].fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),a.setMatrix(t))}var ma=[],fa=new o["a"],pa=new w["a"];function _a(e,t,a,i){var s=e._maxDirtyNumber,c=e._runtime.rootNodes,u=c.length,l=ma,d=e._computedModelMatrix;if(e._mode!==Oe["a"].SCENE3D&&!e._ignoreCommands){var h=w["a"].getColumn(d,3,fa);if(o["a"].equals(h,o["a"].UNIT_W)){var m=e.boundingSphere.center,p=L["a"].wgs84To2DModelMatrix(i,m,pa);d=w["a"].multiply(p,d,pa),Object(f["a"])(e._rtcCenter)&&(w["a"].setTranslation(d,o["a"].UNIT_W,d),e._rtcCenter=e._rtcCenter2D)}else d=L["a"].basisTo2D(i,d,pa),e._rtcCenter=e._rtcCenter3D}for(var _=0;_<u;++_){var g=c[_];ha(g,g.transformToRoot),l.push(g);while(l.length>0){g=l.pop();var v=g.transformToRoot,b=g.commands;if(g.dirtyNumber===s||t||a){var x=w["a"].multiplyTransformation(d,v,g.computedMatrix),O=b.length;if(O>0)for(var y=0;y<O;++y){var S=b[y],j=S.command;w["a"].clone(x,j.modelMatrix),r["a"].transform(S.boundingSphere,j.modelMatrix,j.boundingVolume),Object(f["a"])(e._rtcCenter)&&n["a"].add(e._rtcCenter,j.boundingVolume.center,j.boundingVolume.center),j=S.command2D,Object(f["a"])(j)&&e._mode===Oe["a"].SCENE2D&&(w["a"].clone(x,j.modelMatrix),j.modelMatrix[13]-=2*C["a"].sign(j.modelMatrix[13])*C["a"].PI*i.ellipsoid.maximumRadius,r["a"].transform(S.boundingSphere,j.modelMatrix,j.boundingVolume))}}var R=g.children;if(Object(f["a"])(R))for(var M=R.length,E=0;E<M;++E){var A=R[E];A.dirtyNumber=Math.max(A.dirtyNumber,g.dirtyNumber),(A.dirtyNumber===s||a)&&(ha(A,A.transformToRoot),w["a"].multiplyTransformation(v,A.transformToRoot,A.transformToRoot)),l.push(A)}}}++e._maxDirtyNumber}var ga=new w["a"];function va(e){for(var t=e._runtime.skinnedNodes,a=t.length,r=0;r<a;++r){var i=t[r];ga=w["a"].inverseTransformation(i.transformToRoot,ga);for(var n=i.computedJointMatrices,o=i.joints,s=i.bindShapeMatrix,c=i.inverseBindMatrices,u=c.length,l=0;l<u;++l)Object(f["a"])(n[l])||(n[l]=new w["a"]),n[l]=w["a"].multiplyTransformation(ga,o[l].transformToRoot,n[l]),n[l]=w["a"].multiplyTransformation(n[l],c[l],n[l]),Object(f["a"])(s)&&(n[l]=w["a"].multiplyTransformation(n[l],s,n[l]))}}function ba(e){for(var t=e._runtime.rootNodes,a=t.length,r=ma,i=0;i<a;++i){var n=t[i];n.computedShow=n.publicNode.show,r.push(n);while(r.length>0){n=r.pop();for(var o=n.computedShow,s=n.commands,c=s.length,u=0;u<c;++u)s[u].show=o;var l=n.children;if(Object(f["a"])(l))for(var d=l.length,h=0;h<d;++h){var m=l[h];m.computedShow=o&&m.publicNode.show,r.push(m)}}}}function xa(e,t){var a=e.id;if(e._id!==a){e._id=a;for(var r=e._pickIds,i=r.length,n=0;n<i;++n)r[n].object.id=a}}function Oa(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?A["a"].LINES:A["a"].TRIANGLES,a=e._nodeCommands,r=a.length,i=0;i<r;++i)a[i].command.primitiveType=t}}function ya(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e.debugShowBoundingVolume,a=e._nodeCommands,r=a.length,i=0;i<r;++i)a[i].command.debugShowBoundingVolume=t}}function Sa(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=ye["a"].castShadows(e.shadows),a=ye["a"].receiveShadows(e.shadows),r=e._nodeCommands,i=r.length,n=0;n<i;n++){var o=r[n];o.command.castShadows=t,o.command.receiveShadows=a}}}function ja(e){var t=Object(c["a"])(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=re["a"].ALPHA_BLEND,F["a"].fromCache(t)}function Ra(e){var t=D["a"].shallowClone(e);return t.pass=U["a"].TRANSLUCENT,t.renderState=ja(e.renderState),t}function Ca(e,t,a){var r=t.scene3DOnly,i=e.color.alpha;if(i>0&&i<1){var n=e._nodeCommands,o=n.length;if(!Object(f["a"])(n[0].translucentCommand)||a)for(var s=0;s<o;++s){var c=n[s],u=c.command;if(c.translucentCommand=Ra(u),!r){var l=c.command2D;c.translucentCommand2D=Ra(l)}}}}function Ma(e,t){var a=e._rendererResources.programs;for(var r in a)if(a.hasOwnProperty(r)&&a[r]===t)return r}function wa(e,t,a){var r=t.vertexShaderSource.sources[0],i=t._attributeLocations,n=e._normalAttributeName;r=z["a"].replaceMain(r,"gltf_silhouette_main"),r+="uniform float gltf_silhouetteSize; \nvoid main() \n{ \n    gltf_silhouette_main(); \n    vec3 n = normalize(czm_normal3D * "+n+"); \n    n.x *= czm_projection[0][0]; \n    n.y *= czm_projection[1][1]; \n    vec4 clip = gl_Position; \n    clip.xy += n.xy * clip.w * gltf_silhouetteSize * czm_pixelRatio / czm_viewport.z; \n    gl_Position = clip; \n}";var o="uniform vec4 gltf_silhouetteColor; \nvoid main() \n{ \n    gl_FragColor = czm_gammaCorrect(gltf_silhouetteColor); \n}";return k["a"].fromCache({context:a.context,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:i})}function Ea(e,t){return Pe(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&Object(f["a"])(e._normalAttributeName)}function Aa(e){for(var t=e._nodeCommands,a=t.length,r=0;r<a;++r){var i=t[r],n=i.command;if(n.pass===U["a"].TRANSLUCENT)return!0}return!1}function Ta(e){return e.color.alpha>0&&e.color.alpha<1}function Pa(e){return 0===e.color.alpha}function La(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var Ia=0;function Ba(e,t){for(var a=++Ia%255,r=Aa(e)||Ta(e)||e.silhouetteColor.alpha<1,i=e._rendererResources.silhouettePrograms,n=t.scene3DOnly,o=e._nodeCommands,s=o.length,u=0;u<s;++u){var d=o[u],h=d.command,m=Ta(e)?d.translucentCommand:h,p=D["a"].shallowClone(m),_=Object(c["a"])(m.renderState);_.stencilTest={enabled:!0,frontFunction:I["a"].ALWAYS,backFunction:I["a"].ALWAYS,reference:a,mask:-1,frontOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].REPLACE},backOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].REPLACE}},Pa(e)&&(_.colorMask={red:!1,green:!1,blue:!1,alpha:!1},_.depthMask=!1),_=F["a"].fromCache(_),p.renderState=_,d.silhouetteModelCommand=p;var g=D["a"].shallowClone(h);_=Object(c["a"])(h.renderState,!0),_.depthTest.enabled=!0,_.cull.enabled=!1,r&&(g.pass=U["a"].TRANSLUCENT,_.depthMask=!1,_.blending=re["a"].ALPHA_BLEND),_.stencilTest={enabled:!0,frontFunction:I["a"].NOTEQUAL,backFunction:I["a"].NOTEQUAL,reference:a,mask:-1,frontOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].KEEP},backOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].KEEP}},_=F["a"].fromCache(_);var v=h.shaderProgram,b=Ma(e,v),x=i[b];Object(f["a"])(x)||(x=wa(e,v,t),i[b]=x);var O=Object(l["a"])(h.uniformMap,{gltf_silhouetteColor:Gt(e),gltf_silhouetteSize:Wt(e)});if(g.renderState=_,g.shaderProgram=x,g.uniformMap=O,g.castShadows=!1,g.receiveShadows=!1,d.silhouetteColorCommand=g,!n){var y=d.command2D,S=D["a"].shallowClone(p);S.boundingVolume=y.boundingVolume,S.modelMatrix=y.modelMatrix,d.silhouetteModelCommand2D=S;var j=D["a"].shallowClone(g);S.boundingVolume=y.boundingVolume,S.modelMatrix=y.modelMatrix,d.silhouetteColorCommand2D=j}}}function Na(e,t,a){return e=z["a"].replaceMain(e,"gltf_clip_main"),e+=Te._getClippingFunction(t,a)+"\n",e+="uniform sampler2D gltf_clippingPlanes; \nuniform mat4 gltf_clippingPlanesMatrix; \nuniform vec4 gltf_clippingPlanesEdgeStyle; \nvoid main() \n{ \n    gltf_clip_main(); \n"+Object(se["a"])("gltf_clippingPlanes","gltf_clippingPlanesMatrix","gltf_clippingPlanesEdgeStyle")+"} \n",e}function Da(e,t,a){if(Ea(e,t)){var r=e._nodeCommands,i=La(e.color.alpha,e._colorPreviousAlpha)||La(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!Object(f["a"])(r[0].silhouetteModelCommand);e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,(i||a)&&Ba(e,t)}}function Ua(e,t){var a=e._clippingPlanes;Object(f["a"])(a)&&a.owner===e&&a.enabled&&a.update(t)}var Fa=new r["a"];function Va(e,t,a){return Fa.center=e,Fa.radius=t,a.camera.getPixelSize(Fa,a.context.drawingBufferWidth,a.context.drawingBufferHeight)}var ka=new n["a"],za=new s["a"];function qa(e,t){var a=e.scale;if(0!==e.minimumPixelSize){var r=t.context,i=Math.max(r.drawingBufferWidth,r.drawingBufferHeight),o=Object(f["a"])(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(ka.x=o[12],ka.y=o[13],ka.z=o[14],Object(f["a"])(e._rtcCenter)&&n["a"].add(e._rtcCenter,ka,ka),e._mode!==Oe["a"].SCENE3D){var s=t.mapProjection,c=s.ellipsoid.cartesianToCartographic(ka,za);s.project(c,ka),n["a"].fromElements(ka.z,ka.x,ka.y,ka)}var u=e.boundingSphere.radius,l=Va(ka,u,t),d=1/l,h=Math.min(d*(2*u),i);h<e.minimumPixelSize&&(a=e.minimumPixelSize*l/(2*e._initialRadius))}return Object(f["a"])(e.maximumScale)?Math.min(e.maximumScale,a):a}function Ha(e){Object(f["a"])(e._cacheKey)&&Object(f["a"])(e._cachedGltf)&&0===--e._cachedGltf.count&&delete Ee[e._cacheKey],e._cachedGltf=void 0}function Ga(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.sourceShaders=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function Wa(e){for(var t in e)e.hasOwnProperty(t)&&e[t].destroy()}function Ka(e){Wa(e.buffers),Wa(e.vertexArrays),Wa(e.programs),Wa(e.silhouettePrograms),Wa(e.textures)}function Za(e,t,a){return function(r){if(e.heightReference===ue["a"].RELATIVE_TO_GROUND){var i=t.cartesianToCartographic(r,za);i.height+=a.height,t.cartographicToCartesian(i,r)}var n=e._clampedModelMatrix;w["a"].clone(e.modelMatrix,n),n[12]=r.x,n[13]=r.y,n[14]=r.z,e._heightChanged=!0}}function Ja(e){Object(f["a"])(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);var t=e._scene;if(Object(f["a"])(t)&&Object(f["a"])(t.globe)&&e.heightReference!==ue["a"].NONE){var a=t.globe,r=a.ellipsoid,i=e.modelMatrix;ka.x=i[12],ka.y=i[13],ka.z=i[14];var n=r.cartesianToCartographic(ka);Object(f["a"])(e._clampedModelMatrix)||(e._clampedModelMatrix=w["a"].clone(i,new w["a"]));var o=a._surface;e._removeUpdateHeightCallback=o.updateHeight(n,Za(e,r,n));var c=a.getHeight(n);if(Object(f["a"])(c)){var u=Za(e,r,n);s["a"].clone(n,za),za.height=c,r.cartographicToCartesian(za,ka),u(ka)}}else e._clampedModelMatrix=void 0}Ga.prototype.release=function(){if(0===--this.count)return Object(f["a"])(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],Ka(this),Object(_["a"])(this)};var Ya=new n["a"],Xa=new s["a"];function Qa(e,t){var a,r=e.distanceDisplayCondition,i=r.near*r.near,o=r.far*r.far;if(t.mode===Oe["a"].SCENE2D){var s=t.camera.frustum.right-t.camera.frustum.left;a=.5*s,a*=a}else{var c=w["a"].getTranslation(e.modelMatrix,Ya);if(t.mode===Oe["a"].COLUMBUS_VIEW){var u=t.mapProjection,l=u.ellipsoid,d=l.cartesianToCartographic(c,Xa);c=u.project(d,c),n["a"].fromElements(c.z,c.x,c.y,c)}a=n["a"].distanceSquared(c,t.camera.positionWC)}return a>=i&&a<=o}function $a(e,t){e.programs!==t.programs&&Wa(e.programs),e.silhouettePrograms!==t.silhouettePrograms&&Wa(e.silhouettePrograms)}function er(e,t){var a,r=e._rendererResources,i=e._cachedRendererResources;if($a(r,i),Ie(e)||Le(e)||e._shouldRegenerateShaders){e._shouldRegenerateShaders=!1,r.programs={},r.silhouettePrograms={};var n,o={},s=e._sourceTechniques;for(var c in s)s.hasOwnProperty(c)&&(n=s[c],a=n.program,o[a]||(o[a]=!0,_t({programId:a,techniqueId:c},e,t.context)))}else r.programs=i.programs,r.silhouettePrograms=i.silhouettePrograms;for(var u=r.programs,l=e._nodeCommands,d=l.length,h=0;h<d;++h){var m=l[h];a=m.programId;var p=u[a];m.command.shaderProgram=p,Object(f["a"])(m.command2D)&&(m.command2D.shaderProgram=p)}Ca(e,t,!0),Da(e,t,!0)}Te.prototype.update=function(e){if(e.mode!==Oe["a"].MORPHING)if(v["a"].supportsWebP.initialized){var t=v["a"].supportsWebP(),a=e.context;if(this._defaultTexture=a.defaultTexture,this._state===je.NEEDS_LOAD&&Object(f["a"])(this.gltf)){var r,i=this.cacheKey;if(Object(f["a"])(i)){a.cache.modelRendererResourceCache=Object(m["a"])(a.cache.modelRendererResourceCache,{});var o=a.cache.modelRendererResourceCache;if(r=o[this.cacheKey],Object(f["a"])(r)){if(!r.ready)return;++r.count,this._loadRendererResourcesFromCache=!0}else r=new Ga(a,i),r.count=1,o[this.cacheKey]=r;this._cachedRendererResources=r}else r=new Ga(a),r.count=1,this._cachedRendererResources=r;if(this._state=je.LOADING,this._state!==je.FAILED){var s=this.gltf.extensions;if(Object(f["a"])(s)&&Object(f["a"])(s.CESIUM_RTC)){var c=n["a"].fromArray(s.CESIUM_RTC.center);if(!n["a"].equals(c,n["a"].ZERO)){this._rtcCenter3D=c;var u=e.mapProjection,l=u.ellipsoid,d=l.cartesianToCartographic(this._rtcCenter3D),h=u.project(d);n["a"].fromElements(h.z,h.x,h.y,h),this._rtcCenter2D=h,this._rtcCenterEye=new n["a"],this._rtcCenter=this._rtcCenter3D}}Object(Z["a"])(this.gltf),this._loadResources=new me["a"],this._loadRendererResourcesFromCache||ge["a"].parseBuffers(this,ze)}}var p=this._loadResources,_=this._incrementallyLoadTextures,g=!1;if(this._state===je.LOADING){if(0===p.pendingBufferLoads){if(!p.initialized){if(e.brdfLutGenerator.update(e),ge["a"].checkSupportedExtensions(this.extensionsRequired,t),ge["a"].updateForwardAxis(this),!Object(f["a"])(this.gltf.extras.sourceVersion)){var b=this.gltf;b.extras.sourceVersion=ge["a"].getAssetVersion(b),b.extras.sourceKHRTechniquesWebGL=Object(f["a"])(ge["a"].getUsedExtensions(b).KHR_techniques_webgl),this._sourceVersion=b.extras.sourceVersion,this._sourceKHRTechniquesWebGL=b.extras.sourceKHRTechniquesWebGL,Object(ee["a"])(b),Object(K["a"])(b);var x={addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};Object(be["a"])(b,x),Object(xe["a"])(b,x)}this._sourceVersion=this.gltf.extras.sourceVersion,this._sourceKHRTechniquesWebGL=this.gltf.extras.sourceKHRTechniquesWebGL,this._dequantizeInShader=this._dequantizeInShader&&oe["a"].hasExtension(this),ke(this),Ze(this),He(this),this._loadRendererResourcesFromCache||(qe(this),We(this),Ke(this),Qe(this,a,t)),tt(this),at(this),et(this),oe["a"].parse(this,a),p.initialized=!0}p.finishedDecoding()||oe["a"].decodeModel(this,a).otherwise(ge["a"].getFailedLoadFunction(this,"model",this.basePath)),p.finishedDecoding()&&!p.resourcesParsed&&(this._boundingSphere=ge["a"].computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,oe["a"].cacheDataForModel(this),p.resourcesParsed=!0),p.resourcesParsed&&0===p.pendingShaderLoads&&da(this,e)}(p.finished()||_&&p.finishedEverythingButTextureCreation())&&(this._state=je.LOADED,g=!0)}if(Object(f["a"])(p)&&this._state===je.LOADED&&(_&&!g&&da(this,e),p.finished())){this._loadResources=void 0;var O=this._rendererResources,y=this._cachedRendererResources;y.buffers=O.buffers,y.vertexArrays=O.vertexArrays,y.programs=O.programs,y.sourceShaders=O.sourceShaders,y.silhouettePrograms=O.silhouettePrograms,y.textures=O.textures,y.samplers=O.samplers,y.renderStates=O.renderStates,y.ready=!0,this._normalAttributeName=ge["a"].getAttributeOrUniformBySemantic(this.gltf,"NORMAL"),Object(f["a"])(this._precreatedAttributes)&&(y.vertexArrays={}),this.releaseGltfJson&&Ha(this)}var S=ve["a"].isSupported(a);if(this._shouldUpdateSpecularMapAtlas&&S){if(this._shouldUpdateSpecularMapAtlas=!1,this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),this._specularEnvironmentMapAtlas=void 0,Object(f["a"])(this._specularEnvironmentMaps)){this._specularEnvironmentMapAtlas=new ve["a"](this._specularEnvironmentMaps);var j=this;this._specularEnvironmentMapAtlas.readyPromise.then((function(){j._shouldRegenerateShaders=!0})).otherwise((function(e){console.error("Error loading specularEnvironmentMaps: "+e)}))}this._shouldRegenerateShaders=!0}Object(f["a"])(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e);var R=!Object(f["a"])(this._specularEnvironmentMapAtlas)&&Object(f["a"])(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,M=!Object(f["a"])(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,E=!Object(f["a"])(this._sphericalHarmonicCoefficients)&&Object(f["a"])(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,A=!Object(f["a"])(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||R||M||E||A,this._useDefaultSpecularMaps=!Object(f["a"])(this._specularEnvironmentMapAtlas)&&Object(f["a"])(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!Object(f["a"])(this._sphericalHarmonicCoefficients)&&Object(f["a"])(e.sphericalHarmonicCoefficients);var T=Ea(this,e),P=Ta(this),L=Pa(this),I=!Object(f["a"])(this.distanceDisplayCondition)||Qa(this,e),B=this.show&&I&&0!==this.scale&&(!L||T);if(B&&this._state===je.LOADED||g){var N=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;var D=this.modelMatrix,U=e.mode!==this._mode;this._mode=e.mode;var F=!w["a"].equals(this._modelMatrix,D)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||0!==this.minimumPixelSize||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||U;if(F||g){w["a"].clone(D,this._modelMatrix),Ja(this),Object(f["a"])(this._clampedModelMatrix)&&(D=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;var V=qa(this,e),k=this._computedModelMatrix;w["a"].multiplyByUniformScale(D,V,k),this._upAxis===ae["a"].Y?w["a"].multiplyTransformation(k,ae["a"].Y_UP_TO_Z_UP,k):this._upAxis===ae["a"].X&&w["a"].multiplyTransformation(k,ae["a"].X_UP_TO_Z_UP,k),this.forwardAxis===ae["a"].Z&&w["a"].multiplyTransformation(k,ae["a"].Z_UP_TO_X_UP,k)}(N||F||g)&&(_a(this,F,g,e.mapProjection),this._dirty=!0,(N||g)&&va(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,ba(this)),xa(this,a),Oa(this),ya(this),Sa(this),Ua(this,e);var z=this._clippingPlanes,q=0,H=Object(f["a"])(z)&&z.enabled&&z.length>0,G=Object(f["a"])(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics,W=Object(f["a"])(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps;if(H||G||W){var J=Object(m["a"])(this.clippingPlanesOriginMatrix,D);w["a"].multiply(a.uniformState.view3D,J,this._clippingPlaneModelViewMatrix)}H&&(q=z.clippingPlanesState);var Y=this._shouldRegenerateShaders;Y=Y||this._clippingPlanesState!==q,this._clippingPlanesState=q;var X=Le(this);X!==this._colorShadingEnabled&&(this._colorShadingEnabled=X,Y=!0),Y?er(this,e):(Ca(this,e,!1),Da(this,e,!1))}if(g){var Q=this;e.afterRender.push((function(){Q._ready=!0,Q._readyPromise.resolve(Q)}))}else{if(B&&!this._ignoreCommands){var $,te,re,ie=e.commandList,ne=e.passes,se=this._nodeCommands,ce=se.length,ue=e.mapProjection.ellipsoid.maximumRadius*C["a"].PI;if(ne.render||ne.pick&&this.allowPicking){for($=0;$<ce;++$)if(te=se[$],te.show){var le=P?te.translucentCommand:te.command;if(le=T?te.silhouetteModelCommand:le,ie.push(le),re=te.command.boundingVolume,e.mode===Oe["a"].SCENE2D&&(re.center.y+re.radius>ue||re.center.y-re.radius<ue)){var de=P?te.translucentCommand2D:te.command2D;de=T?te.silhouetteModelCommand2D:de,ie.push(de)}}if(T&&!ne.pick)for($=0;$<ce;++$)te=se[$],te.show&&(ie.push(te.silhouetteColorCommand),re=te.command.boundingVolume,e.mode===Oe["a"].SCENE2D&&(re.center.y+re.radius>ue||re.center.y-re.radius<ue)&&ie.push(te.silhouetteColorCommand2D))}}var he=this._credit;Object(f["a"])(he)&&e.creditDisplay.addCredit(he);for(var fe=this._resourceCredits,pe=fe.length,_e=0;_e<pe;_e++)e.creditDisplay.addCredit(fe[_e])}}else v["a"].supportsWebP.initialize()},Te.prototype.isDestroyed=function(){return!1},Te.prototype.destroy=function(){Object(f["a"])(this._precreatedAttributes)&&Wa(this._rendererResources.vertexArrays),Object(f["a"])(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),Object(f["a"])(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),Object(f["a"])(this._cachedRendererResources)&&$a(this._rendererResources,this._cachedRendererResources),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release(),oe["a"].destroyCachedDataForModel(this);for(var e=this._pickIds,t=e.length,a=0;a<t;++a)e[a].destroy();Ha(this),this._quantizedVertexShaders=void 0;var r=this._clippingPlanes;return Object(f["a"])(r)&&!r.isDestroyed()&&r.owner===this&&r.destroy(),this._clippingPlanes=void 0,this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),Object(_["a"])(this)},Te._getClippingFunction=ce["a"],Te._modifyShaderForColor=ht,t["a"]=Te}}]);