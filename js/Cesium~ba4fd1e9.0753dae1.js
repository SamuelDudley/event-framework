(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~ba4fd1e9"],{2221:function(e,t,a){"use strict";var r=a("c8d1"),i=a("e438"),o=a("cef5"),s=a("670c"),n=a("be18"),h=a("a561"),u=a("bef8"),c=a("2f63"),d=a("4f04"),l=a("af23"),f=a("93da"),g=a("78e5"),m=a("9410"),T=a("eace"),w=a("0769"),x=a("4261"),v=a("fde5"),_=a("1184"),b=a("2856"),p=a("ee78");function S(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new h["a"]}S.prototype.update=function(e,t,a){this.changedThisFrame&&(z(e,t,this.tile,a),this.changedThisFrame=!1)},S.prototype.destroy=function(e){Object(c["a"])(this.vertexArray)&&(Object(c["a"])(e)?e.push(this.vertexArray):b["a"]._freeVertexArray(this.vertexArray,e),this.vertexArray=void 0),Object(c["a"])(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)};var y=new m["a"];function O(e,t,a,r,i,o,s,n,h){if(void 0!==r){var u=r;while(u&&(u._lastSelectionResultFrame!==i||p["a"].wasKicked(u._lastSelectionResult)||p["a"].originalResult(u._lastSelectionResult)===p["a"].CULLED)){if(s)return;var l=u.parent;if(o>=v["a"].NORTHWEST&&void 0!==l)switch(o){case v["a"].NORTHWEST:u=u===l.northwestChild?l:void 0;break;case v["a"].NORTHEAST:u=u===l.northeastChild?l:void 0;break;case v["a"].SOUTHWEST:u=u===l.southwestChild?l:void 0;break;case v["a"].SOUTHEAST:u=u===l.southeastChild?l:void 0;break}else u=l}if(void 0!==u)if(u._lastSelectionResult!==p["a"].RENDERED){if(p["a"].originalResult(r._lastSelectionResult)!==p["a"].CULLED)switch(o){case v["a"].WEST:O(e,t,a,r.northwestChild,i,o,!0,n,h),O(e,t,a,r.southwestChild,i,o,!0,n,h);break;case v["a"].EAST:O(e,t,a,r.southeastChild,i,o,!0,n,h),O(e,t,a,r.northeastChild,i,o,!0,n,h);break;case v["a"].SOUTH:O(e,t,a,r.southwestChild,i,o,!0,n,h),O(e,t,a,r.southeastChild,i,o,!0,n,h);break;case v["a"].NORTH:O(e,t,a,r.northeastChild,i,o,!0,n,h),O(e,t,a,r.northwestChild,i,o,!0,n,h);break;case v["a"].NORTHWEST:O(e,t,a,r.northwestChild,i,o,!0,n,h);break;case v["a"].NORTHEAST:O(e,t,a,r.northeastChild,i,o,!0,n,h);break;case v["a"].SOUTHWEST:O(e,t,a,r.southwestChild,i,o,!0,n,h);break;case v["a"].SOUTHEAST:O(e,t,a,r.southeastChild,i,o,!0,n,h);break;default:throw new d["a"]("Invalid edge")}}else{if(Object(c["a"])(u.data.vertexArray))return;M(e,t,a,u,o,i,n,h)}}}function M(e,t,a,r,i,o,s,n){var h=r.data;if(void 0===h.fill)h.fill=new S(r);else if(h.fill.visitedFrame===o)return;h.fill.enqueuedFrame!==o&&(h.fill.enqueuedFrame=o,h.fill.changedThisFrame=!1,s.enqueue(r)),E(e,t,a,r,i,n)}function E(e,t,a,r,i,o){var s,n,h,u,d,l,g,m=r.data.fill,T=a.data.fill;switch(Object(c["a"])(T)?(T.visitedFrame=t.frameNumber,T.changedThisFrame&&(z(e,t,a,o),T.changedThisFrame=!1),s=a.data.fill.mesh):s=a.data.mesh,i){case v["a"].WEST:n=m.westMeshes,h=m.westTiles;break;case v["a"].SOUTH:n=m.southMeshes,h=m.southTiles;break;case v["a"].EAST:n=m.eastMeshes,h=m.eastTiles;break;case v["a"].NORTH:n=m.northMeshes,h=m.northTiles;break;case v["a"].NORTHWEST:return m.changedThisFrame=m.changedThisFrame||m.northwestMesh!==s,m.northwestMesh=s,void(m.northwestTile=a);case v["a"].NORTHEAST:return m.changedThisFrame=m.changedThisFrame||m.northeastMesh!==s,m.northeastMesh=s,void(m.northeastTile=a);case v["a"].SOUTHWEST:return m.changedThisFrame=m.changedThisFrame||m.southwestMesh!==s,m.southwestMesh=s,void(m.southwestTile=a);case v["a"].SOUTHEAST:return m.changedThisFrame=m.changedThisFrame||m.southeastMesh!==s,m.southeastMesh=s,void(m.southeastTile=a)}if(a.level<=r.level)return m.changedThisFrame=m.changedThisFrame||n[0]!==s||1!==n.length,n[0]=s,h[0]=a,n.length=1,void(h.length=1);var w,x=a.rectangle,_=r.rectangle;switch(i){case v["a"].WEST:for(w=(_.north-_.south)*f["a"].EPSILON5,u=0;u<h.length;++u)if(l=h[u],g=l.rectangle,f["a"].greaterThan(x.north,g.south,w))break;for(d=u;d<h.length;++d)if(l=h[d],g=l.rectangle,f["a"].greaterThanOrEquals(x.south,g.north,w))break;break;case v["a"].SOUTH:for(w=(_.east-_.west)*f["a"].EPSILON5,u=0;u<h.length;++u)if(l=h[u],g=l.rectangle,f["a"].lessThan(x.west,g.east,w))break;for(d=u;d<h.length;++d)if(l=h[d],g=l.rectangle,f["a"].lessThanOrEquals(x.east,g.west,w))break;break;case v["a"].EAST:for(w=(_.north-_.south)*f["a"].EPSILON5,u=0;u<h.length;++u)if(l=h[u],g=l.rectangle,f["a"].lessThan(x.south,g.north,w))break;for(d=u;d<h.length;++d)if(l=h[d],g=l.rectangle,f["a"].lessThanOrEquals(x.north,g.south,w))break;break;case v["a"].NORTH:for(w=(_.east-_.west)*f["a"].EPSILON5,u=0;u<h.length;++u)if(l=h[u],g=l.rectangle,f["a"].greaterThan(x.east,g.west,w))break;for(d=u;d<h.length;++d)if(l=h[d],g=l.rectangle,f["a"].greaterThanOrEquals(x.west,g.east,w))break;break}d-u===1?(m.changedThisFrame=m.changedThisFrame||n[u]!==s,n[u]=s,h[u]=a):(m.changedThisFrame=!0,n.splice(u,d-u,s),h.splice(u,d-u,a))}S.updateFillTiles=function(e,t,a,r){var i=e._quadtree,o=i._levelZeroTiles,s=i._lastSelectionFrameNumber,n=y;n.clear();for(var h=0;h<t.length;++h){var u=t[h];Object(c["a"])(u.data.vertexArray)&&n.enqueue(t[h])}var d=n.dequeue();while(void 0!==d){var l=d.findTileToWest(o),f=d.findTileToSouth(o),g=d.findTileToEast(o),m=d.findTileToNorth(o);O(e,a,d,l,s,v["a"].EAST,!1,n,r),O(e,a,d,f,s,v["a"].NORTH,!1,n,r),O(e,a,d,g,s,v["a"].WEST,!1,n,r),O(e,a,d,m,s,v["a"].SOUTH,!1,n,r);var T=l.findTileToNorth(o),w=l.findTileToSouth(o),x=g.findTileToNorth(o),_=g.findTileToSouth(o);O(e,a,d,T,s,v["a"].SOUTHEAST,!1,n,r),O(e,a,d,x,s,v["a"].SOUTHWEST,!1,n,r),O(e,a,d,w,s,v["a"].NORTHEAST,!1,n,r),O(e,a,d,_,s,v["a"].NORTHWEST,!1,n,r),d=n.dequeue()}};var N=new u["a"],A=new u["a"],C=new n["a"],I=new n["a"],R=new s["a"],L=new s["a"],H=new s["a"];function F(){this.height=0,this.encodedNormal=new s["a"]}function W(e,t,a,r,i,o,s,n,h){if(Object(c["a"])(i))return i;var u;if(Object(c["a"])(o)&&Object(c["a"])(s))u=.5*(o.height+s.height);else if(Object(c["a"])(o))u=o.height;else if(Object(c["a"])(s))u=s.height;else if(Object(c["a"])(n))u=n.height;else{var d=e.tile.data,l=d.tileBoundingRegion,f=0,g=0;Object(c["a"])(l)&&(f=l.minimumHeight,g=l.maximumHeight),u=.5*(f+g)}return Q(e,t,a,r,u,h),h}var j={minimumHeight:0,maximumHeight:0},k=new F,P=new F,D=new F,U=new F,B="undefined"!==typeof Uint8Array?new Uint8Array(81):void 0;function z(e,t,a,i){b["a"].initialize(a,e.terrainProvider,e._imageryLayers);var n=a.data,h=n.fill,u=a.rectangle,d=a.tilingScheme.ellipsoid,f=$(h,d,0,1,h.northwestTile,h.northwestMesh,h.northTiles,h.northMeshes,h.westTiles,h.westMeshes,D),m=$(h,d,0,0,h.southwestTile,h.southwestMesh,h.westTiles,h.westMeshes,h.southTiles,h.southMeshes,k),T=$(h,d,1,0,h.southeastTile,h.southeastMesh,h.southTiles,h.southMeshes,h.eastTiles,h.eastMeshes,P),p=$(h,d,1,1,h.northeastTile,h.northeastMesh,h.eastTiles,h.eastMeshes,h.northTiles,h.northMeshes,U);f=W(h,d,0,1,f,m,p,T,D),m=W(h,d,0,0,m,f,T,p,k),T=W(h,d,1,1,T,m,p,f,P),p=W(h,d,1,1,p,T,f,m,U);var S,y,O=m.height,M=T.height,E=f.height,C=p.height,L=Math.min(O,M,E,C),F=Math.max(O,M,E,C),z=.5*(L+F),G=e.getLevelMaximumGeometricError(a.level),q=d.maximumRadius-G,Y=4*Math.acos(q/d.maximumRadius);if(Y*=1.5,u.width>Y&&F-L<=G){var J=new l["a"]({width:9,height:9,buffer:B,structure:{heightOffset:F}});h.mesh=J._createMeshSync(a.tilingScheme,a.x,a.y,a.level,1)}else{var Z=new w["a"](void 0,void 0,void 0,void 0,!0,!0),X=A;X.longitude=.5*(u.east+u.west),X.latitude=.5*(u.north+u.south),X.height=z,Z.center=d.cartographicToCartesian(X,Z.center);var K,Q=5;for(K=h.westMeshes,S=0,y=K.length;S<y;++S)Q+=K[S].eastIndicesNorthToSouth.length;for(K=h.southMeshes,S=0,y=K.length;S<y;++S)Q+=K[S].northIndicesWestToEast.length;for(K=h.eastMeshes,S=0,y=K.length;S<y;++S)Q+=K[S].westIndicesSouthToNorth.length;for(K=h.northMeshes,S=0,y=K.length;S<y;++S)Q+=K[S].southIndicesEastToWest.length;var ee=j;ee.minimumHeight=L,ee.maximumHeight=F;var ae=Z.getStride(),re=new Float32Array(Q*ae),ie=0,oe=ie;ie=V(d,u,Z,re,ie,0,1,f.height,f.encodedNormal,1,ee),ie=te(h,d,Z,re,ie,h.westTiles,h.westMeshes,v["a"].EAST,ee);var se=ie;ie=V(d,u,Z,re,ie,0,0,m.height,m.encodedNormal,0,ee),ie=te(h,d,Z,re,ie,h.southTiles,h.southMeshes,v["a"].NORTH,ee);var he=ie;ie=V(d,u,Z,re,ie,1,0,T.height,T.encodedNormal,0,ee),ie=te(h,d,Z,re,ie,h.eastTiles,h.eastMeshes,v["a"].WEST,ee);var ue=ie;ie=V(d,u,Z,re,ie,1,1,p.height,p.encodedNormal,1,ee),ie=te(h,d,Z,re,ie,h.northTiles,h.northMeshes,v["a"].SOUTH,ee),L=ee.minimumHeight,F=ee.maximumHeight;var ce=g["a"].fromRectangle(u,L,F,a.tilingScheme.ellipsoid),de=_["a"].geodeticLatitudeToMercatorAngle(u.south),le=1/(_["a"].geodeticLatitudeToMercatorAngle(u.north)-de),fe=(_["a"].geodeticLatitudeToMercatorAngle(X.latitude)-de)*le;d.geodeticSurfaceNormalCartographic(N,I);var ge=r["a"].octEncode(I,R),me=ie;Z.encode(re,ie*ae,ce.center,s["a"].fromElements(.5,.5,H),z,ge,fe),++ie;var Te,we=ie,xe=we<256?1:2,ve=3*(we-1),_e=ve*xe,be=(re.length-we*ae)*Float32Array.BYTES_PER_ELEMENT;if(be>=_e){var pe=we*ae*Float32Array.BYTES_PER_ELEMENT;Te=we<256?new Uint8Array(re.buffer,pe,ve):new Uint16Array(re.buffer,pe,ve)}else Te=we<256?new Uint8Array(ve):new Uint16Array(ve);re=new Float32Array(re.buffer,0,we*ae);var Se=0;for(S=0;S<we-2;++S)Te[Se++]=me,Te[Se++]=S,Te[Se++]=S+1;Te[Se++]=me,Te[Se++]=S,Te[Se++]=0;var ye=[];for(S=se;S>=oe;--S)ye.push(S);var Oe=[];for(S=he;S>=se;--S)Oe.push(S);var Me=[];for(S=ue;S>=he;--S)Me.push(S);var Ee=[];for(Ee.push(0),S=me-1;S>=ue;--S)Ee.push(S);h.mesh=new x["a"](Z.center,re,Te,L,F,o["a"].fromOrientedBoundingBox(ce),ne(e,ce.center,u,F),Z.getStride(),ce,Z,t.terrainExaggeration,ye,Oe,Me,Ee)}var Ne=t.context;Object(c["a"])(h.vertexArray)&&(Object(c["a"])(i)?i.push(h.vertexArray):b["a"]._freeVertexArray(h.vertexArray)),h.vertexArray=b["a"]._createVertexArrayForMesh(Ne,h.mesh),n.processImagery(a,e.terrainProvider,t,!0);var Ae=h.waterMaskTexture;if(h.waterMaskTexture=void 0,e.terrainProvider.hasWaterMask){var Ce=n._findAncestorTileWithTerrainData(a);Object(c["a"])(Ce)&&Object(c["a"])(Ce.data.waterMaskTexture)&&(h.waterMaskTexture=Ce.data.waterMaskTexture,++h.waterMaskTexture.referenceCount,n._computeWaterMaskTranslationAndScale(a,Ce,h.waterMaskTranslationAndScale))}Object(c["a"])(Ae)&&(--Ae.referenceCount,0===Ae.referenceCount&&Ae.destroy())}function V(e,t,a,r,i,o,s,n,h,u,c){var d=N;d.longitude=f["a"].lerp(t.west,t.east,o),d.latitude=f["a"].lerp(t.south,t.north,s),d.height=n;var l=e.cartographicToCartesian(d,C),g=L;return g.x=o,g.y=s,a.encode(r,i*a.getStride(),l,g,n,h,u),c.minimumHeight=Math.min(c.minimumHeight,n),c.maximumHeight=Math.max(c.maximumHeight,n),i+1}var G=new T["a"];function q(e,t,a,r){var i=e.rectangle,o=t.rectangle;0===t.x&&1===a.x&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?(i=T["a"].clone(e.rectangle,G),i.west-=f["a"].TWO_PI,i.east-=f["a"].TWO_PI):0===e.x&&0===a.x&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&(i=T["a"].clone(e.rectangle,G),i.west+=f["a"].TWO_PI,i.east+=f["a"].TWO_PI);var s=i.east-i.west,n=(o.west-i.west)/s,h=(o.east-i.west)/s,u=i.north-i.south,c=(o.south-i.south)/u,d=(o.north-i.south)/u,l=(a.x-n)/(h-n),g=(a.y-c)/(d-c);return Math.abs(l)<Math.EPSILON5?l=0:Math.abs(l-1)<Math.EPSILON5&&(l=1),Math.abs(g)<Math.EPSILON5?g=0:Math.abs(g-1)<Math.EPSILON5&&(g=1),r.x=l,r.y=g,r}var Y=new s["a"];function J(e,t,a,r,i){var o=e.encoding,s=e.vertices;if(i.height=o.decodeHeight(s,t),o.hasVertexNormals)o.getOctEncodedNormal(s,t,i.encodedNormal);else{var n=i.encodedNormal;n.x=0,n.y=0}}var Z=new s["a"],X=new n["a"];function K(e,t,a,i,o,s,h,u,c,d){var l,g=i.encoding,m=i.vertices,T=q(t,a,g.decodeTextureCoordinates(m,o,H),H),w=q(t,a,g.decodeTextureCoordinates(m,s,L),L);l=c?(h-T.x)/(w.x-T.x):(u-T.y)/(w.y-T.y);var x,v=g.decodeHeight(m,o),_=g.decodeHeight(m,s),b=a.rectangle;if(N.longitude=f["a"].lerp(b.west,b.east,h),N.latitude=f["a"].lerp(b.south,b.north,u),d.height=N.height=f["a"].lerp(v,_,l),g.hasVertexNormals){var p=g.getOctEncodedNormal(m,o,Y),S=g.getOctEncodedNormal(m,s,Z),y=r["a"].octDecode(p.x,p.y,C),O=r["a"].octDecode(S.x,S.y,X);x=n["a"].lerp(y,O,l,C),n["a"].normalize(x,x),r["a"].octEncode(x,d.encodedNormal)}else x=e.geodeticSurfaceNormalCartographic(N,C),r["a"].octEncode(x,d.encodedNormal)}function Q(e,t,a,i,o,s){s.height=o;var n=t.geodeticSurfaceNormalCartographic(N,C);r["a"].octEncode(n,s.encodedNormal)}function $(e,t,a,r,i,o,s,n,h,u,d){var l,f,g=oe(e,t,n,s,!1,a,r,d)||oe(e,t,u,h,!0,a,r,d);return g?d:ie(i,o)?(l=0===a?0===r?o.eastIndicesNorthToSouth[0]:o.southIndicesEastToWest[0]:0===r?o.northIndicesWestToEast[0]:o.westIndicesSouthToNorth[0],J(o,l,a,r,d),d):(f=0===a?0===r?ee(e.westMeshes,e.westTiles,v["a"].EAST,e.southMeshes,e.southTiles,v["a"].NORTH,a,r):ee(e.northMeshes,e.northTiles,v["a"].SOUTH,e.westMeshes,e.westTiles,v["a"].EAST,a,r):0===r?ee(e.southMeshes,e.southTiles,v["a"].NORTH,e.eastMeshes,e.eastTiles,v["a"].WEST,a,r):ee(e.eastMeshes,e.eastTiles,v["a"].WEST,e.northMeshes,e.northTiles,v["a"].SOUTH,a,r),Object(c["a"])(f)?(Q(e,t,a,r,f,d),d):void 0)}function ee(e,t,a,r,i,o,s,n){var h=re(e,t,!1,a,s,n),u=re(r,i,!0,o,s,n);return Object(c["a"])(h)&&Object(c["a"])(u)?.5*(h+u):Object(c["a"])(h)?h:u}function te(e,t,a,r,i,o,s,n,h){for(var u=0;u<o.length;++u)i=ae(e,t,a,r,i,o[u],s[u],n,h);return i}function ae(e,t,a,r,i,o,s,n,h){var u=o.rectangle;n===v["a"].EAST&&0===e.tile.x?(u=T["a"].clone(o.rectangle,G),u.west-=f["a"].TWO_PI,u.east-=f["a"].TWO_PI):n===v["a"].WEST&&0===o.x&&(u=T["a"].clone(o.rectangle,G),u.west+=f["a"].TWO_PI,u.east+=f["a"].TWO_PI);var c,d,l,g,m=e.tile.rectangle;switch(i>0&&(a.decodeTextureCoordinates(r,i-1,H),c=H.x,d=H.y),n){case v["a"].WEST:l=s.westIndicesSouthToNorth,g=!1;break;case v["a"].NORTH:l=s.northIndicesWestToEast,g=!0;break;case v["a"].EAST:l=s.eastIndicesNorthToSouth,g=!1;break;case v["a"].SOUTH:l=s.southIndicesEastToWest,g=!0;break}var w,x,b=o,p=e.tile,S=s.encoding,y=s.vertices,O=a.getStride();S.hasWebMercatorT&&(w=_["a"].geodeticLatitudeToMercatorAngle(m.south),x=1/(_["a"].geodeticLatitudeToMercatorAngle(m.north)-w));for(var M=0;M<l.length;++M){var E=l[M],N=S.decodeTextureCoordinates(y,E,H);q(b,p,N,N);var A=N.x,I=N.y,L=g?A:I;if(!(L<0||L>1)&&!(Math.abs(A-c)<f["a"].EPSILON5&&Math.abs(I-d)<f["a"].EPSILON5)){var F=Math.abs(A)<f["a"].EPSILON5||Math.abs(A-1)<f["a"].EPSILON5,W=Math.abs(I)<f["a"].EPSILON5||Math.abs(I-1)<f["a"].EPSILON5;if(!F||!W){var j,k=S.decodePosition(y,E,C),P=S.decodeHeight(y,E);S.hasVertexNormals?j=S.getOctEncodedNormal(y,E,R):(j=R,j.x=0,j.y=0);var D=I;if(S.hasWebMercatorT){var U=f["a"].lerp(m.south,m.north,I);D=(_["a"].geodeticLatitudeToMercatorAngle(U)-w)*x}a.encode(r,i*O,k,N,P,j,D),h.minimumHeight=Math.min(h.minimumHeight,P),h.maximumHeight=Math.max(h.maximumHeight,P),++i}}}return i}function re(e,t,a,r,i,o){var s,n,h;a?(s=0,n=e.length,h=1):(s=e.length-1,n=-1,h=-1);for(var u=s;u!==n;u+=h){var d=e[u],l=t[u];if(ie(l,d)){var f;switch(r){case v["a"].WEST:f=d.westIndicesSouthToNorth;break;case v["a"].SOUTH:f=d.southIndicesEastToWest;break;case v["a"].EAST:f=d.eastIndicesNorthToSouth;break;case v["a"].NORTH:f=d.northIndicesWestToEast;break}var g=f[a?0:f.length-1];if(Object(c["a"])(g))return d.encoding.decodeHeight(d.vertices,g)}}}function ie(e,t){return Object(c["a"])(t)&&(!Object(c["a"])(e.data.fill)||!e.data.fill.changedThisFrame)}function oe(e,t,a,r,o,s,n,h){var u,c,d,l,f,g=r[o?0:a.length-1],m=a[o?0:a.length-1];if(ie(g,m)&&(0===s?0===n?(u=o?m.northIndicesWestToEast:m.eastIndicesNorthToSouth,c=o,d=o):(u=o?m.eastIndicesNorthToSouth:m.southIndicesEastToWest,c=!o,d=!1):0===n?(u=o?m.westIndicesSouthToNorth:m.northIndicesWestToEast,c=!o,d=!0):(u=o?m.southIndicesEastToWest:m.westIndicesSouthToNorth,c=o,d=!o),u.length>0)){l=o?0:u.length-1,f=u[l],m.encoding.decodeTextureCoordinates(m.vertices,f,H);var T=q(g,e.tile,H,H);if(T.x===s&&T.y===n)return J(m,f,s,n,h),!0;if(l=Object(i["a"])(u,c?s:n,(function(t,a){m.encoding.decodeTextureCoordinates(m.vertices,t,H);var r=q(g,e.tile,H,H);return d?c?r.x-s:r.y-n:c?s-r.x:n-r.y})),!(l<0))return J(m,u[l],s,n,h),!0;if(l=~l,l>0&&l<u.length)return K(t,g,e.tile,m,u[l-1],u[l],s,n,c,h),!0}return!1}var se=[new n["a"],new n["a"],new n["a"],new n["a"]];function ne(e,t,a,r,i){var o=e.quadtree._occluders.ellipsoid,s=o.ellipsoid,h=se;return n["a"].fromRadians(a.west,a.south,r,s,h[0]),n["a"].fromRadians(a.east,a.south,r,s,h[1]),n["a"].fromRadians(a.west,a.north,r,s,h[2]),n["a"].fromRadians(a.east,a.north,r,s,h[3]),o.computeHorizonCullingPoint(t,h,i)}t["a"]=S},"4c22":function(e,t,a){"use strict";var r=a("0e25"),i={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6};t["a"]=Object(r["a"])(i)},"7eb3":function(e,t,a){"use strict";var r=a("77af"),i=a("670c"),o=a("71ce"),s=a("535a"),n=a("2f63"),h=a("9f1d"),u=a("7d62"),c=a("e42d"),d=a("d4ed"),l=a("283e"),f=a("ac3b"),g=a("a913"),m=a("a58e");function T(e,t,a,r,o){this.bottomLeft=Object(s["a"])(e,i["a"].ZERO),this.topRight=Object(s["a"])(t,i["a"].ZERO),this.childNode1=a,this.childNode2=r,this.imageIndex=o}var w=new i["a"](16,16);function x(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT);var t=Object(s["a"])(e.borderWidthInPixels,1),a=Object(s["a"])(e.initialSize,w);this._context=e.context,this._pixelFormat=Object(s["a"])(e.pixelFormat,c["a"].RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=Object(o["a"])(),this._idHash={},this._initialSize=a,this._root=void 0}function v(e,t){var a=e._context,r=e.numberOfImages,o=2,s=e._borderWidthInPixels;if(r>0){for(var h=e._texture.width,u=e._texture.height,c=o*(h+t.width+s),d=o*(u+t.height+s),l=h/c,m=u/d,w=new T(new i["a"](h+s,s),new i["a"](c,u)),x=new T(new i["a"],new i["a"](c,u),e._root,w),v=new T(new i["a"](s,u+s),new i["a"](c,d)),_=new T(new i["a"],new i["a"](c,d),x,v),b=0;b<e._textureCoordinates.length;b++){var p=e._textureCoordinates[b];Object(n["a"])(p)&&(p.x*=l,p.y*=m,p.width*=l,p.height*=m)}var S=new g["a"]({context:e._context,width:c,height:d,pixelFormat:e._pixelFormat}),y=new f["a"]({context:a,colorTextures:[e._texture],destroyAttachments:!1});y._bind(),S.copyFromFramebuffer(0,0,0,0,c,d),y._unBind(),y.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=S,e._root=_}else{var O=o*(t.width+2*s),M=o*(t.height+2*s);O<e._initialSize.x&&(O=e._initialSize.x),M<e._initialSize.y&&(M=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new g["a"]({context:e._context,width:O,height:M,pixelFormat:e._pixelFormat}),e._root=new T(new i["a"](s,s),new i["a"](O,M))}}function _(e,t,a){if(Object(n["a"])(t)){if(!Object(n["a"])(t.childNode1)&&!Object(n["a"])(t.childNode2)){if(Object(n["a"])(t.imageIndex))return;var r=t.topRight.x-t.bottomLeft.x,o=t.topRight.y-t.bottomLeft.y,s=r-a.width,h=o-a.height;if(s<0||h<0)return;if(0===s&&0===h)return t;if(s>h){t.childNode1=new T(new i["a"](t.bottomLeft.x,t.bottomLeft.y),new i["a"](t.bottomLeft.x+a.width,t.topRight.y));var u=t.bottomLeft.x+a.width+e._borderWidthInPixels;u<t.topRight.x&&(t.childNode2=new T(new i["a"](u,t.bottomLeft.y),new i["a"](t.topRight.x,t.topRight.y)))}else{t.childNode1=new T(new i["a"](t.bottomLeft.x,t.bottomLeft.y),new i["a"](t.topRight.x,t.bottomLeft.y+a.height));var c=t.bottomLeft.y+a.height+e._borderWidthInPixels;c<t.topRight.y&&(t.childNode2=new T(new i["a"](t.bottomLeft.x,c),new i["a"](t.topRight.x,t.topRight.y)))}return _(e,t.childNode1,a)}return _(e,t.childNode1,a)||_(e,t.childNode2,a)}}function b(e,t,a){var i=_(e,e._root,t);if(Object(n["a"])(i)){i.imageIndex=a;var s=e._texture.width,h=e._texture.height,u=i.topRight.x-i.bottomLeft.x,c=i.topRight.y-i.bottomLeft.y,d=i.bottomLeft.x/s,l=i.bottomLeft.y/h,f=u/s,g=c/h;e._textureCoordinates[a]=new r["a"](d,l,f,g),e._texture.copyFrom(t,i.bottomLeft.x,i.bottomLeft.y)}else v(e,t),b(e,t,a);e._guid=Object(o["a"])()}Object(h["a"])(x.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return Object(n["a"])(this._texture)||(this._texture=new g["a"]({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),x.prototype.addImage=function(e,t){var a=this._idHash[e];if(Object(n["a"])(a))return a;if("function"===typeof t)t=t(e);else if("string"===typeof t||t instanceof d["a"]){var r=d["a"].createIfNeeded(t);t=r.fetchImage()}var i=this;return a=Object(m["a"])(t,(function(e){if(i.isDestroyed())return-1;var t=i.numberOfImages;return b(i,e,t),t})),this._idHash[e]=a,a},x.prototype.addSubRegion=function(e,t){var a=this._idHash[e];if(!Object(n["a"])(a))throw new l["a"]('image with id "'+e+'" not found in the atlas.');var i=this;return Object(m["a"])(a,(function(e){if(-1===e)return-1;var a=i._texture.width,s=i._texture.height,n=i.numberOfImages,h=i._textureCoordinates[e],u=h.x+t.x/a,c=h.y+t.y/s,d=t.width/a,l=t.height/s;return i._textureCoordinates.push(new r["a"](u,c,d,l)),i._guid=Object(o["a"])(),n}))},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),Object(u["a"])(this)},t["a"]=x},ccf4:function(e,t,a){"use strict";var r=a("cef5"),i=a("670c"),o=a("be18"),s=a("a561"),n=a("abab"),h=a("2f63"),u=a("9f1d"),c=a("7d62"),d=a("0123"),l=a("93da"),f=a("52f0"),g=a("e42d"),m=a("1b8d"),T=a("f20a"),w=a("8b68"),x=a("5b54"),v=a("a894"),_=a("6ef5"),b=a("6dc0"),p=a("e90c"),S=a("a913"),y=a("7c5e"),O=a("563a"),M=a("a036"),E=a("7c36"),N=a("b7c8"),A=a("a307"),C=a("0c80");function I(){this.show=!0,this._drawCommand=new v["a"]({primitiveType:m["a"].TRIANGLES,boundingVolume:new r["a"],owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new r["a"],this._boundingVolume2D=new r["a"],this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;var e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object(u["a"])(I.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var R=new i["a"],L=new i["a"],H=new s["a"],F=new s["a"];I.prototype.update=function(e,t,a){if(this.show){var s=e.mode;if(s!==A["a"].SCENE2D&&s!==A["a"].MORPHING&&e.passes.render){var u=e.context,c=t.viewport.width,m=t.viewport.height;if(!Object(h["a"])(this._texture)||c!==this._drawingBufferWidth||m!==this._drawingBufferHeight||this._glowFactorDirty||a!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=c,this._drawingBufferHeight=m,this._glowFactorDirty=!1,this._useHdr=a;var v=Math.max(c,m);v=Math.pow(2,Math.ceil(Math.log(v)/Math.log(2))-2),v=Math.max(1,v);var I=a?u.halfFloatingPointTexture?_["a"].HALF_FLOAT:_["a"].FLOAT:_["a"].UNSIGNED_BYTE;this._texture=new S["a"]({context:u,width:v,height:v,pixelFormat:g["a"].RGBA,pixelDatatype:I}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var W=this,j={u_radiusTS:function(){return W._radiusTS}};this._commands.computeCommand=new x["a"]({fragmentShaderSource:M["a"],outputTexture:this._texture,uniformMap:j,persists:!1,owner:this,postExecute:function(){W._commands.computeCommand=void 0}})}var k=this._drawCommand;if(!Object(h["a"])(k.vertexArray)){var P={direction:0},D=new Uint8Array(8);D[0]=0,D[1]=0,D[2]=255,D[3]=0,D[4]=255,D[5]=255,D[6]=0,D[7]=255;var U=T["a"].createVertexBuffer({context:u,typedArray:D,usage:w["a"].STATIC_DRAW}),B=[{index:P.direction,vertexBuffer:U,componentsPerAttribute:2,normalize:!0,componentDatatype:n["a"].UNSIGNED_BYTE}],z=T["a"].createIndexBuffer({context:u,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:w["a"].STATIC_DRAW,indexDatatype:d["a"].UNSIGNED_SHORT});k.vertexArray=new y["a"]({context:u,attributes:B,indexBuffer:z}),k.shaderProgram=p["a"].fromCache({context:u,vertexShaderSource:E["a"],fragmentShaderSource:O["a"],attributeLocations:P}),k.renderState=b["a"].fromCache({blending:N["a"].ALPHA_BLEND}),k.uniformMap=this._uniformMap}var V=u.uniformState.sunPositionWC,G=u.uniformState.sunPositionColumbusView,q=this._boundingVolume,Y=this._boundingVolume2D;o["a"].clone(V,q.center),Y.center.x=G.z,Y.center.y=G.x,Y.center.z=G.y,q.radius=l["a"].SOLAR_RADIUS+l["a"].SOLAR_RADIUS*this._glowLengthTS,Y.radius=q.radius,s===A["a"].SCENE3D?r["a"].clone(q,k.boundingVolume):s===A["a"].COLUMBUS_VIEW&&r["a"].clone(Y,k.boundingVolume);var J=C["a"].computeActualWgs84Position(e,V,F),Z=o["a"].magnitude(o["a"].subtract(J,e.camera.position,F)),X=u.uniformState.projection,K=H;K.x=0,K.y=0,K.z=-Z,K.w=1;var Q=f["a"].multiplyByVector(X,K,F),$=C["a"].clipToGLWindowCoordinates(t.viewport,Q,R);K.x=l["a"].SOLAR_RADIUS;var ee=f["a"].multiplyByVector(X,K,F),te=C["a"].clipToGLWindowCoordinates(t.viewport,ee,L);return this._size=i["a"].magnitude(i["a"].subtract(te,$,F)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands}}},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){var e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),Object(c["a"])(this)},t["a"]=I},cdd6:function(e,t,a){"use strict";var r=a("77af"),i=a("670c"),o=a("a561"),s=a("2f63"),n=a("7d62"),h=a("93da"),u=a("52f0"),c=a("f806"),d=a("1627"),l=a("34e1"),f=a("ae18"),g=a("3720"),m=a("9249"),T=a("f724"),w=a("0d09"),x=a("18a0"),v=a("7fe1");function _(){this._sceneFramebuffer=new v["a"];var e=.125,t=new Array(6);t[0]=new m["a"]({fragmentShader:g["a"],textureScale:e,forcePowerOfTwo:!0,sampleMode:w["a"].LINEAR});var a=t[1]=new m["a"]({fragmentShader:l["a"],uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:e,forcePowerOfTwo:!0}),r=this;this._delta=1,this._sigma=2,this._blurStep=new i["a"],t[2]=new m["a"]({fragmentShader:f["a"],uniforms:{step:function(){return r._blurStep.x=r._blurStep.y=1/a.outputTexture.width,r._blurStep},delta:function(){return r._delta},sigma:function(){return r._sigma},direction:0},textureScale:e,forcePowerOfTwo:!0}),t[3]=new m["a"]({fragmentShader:f["a"],uniforms:{step:function(){return r._blurStep.x=r._blurStep.y=1/a.outputTexture.width,r._blurStep},delta:function(){return r._delta},sigma:function(){return r._sigma},direction:1},textureScale:e,forcePowerOfTwo:!0}),t[4]=new m["a"]({fragmentShader:g["a"],sampleMode:w["a"].LINEAR}),this._uCenter=new i["a"],this._uRadius=void 0,t[5]=new m["a"]({fragmentShader:d["a"],uniforms:{center:function(){return r._uCenter},radius:function(){return r._uRadius},colorTexture2:function(){return r._sceneFramebuffer.getFramebuffer().getColorTexture(0)}}}),this._stages=new T["a"]({stages:t});for(var o=new x["a"](this),s=t.length,n=0;n<s;++n)t[n]._textureCache=o;this._textureCache=o,this.length=t.length}_.prototype.get=function(e){return this._stages.get(e)},_.prototype.getStageByName=function(e){for(var t=this._stages.length,a=0;a<t;++a){var r=this._stages.get(a);if(r.name===e)return r}};var b=new o["a"],p=new i["a"],S=new i["a"],y=new u["a"];function O(e,t,a){var o=t.uniformState,s=o.sunPositionWC,n=o.view,d=o.viewProjection,l=o.projection,f=u["a"].computeViewportTransformation(a,0,1,y),g=u["a"].multiplyByPoint(n,s,b),m=c["a"].pointToGLWindowCoordinates(d,f,s,p);g.x+=h["a"].SOLAR_RADIUS;var T=c["a"].pointToGLWindowCoordinates(l,f,g,g),w=30*i["a"].magnitude(i["a"].subtract(T,m,T))*2,x=S;x.x=w,x.y=w,e._uCenter=i["a"].clone(m,e._uCenter),e._uRadius=.15*Math.max(x.x,x.y);var v=t.drawingBufferWidth,_=t.drawingBufferHeight,O=e._stages,M=O.get(0),E=M.outputTexture.width,N=M.outputTexture.height,A=new r["a"];A.width=E,A.height=N,f=u["a"].computeViewportTransformation(A,0,1,y),m=c["a"].pointToGLWindowCoordinates(d,f,s,p),x.x*=E/v,x.y*=N/_;var C=M.scissorRectangle;C.x=Math.max(m.x-.5*x.x,0),C.y=Math.max(m.y-.5*x.y,0),C.width=Math.min(x.x,v),C.height=Math.min(x.y,_);for(var I=1;I<4;++I)r["a"].clone(C,O.get(I).scissorRectangle)}_.prototype.clear=function(e,t,a){this._sceneFramebuffer.clear(e,t,a),this._textureCache.clear(e)},_.prototype.update=function(e){var t=e.context,a=e.viewport,r=this._sceneFramebuffer;r.update(t,a);var i=r.getFramebuffer();return this._textureCache.update(t),this._stages.update(t,!1),O(this,t,a),i},_.prototype.execute=function(e){var t=this._sceneFramebuffer.getFramebuffer().getColorTexture(0),a=this._stages,r=a.length;a.get(0).execute(e,t);for(var i=1;i<r;++i)a.get(i).execute(e,a.get(i-1).outputTexture)},_.prototype.copy=function(e,t){if(!Object(s["a"])(this._copyColorCommand)){var a=this;this._copyColorCommand=e.createViewportQuadCommand(g["a"],{uniformMap:{colorTexture:function(){return a._stages.get(a._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),Object(n["a"])(this)},t["a"]=_}}]);